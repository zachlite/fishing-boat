parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"XJqx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setMatrixArrayType=e,exports.toRadian=s,exports.equals=n,exports.RANDOM=exports.ARRAY_TYPE=exports.EPSILON=void 0;var t=1e-6;exports.EPSILON=t;var r="undefined"!=typeof Float32Array?Float32Array:Array;exports.ARRAY_TYPE=r;var a=Math.random;function e(t){exports.ARRAY_TYPE=r=t}exports.RANDOM=a;var o=Math.PI/180;function s(t){return t*o}function n(r,a){return Math.abs(r-a)<=t*Math.max(1,Math.abs(r),Math.abs(a))}Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});
},{}],"eN7R":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.copy=a,exports.identity=u,exports.fromValues=s,exports.set=i,exports.transpose=c,exports.invert=p,exports.adjoint=f,exports.determinant=x,exports.multiply=l,exports.rotate=M,exports.scale=h,exports.fromRotation=b,exports.fromScaling=v,exports.str=y,exports.frob=d,exports.LDU=m,exports.add=P,exports.subtract=O,exports.exactEquals=A,exports.equals=j,exports.multiplyScalar=E,exports.multiplyScalarAndAdd=R,exports.sub=exports.mul=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r}function o(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function a(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function s(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function i(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function c(t,r){if(t===r){var e=r[1];t[1]=r[2],t[2]=e}else t[0]=r[0],t[1]=r[2],t[2]=r[1],t[3]=r[3];return t}function p(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],u=e*a-o*n;return u?(u=1/u,t[0]=a*u,t[1]=-n*u,t[2]=-o*u,t[3]=e*u,t):null}function f(t,r){var e=r[0];return t[0]=r[3],t[1]=-r[1],t[2]=-r[2],t[3]=e,t}function x(t){return t[0]*t[3]-t[2]*t[1]}function l(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],c=e[2],p=e[3];return t[0]=n*s+a*i,t[1]=o*s+u*i,t[2]=n*c+a*p,t[3]=o*c+u*p,t}function M(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=Math.sin(e),i=Math.cos(e);return t[0]=n*i+a*s,t[1]=o*i+u*s,t[2]=n*-s+a*i,t[3]=o*-s+u*i,t}function h(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1];return t[0]=n*s,t[1]=o*s,t[2]=a*i,t[3]=u*i,t}function b(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t}function v(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t}function y(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function d(t){return Math.hypot(t[0],t[1],t[2],t[3])}function m(t,r,e,n){return t[2]=n[2]/n[0],e[0]=n[0],e[1]=n[1],e[3]=n[3]-t[2]*e[1],[t,r,e]}function P(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function O(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function A(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function j(r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],c=e[2],p=e[3];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(u-p)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))}function E(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function R(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}var Y=l;exports.mul=Y;var _=O;exports.sub=_;
},{"./common.js":"XJqx"}],"M21d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=a,exports.copy=o,exports.identity=u,exports.fromValues=s,exports.set=i,exports.invert=c,exports.determinant=p,exports.multiply=f,exports.rotate=x,exports.scale=l,exports.translate=M,exports.fromRotation=h,exports.fromScaling=b,exports.fromTranslation=v,exports.str=m,exports.frob=y,exports.add=d,exports.subtract=P,exports.multiplyScalar=O,exports.multiplyScalarAndAdd=A,exports.exactEquals=E,exports.equals=R,exports.sub=exports.mul=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var u=a?Object.getOwnPropertyDescriptor(t,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r}function a(r){var e=new t.ARRAY_TYPE(6);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e}function o(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t}function u(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function s(r,e,n,a,o,u){var s=new t.ARRAY_TYPE(6);return s[0]=r,s[1]=e,s[2]=n,s[3]=a,s[4]=o,s[5]=u,s}function i(t,r,e,n,a,o,u){return t[0]=r,t[1]=e,t[2]=n,t[3]=a,t[4]=o,t[5]=u,t}function c(t,r){var e=r[0],n=r[1],a=r[2],o=r[3],u=r[4],s=r[5],i=e*o-n*a;return i?(i=1/i,t[0]=o*i,t[1]=-n*i,t[2]=-a*i,t[3]=e*i,t[4]=(a*s-o*u)*i,t[5]=(n*u-e*s)*i,t):null}function p(t){return t[0]*t[3]-t[1]*t[2]}function f(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1],f=e[2],x=e[3],l=e[4],M=e[5];return t[0]=n*c+o*p,t[1]=a*c+u*p,t[2]=n*f+o*x,t[3]=a*f+u*x,t[4]=n*l+o*M+s,t[5]=a*l+u*M+i,t}function x(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=Math.sin(e),p=Math.cos(e);return t[0]=n*p+o*c,t[1]=a*p+u*c,t[2]=n*-c+o*p,t[3]=a*-c+u*p,t[4]=s,t[5]=i,t}function l(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1];return t[0]=n*c,t[1]=a*c,t[2]=o*p,t[3]=u*p,t[4]=s,t[5]=i,t}function M(t,r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1];return t[0]=n,t[1]=a,t[2]=o,t[3]=u,t[4]=n*c+o*p+s,t[5]=a*c+u*p+i,t}function h(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=-e,t[3]=n,t[4]=0,t[5]=0,t}function b(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=r[1],t[4]=0,t[5]=0,t}function v(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=r[0],t[5]=r[1],t}function m(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function y(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function d(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t}function P(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t[4]=r[4]-e[4],t[5]=r[5]-e[5],t}function O(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t}function A(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t[4]=r[4]+e[4]*n,t[5]=r[5]+e[5]*n,t}function E(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]}function R(r,e){var n=r[0],a=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=e[0],p=e[1],f=e[2],x=e[3],l=e[4],M=e[5];return Math.abs(n-c)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-p)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(o-f)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(u-x)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(s-l)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-M)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))}var S=f;exports.mul=S;var j=P;exports.sub=j;
},{"./common.js":"XJqx"}],"vtQf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=a,exports.fromMat4=e,exports.clone=o,exports.copy=u,exports.fromValues=s,exports.set=i,exports.identity=c,exports.transpose=f,exports.invert=p,exports.adjoint=M,exports.determinant=x,exports.multiply=h,exports.translate=b,exports.rotate=l,exports.scale=m,exports.fromTranslation=v,exports.fromRotation=P,exports.fromScaling=O,exports.fromMat2d=d,exports.fromQuat=y,exports.normalFromMat4=E,exports.projection=S,exports.str=A,exports.frob=j,exports.add=I,exports.subtract=L,exports.multiplyScalar=N,exports.multiplyScalarAndAdd=R,exports.exactEquals=Y,exports.equals=_,exports.sub=exports.mul=void 0;var t=n(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var n=r();if(n&&n.has(t))return n.get(t);var a={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var u=e?Object.getOwnPropertyDescriptor(t,o):null;u&&(u.get||u.set)?Object.defineProperty(a,o,u):a[o]=t[o]}return a.default=t,n&&n.set(t,a),a}function a(){var r=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function e(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function o(r){var n=new t.ARRAY_TYPE(9);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function s(r,n,a,e,o,u,s,i,c){var f=new t.ARRAY_TYPE(9);return f[0]=r,f[1]=n,f[2]=a,f[3]=e,f[4]=o,f[5]=u,f[6]=s,f[7]=i,f[8]=c,f}function i(t,r,n,a,e,o,u,s,i,c){return t[0]=r,t[1]=n,t[2]=a,t[3]=e,t[4]=o,t[5]=u,t[6]=s,t[7]=i,t[8]=c,t}function c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function f(t,r){if(t===r){var n=r[1],a=r[2],e=r[5];t[1]=r[3],t[2]=r[6],t[3]=n,t[5]=r[7],t[6]=a,t[7]=e}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function p(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8],p=f*u-s*c,M=-f*o+s*i,x=c*o-u*i,h=n*p+a*M+e*x;return h?(h=1/h,t[0]=p*h,t[1]=(-f*a+e*c)*h,t[2]=(s*a-e*u)*h,t[3]=M*h,t[4]=(f*n-e*i)*h,t[5]=(-s*n+e*o)*h,t[6]=x*h,t[7]=(-c*n+a*i)*h,t[8]=(u*n-a*o)*h,t):null}function M(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8];return t[0]=u*f-s*c,t[1]=e*c-a*f,t[2]=a*s-e*u,t[3]=s*i-o*f,t[4]=n*f-e*i,t[5]=e*o-n*s,t[6]=o*c-u*i,t[7]=a*i-n*c,t[8]=n*u-a*o,t}function x(t){var r=t[0],n=t[1],a=t[2],e=t[3],o=t[4],u=t[5],s=t[6],i=t[7],c=t[8];return r*(c*o-u*i)+n*(-c*e+u*s)+a*(i*e-o*s)}function h(t,r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=n[0],x=n[1],h=n[2],b=n[3],l=n[4],m=n[5],v=n[6],P=n[7],O=n[8];return t[0]=M*a+x*u+h*c,t[1]=M*e+x*s+h*f,t[2]=M*o+x*i+h*p,t[3]=b*a+l*u+m*c,t[4]=b*e+l*s+m*f,t[5]=b*o+l*i+m*p,t[6]=v*a+P*u+O*c,t[7]=v*e+P*s+O*f,t[8]=v*o+P*i+O*p,t}function b(t,r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=n[0],x=n[1];return t[0]=a,t[1]=e,t[2]=o,t[3]=u,t[4]=s,t[5]=i,t[6]=M*a+x*u+c,t[7]=M*e+x*s+f,t[8]=M*o+x*i+p,t}function l(t,r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=Math.sin(n),x=Math.cos(n);return t[0]=x*a+M*u,t[1]=x*e+M*s,t[2]=x*o+M*i,t[3]=x*u-M*a,t[4]=x*s-M*e,t[5]=x*i-M*o,t[6]=c,t[7]=f,t[8]=p,t}function m(t,r,n){var a=n[0],e=n[1];return t[0]=a*r[0],t[1]=a*r[1],t[2]=a*r[2],t[3]=e*r[3],t[4]=e*r[4],t[5]=e*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function v(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t}function P(t,r){var n=Math.sin(r),a=Math.cos(r);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function O(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function d(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t}function y(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=n+n,s=a+a,i=e+e,c=n*u,f=a*u,p=a*s,M=e*u,x=e*s,h=e*i,b=o*u,l=o*s,m=o*i;return t[0]=1-p-h,t[3]=f-m,t[6]=M+l,t[1]=f+m,t[4]=1-c-h,t[7]=x-b,t[2]=M-l,t[5]=x+b,t[8]=1-c-p,t}function E(t,r){var n=r[0],a=r[1],e=r[2],o=r[3],u=r[4],s=r[5],i=r[6],c=r[7],f=r[8],p=r[9],M=r[10],x=r[11],h=r[12],b=r[13],l=r[14],m=r[15],v=n*s-a*u,P=n*i-e*u,O=n*c-o*u,d=a*i-e*s,y=a*c-o*s,E=e*c-o*i,S=f*b-p*h,A=f*l-M*h,j=f*m-x*h,I=p*l-M*b,L=p*m-x*b,N=M*m-x*l,R=v*N-P*L+O*I+d*j-y*A+E*S;return R?(R=1/R,t[0]=(s*N-i*L+c*I)*R,t[1]=(i*j-u*N-c*A)*R,t[2]=(u*L-s*j+c*S)*R,t[3]=(e*L-a*N-o*I)*R,t[4]=(n*N-e*j+o*A)*R,t[5]=(a*j-n*L-o*S)*R,t[6]=(b*E-l*y+m*d)*R,t[7]=(l*O-h*E-m*P)*R,t[8]=(h*y-b*O+m*v)*R,t):null}function S(t,r,n){return t[0]=2/r,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function A(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function j(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function I(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t}function L(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t}function N(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t}function R(t,r,n,a){return t[0]=r[0]+n[0]*a,t[1]=r[1]+n[1]*a,t[2]=r[2]+n[2]*a,t[3]=r[3]+n[3]*a,t[4]=r[4]+n[4]*a,t[5]=r[5]+n[5]*a,t[6]=r[6]+n[6]*a,t[7]=r[7]+n[7]*a,t[8]=r[8]+n[8]*a,t}function Y(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]}function _(r,n){var a=r[0],e=r[1],o=r[2],u=r[3],s=r[4],i=r[5],c=r[6],f=r[7],p=r[8],M=n[0],x=n[1],h=n[2],b=n[3],l=n[4],m=n[5],v=n[6],P=n[7],O=n[8];return Math.abs(a-M)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(e-x)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-b)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(s-l)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(i-m)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(c-v)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(f-P)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(p-O)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(O))}var w=h;exports.mul=w;var g=L;exports.sub=g;
},{"./common.js":"XJqx"}],"w3aR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=e,exports.copy=o,exports.fromValues=s,exports.set=u,exports.identity=h,exports.transpose=M,exports.invert=i,exports.adjoint=c,exports.determinant=p,exports.multiply=f,exports.translate=x,exports.scale=b,exports.rotate=l,exports.rotateX=v,exports.rotateY=m,exports.rotateZ=P,exports.fromTranslation=O,exports.fromScaling=E,exports.fromRotation=S,exports.fromXRotation=y,exports.fromYRotation=I,exports.fromZRotation=L,exports.fromRotationTranslation=N,exports.fromQuat2=R,exports.getTranslation=d,exports.getScaling=g,exports.getRotation=A,exports.fromRotationTranslationScale=Y,exports.fromRotationTranslationScaleOrigin=T,exports.fromQuat=w,exports.frustum=_,exports.perspective=j,exports.perspectiveFromFieldOfView=q,exports.ortho=D,exports.lookAt=k,exports.targetTo=F,exports.str=Q,exports.frob=V,exports.add=W,exports.subtract=X,exports.multiplyScalar=Z,exports.multiplyScalarAndAdd=z,exports.exactEquals=B,exports.equals=C,exports.sub=exports.mul=void 0;var t=r(require("./common.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function r(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a();if(r&&r.has(t))return r.get(t);var n={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=e?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}return n.default=t,r&&r.set(t,n),n}function n(){var a=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function e(a){var r=new t.ARRAY_TYPE(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r}function o(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function s(a,r,n,e,o,s,u,h,M,i,c,p,f,x,b,l){var v=new t.ARRAY_TYPE(16);return v[0]=a,v[1]=r,v[2]=n,v[3]=e,v[4]=o,v[5]=s,v[6]=u,v[7]=h,v[8]=M,v[9]=i,v[10]=c,v[11]=p,v[12]=f,v[13]=x,v[14]=b,v[15]=l,v}function u(t,a,r,n,e,o,s,u,h,M,i,c,p,f,x,b,l){return t[0]=a,t[1]=r,t[2]=n,t[3]=e,t[4]=o,t[5]=s,t[6]=u,t[7]=h,t[8]=M,t[9]=i,t[10]=c,t[11]=p,t[12]=f,t[13]=x,t[14]=b,t[15]=l,t}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function M(t,a){if(t===a){var r=a[1],n=a[2],e=a[3],o=a[6],s=a[7],u=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=r,t[6]=a[9],t[7]=a[13],t[8]=n,t[9]=o,t[11]=a[14],t[12]=e,t[13]=s,t[14]=u}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t}function i(t,a){var r=a[0],n=a[1],e=a[2],o=a[3],s=a[4],u=a[5],h=a[6],M=a[7],i=a[8],c=a[9],p=a[10],f=a[11],x=a[12],b=a[13],l=a[14],v=a[15],m=r*u-n*s,P=r*h-e*s,O=r*M-o*s,E=n*h-e*u,S=n*M-o*u,y=e*M-o*h,I=i*b-c*x,L=i*l-p*x,N=i*v-f*x,R=c*l-p*b,d=c*v-f*b,g=p*v-f*l,A=m*g-P*d+O*R+E*N-S*L+y*I;return A?(A=1/A,t[0]=(u*g-h*d+M*R)*A,t[1]=(e*d-n*g-o*R)*A,t[2]=(b*y-l*S+v*E)*A,t[3]=(p*S-c*y-f*E)*A,t[4]=(h*N-s*g-M*L)*A,t[5]=(r*g-e*N+o*L)*A,t[6]=(l*O-x*y-v*P)*A,t[7]=(i*y-p*O+f*P)*A,t[8]=(s*d-u*N+M*I)*A,t[9]=(n*N-r*d-o*I)*A,t[10]=(x*S-b*O+v*m)*A,t[11]=(c*O-i*S-f*m)*A,t[12]=(u*L-s*R-h*I)*A,t[13]=(r*R-n*L+e*I)*A,t[14]=(b*P-x*E-l*m)*A,t[15]=(i*E-c*P+p*m)*A,t):null}function c(t,a){var r=a[0],n=a[1],e=a[2],o=a[3],s=a[4],u=a[5],h=a[6],M=a[7],i=a[8],c=a[9],p=a[10],f=a[11],x=a[12],b=a[13],l=a[14],v=a[15];return t[0]=u*(p*v-f*l)-c*(h*v-M*l)+b*(h*f-M*p),t[1]=-(n*(p*v-f*l)-c*(e*v-o*l)+b*(e*f-o*p)),t[2]=n*(h*v-M*l)-u*(e*v-o*l)+b*(e*M-o*h),t[3]=-(n*(h*f-M*p)-u*(e*f-o*p)+c*(e*M-o*h)),t[4]=-(s*(p*v-f*l)-i*(h*v-M*l)+x*(h*f-M*p)),t[5]=r*(p*v-f*l)-i*(e*v-o*l)+x*(e*f-o*p),t[6]=-(r*(h*v-M*l)-s*(e*v-o*l)+x*(e*M-o*h)),t[7]=r*(h*f-M*p)-s*(e*f-o*p)+i*(e*M-o*h),t[8]=s*(c*v-f*b)-i*(u*v-M*b)+x*(u*f-M*c),t[9]=-(r*(c*v-f*b)-i*(n*v-o*b)+x*(n*f-o*c)),t[10]=r*(u*v-M*b)-s*(n*v-o*b)+x*(n*M-o*u),t[11]=-(r*(u*f-M*c)-s*(n*f-o*c)+i*(n*M-o*u)),t[12]=-(s*(c*l-p*b)-i*(u*l-h*b)+x*(u*p-h*c)),t[13]=r*(c*l-p*b)-i*(n*l-e*b)+x*(n*p-e*c),t[14]=-(r*(u*l-h*b)-s*(n*l-e*b)+x*(n*h-e*u)),t[15]=r*(u*p-h*c)-s*(n*p-e*c)+i*(n*h-e*u),t}function p(t){var a=t[0],r=t[1],n=t[2],e=t[3],o=t[4],s=t[5],u=t[6],h=t[7],M=t[8],i=t[9],c=t[10],p=t[11],f=t[12],x=t[13],b=t[14],l=t[15];return(a*s-r*o)*(c*l-p*b)-(a*u-n*o)*(i*l-p*x)+(a*h-e*o)*(i*b-c*x)+(r*u-n*s)*(M*l-p*f)-(r*h-e*s)*(M*b-c*f)+(n*h-e*u)*(M*x-i*f)}function f(t,a,r){var n=a[0],e=a[1],o=a[2],s=a[3],u=a[4],h=a[5],M=a[6],i=a[7],c=a[8],p=a[9],f=a[10],x=a[11],b=a[12],l=a[13],v=a[14],m=a[15],P=r[0],O=r[1],E=r[2],S=r[3];return t[0]=P*n+O*u+E*c+S*b,t[1]=P*e+O*h+E*p+S*l,t[2]=P*o+O*M+E*f+S*v,t[3]=P*s+O*i+E*x+S*m,P=r[4],O=r[5],E=r[6],S=r[7],t[4]=P*n+O*u+E*c+S*b,t[5]=P*e+O*h+E*p+S*l,t[6]=P*o+O*M+E*f+S*v,t[7]=P*s+O*i+E*x+S*m,P=r[8],O=r[9],E=r[10],S=r[11],t[8]=P*n+O*u+E*c+S*b,t[9]=P*e+O*h+E*p+S*l,t[10]=P*o+O*M+E*f+S*v,t[11]=P*s+O*i+E*x+S*m,P=r[12],O=r[13],E=r[14],S=r[15],t[12]=P*n+O*u+E*c+S*b,t[13]=P*e+O*h+E*p+S*l,t[14]=P*o+O*M+E*f+S*v,t[15]=P*s+O*i+E*x+S*m,t}function x(t,a,r){var n,e,o,s,u,h,M,i,c,p,f,x,b=r[0],l=r[1],v=r[2];return a===t?(t[12]=a[0]*b+a[4]*l+a[8]*v+a[12],t[13]=a[1]*b+a[5]*l+a[9]*v+a[13],t[14]=a[2]*b+a[6]*l+a[10]*v+a[14],t[15]=a[3]*b+a[7]*l+a[11]*v+a[15]):(n=a[0],e=a[1],o=a[2],s=a[3],u=a[4],h=a[5],M=a[6],i=a[7],c=a[8],p=a[9],f=a[10],x=a[11],t[0]=n,t[1]=e,t[2]=o,t[3]=s,t[4]=u,t[5]=h,t[6]=M,t[7]=i,t[8]=c,t[9]=p,t[10]=f,t[11]=x,t[12]=n*b+u*l+c*v+a[12],t[13]=e*b+h*l+p*v+a[13],t[14]=o*b+M*l+f*v+a[14],t[15]=s*b+i*l+x*v+a[15]),t}function b(t,a,r){var n=r[0],e=r[1],o=r[2];return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*e,t[5]=a[5]*e,t[6]=a[6]*e,t[7]=a[7]*e,t[8]=a[8]*o,t[9]=a[9]*o,t[10]=a[10]*o,t[11]=a[11]*o,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function l(a,r,n,e){var o,s,u,h,M,i,c,p,f,x,b,l,v,m,P,O,E,S,y,I,L,N,R,d,g=e[0],A=e[1],Y=e[2],T=Math.hypot(g,A,Y);return T<t.EPSILON?null:(g*=T=1/T,A*=T,Y*=T,o=Math.sin(n),u=1-(s=Math.cos(n)),h=r[0],M=r[1],i=r[2],c=r[3],p=r[4],f=r[5],x=r[6],b=r[7],l=r[8],v=r[9],m=r[10],P=r[11],O=g*g*u+s,E=A*g*u+Y*o,S=Y*g*u-A*o,y=g*A*u-Y*o,I=A*A*u+s,L=Y*A*u+g*o,N=g*Y*u+A*o,R=A*Y*u-g*o,d=Y*Y*u+s,a[0]=h*O+p*E+l*S,a[1]=M*O+f*E+v*S,a[2]=i*O+x*E+m*S,a[3]=c*O+b*E+P*S,a[4]=h*y+p*I+l*L,a[5]=M*y+f*I+v*L,a[6]=i*y+x*I+m*L,a[7]=c*y+b*I+P*L,a[8]=h*N+p*R+l*d,a[9]=M*N+f*R+v*d,a[10]=i*N+x*R+m*d,a[11]=c*N+b*R+P*d,r!==a&&(a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a)}function v(t,a,r){var n=Math.sin(r),e=Math.cos(r),o=a[4],s=a[5],u=a[6],h=a[7],M=a[8],i=a[9],c=a[10],p=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=o*e+M*n,t[5]=s*e+i*n,t[6]=u*e+c*n,t[7]=h*e+p*n,t[8]=M*e-o*n,t[9]=i*e-s*n,t[10]=c*e-u*n,t[11]=p*e-h*n,t}function m(t,a,r){var n=Math.sin(r),e=Math.cos(r),o=a[0],s=a[1],u=a[2],h=a[3],M=a[8],i=a[9],c=a[10],p=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*e-M*n,t[1]=s*e-i*n,t[2]=u*e-c*n,t[3]=h*e-p*n,t[8]=o*n+M*e,t[9]=s*n+i*e,t[10]=u*n+c*e,t[11]=h*n+p*e,t}function P(t,a,r){var n=Math.sin(r),e=Math.cos(r),o=a[0],s=a[1],u=a[2],h=a[3],M=a[4],i=a[5],c=a[6],p=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*e+M*n,t[1]=s*e+i*n,t[2]=u*e+c*n,t[3]=h*e+p*n,t[4]=M*e-o*n,t[5]=i*e-s*n,t[6]=c*e-u*n,t[7]=p*e-h*n,t}function O(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function E(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function S(a,r,n){var e,o,s,u=n[0],h=n[1],M=n[2],i=Math.hypot(u,h,M);return i<t.EPSILON?null:(u*=i=1/i,h*=i,M*=i,e=Math.sin(r),s=1-(o=Math.cos(r)),a[0]=u*u*s+o,a[1]=h*u*s+M*e,a[2]=M*u*s-h*e,a[3]=0,a[4]=u*h*s-M*e,a[5]=h*h*s+o,a[6]=M*h*s+u*e,a[7]=0,a[8]=u*M*s+h*e,a[9]=h*M*s-u*e,a[10]=M*M*s+o,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function y(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function I(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,a){var r=Math.sin(a),n=Math.cos(a);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,a,r){var n=a[0],e=a[1],o=a[2],s=a[3],u=n+n,h=e+e,M=o+o,i=n*u,c=n*h,p=n*M,f=e*h,x=e*M,b=o*M,l=s*u,v=s*h,m=s*M;return t[0]=1-(f+b),t[1]=c+m,t[2]=p-v,t[3]=0,t[4]=c-m,t[5]=1-(i+b),t[6]=x+l,t[7]=0,t[8]=p+v,t[9]=x-l,t[10]=1-(i+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function R(a,r){var n=new t.ARRAY_TYPE(3),e=-r[0],o=-r[1],s=-r[2],u=r[3],h=r[4],M=r[5],i=r[6],c=r[7],p=e*e+o*o+s*s+u*u;return p>0?(n[0]=2*(h*u+c*e+M*s-i*o)/p,n[1]=2*(M*u+c*o+i*e-h*s)/p,n[2]=2*(i*u+c*s+h*o-M*e)/p):(n[0]=2*(h*u+c*e+M*s-i*o),n[1]=2*(M*u+c*o+i*e-h*s),n[2]=2*(i*u+c*s+h*o-M*e)),N(a,r,n),a}function d(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t}function g(t,a){var r=a[0],n=a[1],e=a[2],o=a[4],s=a[5],u=a[6],h=a[8],M=a[9],i=a[10];return t[0]=Math.hypot(r,n,e),t[1]=Math.hypot(o,s,u),t[2]=Math.hypot(h,M,i),t}function A(a,r){var n=new t.ARRAY_TYPE(3);g(n,r);var e=1/n[0],o=1/n[1],s=1/n[2],u=r[0]*e,h=r[1]*o,M=r[2]*s,i=r[4]*e,c=r[5]*o,p=r[6]*s,f=r[8]*e,x=r[9]*o,b=r[10]*s,l=u+c+b,v=0;return l>0?(v=2*Math.sqrt(l+1),a[3]=.25*v,a[0]=(p-x)/v,a[1]=(f-M)/v,a[2]=(h-i)/v):u>c&&u>b?(v=2*Math.sqrt(1+u-c-b),a[3]=(p-x)/v,a[0]=.25*v,a[1]=(h+i)/v,a[2]=(f+M)/v):c>b?(v=2*Math.sqrt(1+c-u-b),a[3]=(f-M)/v,a[0]=(h+i)/v,a[1]=.25*v,a[2]=(p+x)/v):(v=2*Math.sqrt(1+b-u-c),a[3]=(h-i)/v,a[0]=(f+M)/v,a[1]=(p+x)/v,a[2]=.25*v),a}function Y(t,a,r,n){var e=a[0],o=a[1],s=a[2],u=a[3],h=e+e,M=o+o,i=s+s,c=e*h,p=e*M,f=e*i,x=o*M,b=o*i,l=s*i,v=u*h,m=u*M,P=u*i,O=n[0],E=n[1],S=n[2];return t[0]=(1-(x+l))*O,t[1]=(p+P)*O,t[2]=(f-m)*O,t[3]=0,t[4]=(p-P)*E,t[5]=(1-(c+l))*E,t[6]=(b+v)*E,t[7]=0,t[8]=(f+m)*S,t[9]=(b-v)*S,t[10]=(1-(c+x))*S,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function T(t,a,r,n,e){var o=a[0],s=a[1],u=a[2],h=a[3],M=o+o,i=s+s,c=u+u,p=o*M,f=o*i,x=o*c,b=s*i,l=s*c,v=u*c,m=h*M,P=h*i,O=h*c,E=n[0],S=n[1],y=n[2],I=e[0],L=e[1],N=e[2],R=(1-(b+v))*E,d=(f+O)*E,g=(x-P)*E,A=(f-O)*S,Y=(1-(p+v))*S,T=(l+m)*S,w=(x+P)*y,_=(l-m)*y,j=(1-(p+b))*y;return t[0]=R,t[1]=d,t[2]=g,t[3]=0,t[4]=A,t[5]=Y,t[6]=T,t[7]=0,t[8]=w,t[9]=_,t[10]=j,t[11]=0,t[12]=r[0]+I-(R*I+A*L+w*N),t[13]=r[1]+L-(d*I+Y*L+_*N),t[14]=r[2]+N-(g*I+T*L+j*N),t[15]=1,t}function w(t,a){var r=a[0],n=a[1],e=a[2],o=a[3],s=r+r,u=n+n,h=e+e,M=r*s,i=n*s,c=n*u,p=e*s,f=e*u,x=e*h,b=o*s,l=o*u,v=o*h;return t[0]=1-c-x,t[1]=i+v,t[2]=p-l,t[3]=0,t[4]=i-v,t[5]=1-M-x,t[6]=f+b,t[7]=0,t[8]=p+l,t[9]=f-b,t[10]=1-M-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _(t,a,r,n,e,o,s){var u=1/(r-a),h=1/(e-n),M=1/(o-s);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*h,t[6]=0,t[7]=0,t[8]=(r+a)*u,t[9]=(e+n)*h,t[10]=(s+o)*M,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*M,t[15]=0,t}function j(t,a,r,n,e){var o,s=1/Math.tan(a/2);return t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0?(o=1/(n-e),t[10]=(e+n)*o,t[14]=2*e*n*o):(t[10]=-1,t[14]=-2*n),t}function q(t,a,r,n){var e=Math.tan(a.upDegrees*Math.PI/180),o=Math.tan(a.downDegrees*Math.PI/180),s=Math.tan(a.leftDegrees*Math.PI/180),u=Math.tan(a.rightDegrees*Math.PI/180),h=2/(s+u),M=2/(e+o);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=M,t[6]=0,t[7]=0,t[8]=-(s-u)*h*.5,t[9]=(e-o)*M*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function D(t,a,r,n,e,o,s){var u=1/(a-r),h=1/(n-e),M=1/(o-s);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*M,t[11]=0,t[12]=(a+r)*u,t[13]=(e+n)*h,t[14]=(s+o)*M,t[15]=1,t}function k(a,r,n,e){var o,s,u,M,i,c,p,f,x,b,l=r[0],v=r[1],m=r[2],P=e[0],O=e[1],E=e[2],S=n[0],y=n[1],I=n[2];return Math.abs(l-S)<t.EPSILON&&Math.abs(v-y)<t.EPSILON&&Math.abs(m-I)<t.EPSILON?h(a):(p=l-S,f=v-y,x=m-I,o=O*(x*=b=1/Math.hypot(p,f,x))-E*(f*=b),s=E*(p*=b)-P*x,u=P*f-O*p,(b=Math.hypot(o,s,u))?(o*=b=1/b,s*=b,u*=b):(o=0,s=0,u=0),M=f*u-x*s,i=x*o-p*u,c=p*s-f*o,(b=Math.hypot(M,i,c))?(M*=b=1/b,i*=b,c*=b):(M=0,i=0,c=0),a[0]=o,a[1]=M,a[2]=p,a[3]=0,a[4]=s,a[5]=i,a[6]=f,a[7]=0,a[8]=u,a[9]=c,a[10]=x,a[11]=0,a[12]=-(o*l+s*v+u*m),a[13]=-(M*l+i*v+c*m),a[14]=-(p*l+f*v+x*m),a[15]=1,a)}function F(t,a,r,n){var e=a[0],o=a[1],s=a[2],u=n[0],h=n[1],M=n[2],i=e-r[0],c=o-r[1],p=s-r[2],f=i*i+c*c+p*p;f>0&&(i*=f=1/Math.sqrt(f),c*=f,p*=f);var x=h*p-M*c,b=M*i-u*p,l=u*c-h*i;return(f=x*x+b*b+l*l)>0&&(x*=f=1/Math.sqrt(f),b*=f,l*=f),t[0]=x,t[1]=b,t[2]=l,t[3]=0,t[4]=c*l-p*b,t[5]=p*x-i*l,t[6]=i*b-c*x,t[7]=0,t[8]=i,t[9]=c,t[10]=p,t[11]=0,t[12]=e,t[13]=o,t[14]=s,t[15]=1,t}function Q(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function V(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function W(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t[4]=a[4]+r[4],t[5]=a[5]+r[5],t[6]=a[6]+r[6],t[7]=a[7]+r[7],t[8]=a[8]+r[8],t[9]=a[9]+r[9],t[10]=a[10]+r[10],t[11]=a[11]+r[11],t[12]=a[12]+r[12],t[13]=a[13]+r[13],t[14]=a[14]+r[14],t[15]=a[15]+r[15],t}function X(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t[4]=a[4]-r[4],t[5]=a[5]-r[5],t[6]=a[6]-r[6],t[7]=a[7]-r[7],t[8]=a[8]-r[8],t[9]=a[9]-r[9],t[10]=a[10]-r[10],t[11]=a[11]-r[11],t[12]=a[12]-r[12],t[13]=a[13]-r[13],t[14]=a[14]-r[14],t[15]=a[15]-r[15],t}function Z(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=a[7]*r,t[8]=a[8]*r,t[9]=a[9]*r,t[10]=a[10]*r,t[11]=a[11]*r,t[12]=a[12]*r,t[13]=a[13]*r,t[14]=a[14]*r,t[15]=a[15]*r,t}function z(t,a,r,n){return t[0]=a[0]+r[0]*n,t[1]=a[1]+r[1]*n,t[2]=a[2]+r[2]*n,t[3]=a[3]+r[3]*n,t[4]=a[4]+r[4]*n,t[5]=a[5]+r[5]*n,t[6]=a[6]+r[6]*n,t[7]=a[7]+r[7]*n,t[8]=a[8]+r[8]*n,t[9]=a[9]+r[9]*n,t[10]=a[10]+r[10]*n,t[11]=a[11]+r[11]*n,t[12]=a[12]+r[12]*n,t[13]=a[13]+r[13]*n,t[14]=a[14]+r[14]*n,t[15]=a[15]+r[15]*n,t}function B(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}function C(a,r){var n=a[0],e=a[1],o=a[2],s=a[3],u=a[4],h=a[5],M=a[6],i=a[7],c=a[8],p=a[9],f=a[10],x=a[11],b=a[12],l=a[13],v=a[14],m=a[15],P=r[0],O=r[1],E=r[2],S=r[3],y=r[4],I=r[5],L=r[6],N=r[7],R=r[8],d=r[9],g=r[10],A=r[11],Y=r[12],T=r[13],w=r[14],_=r[15];return Math.abs(n-P)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(P))&&Math.abs(e-O)<=t.EPSILON*Math.max(1,Math.abs(e),Math.abs(O))&&Math.abs(o-E)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(s-S)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-y)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-I)<=t.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(M-L)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(L))&&Math.abs(i-N)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(N))&&Math.abs(c-R)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(p-d)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(d))&&Math.abs(f-g)<=t.EPSILON*Math.max(1,Math.abs(f),Math.abs(g))&&Math.abs(x-A)<=t.EPSILON*Math.max(1,Math.abs(x),Math.abs(A))&&Math.abs(b-Y)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(Y))&&Math.abs(l-T)<=t.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(v-w)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(w))&&Math.abs(m-_)<=t.EPSILON*Math.max(1,Math.abs(m),Math.abs(_))}var G=f;exports.mul=G;var H=X;exports.sub=H;
},{"./common.js":"XJqx"}],"AWBd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.length=a,exports.fromValues=s,exports.copy=u,exports.set=i,exports.add=c,exports.subtract=p,exports.multiply=f,exports.divide=x,exports.ceil=h,exports.floor=M,exports.min=v,exports.max=l,exports.round=d,exports.scale=m,exports.scaleAndAdd=b,exports.distance=y,exports.squaredDistance=O,exports.squaredLength=P,exports.negate=q,exports.inverse=A,exports.normalize=g,exports.dot=E,exports.cross=R,exports.lerp=Y,exports.hermite=j,exports.bezier=_,exports.random=w,exports.transformMat4=D,exports.transformMat3=L,exports.transformQuat=N,exports.rotateX=I,exports.rotateY=T,exports.rotateZ=z,exports.angle=S,exports.zero=k,exports.str=W,exports.exactEquals=F,exports.equals=Q,exports.forEach=exports.sqrLen=exports.len=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var s=o?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function o(r){var e=new t.ARRAY_TYPE(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function a(t){var r=t[0],e=t[1],n=t[2];return Math.hypot(r,e,n)}function s(r,e,n){var o=new t.ARRAY_TYPE(3);return o[0]=r,o[1]=e,o[2]=n,o}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function i(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function c(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function p(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function f(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function x(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t}function h(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t}function M(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t}function v(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function l(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function d(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t}function m(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function b(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t}function y(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return Math.hypot(e,n,o)}function O(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2];return e*e+n*n+o*o}function P(t){var r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n}function q(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t}function A(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t}function g(t,r){var e=r[0],n=r[1],o=r[2],a=e*e+n*n+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function R(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return t[0]=o*i-a*u,t[1]=a*s-n*i,t[2]=n*u-o*s,t}function Y(t,r,e,n){var o=r[0],a=r[1],s=r[2];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=s+n*(e[2]-s),t}function j(t,r,e,n,o,a){var s=a*a,u=s*(2*a-3)+1,i=s*(a-2)+a,c=s*(a-1),p=s*(3-2*a);return t[0]=r[0]*u+e[0]*i+n[0]*c+o[0]*p,t[1]=r[1]*u+e[1]*i+n[1]*c+o[1]*p,t[2]=r[2]*u+e[2]*i+n[2]*c+o[2]*p,t}function _(t,r,e,n,o,a){var s=1-a,u=s*s,i=a*a,c=u*s,p=3*a*u,f=3*i*s,x=i*a;return t[0]=r[0]*c+e[0]*p+n[0]*f+o[0]*x,t[1]=r[1]*c+e[1]*p+n[1]*f+o[1]*x,t[2]=r[2]*c+e[2]*p+n[2]*f+o[2]*x,t}function w(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI,o=2*t.RANDOM()-1,a=Math.sqrt(1-o*o)*e;return r[0]=Math.cos(n)*a,r[1]=Math.sin(n)*a,r[2]=o*e,r}function D(t,r,e){var n=r[0],o=r[1],a=r[2],s=e[3]*n+e[7]*o+e[11]*a+e[15];return s=s||1,t[0]=(e[0]*n+e[4]*o+e[8]*a+e[12])/s,t[1]=(e[1]*n+e[5]*o+e[9]*a+e[13])/s,t[2]=(e[2]*n+e[6]*o+e[10]*a+e[14])/s,t}function L(t,r,e){var n=r[0],o=r[1],a=r[2];return t[0]=n*e[0]+o*e[3]+a*e[6],t[1]=n*e[1]+o*e[4]+a*e[7],t[2]=n*e[2]+o*e[5]+a*e[8],t}function N(t,r,e){var n=e[0],o=e[1],a=e[2],s=e[3],u=r[0],i=r[1],c=r[2],p=o*c-a*i,f=a*u-n*c,x=n*i-o*u,h=o*x-a*f,M=a*p-n*x,v=n*f-o*p,l=2*s;return p*=l,f*=l,x*=l,h*=2,M*=2,v*=2,t[0]=u+p+h,t[1]=i+f+M,t[2]=c+x+v,t}function I(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0],a[1]=o[1]*Math.cos(n)-o[2]*Math.sin(n),a[2]=o[1]*Math.sin(n)+o[2]*Math.cos(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function T(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[2]*Math.sin(n)+o[0]*Math.cos(n),a[1]=o[1],a[2]=o[2]*Math.cos(n)-o[0]*Math.sin(n),t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function z(t,r,e,n){var o=[],a=[];return o[0]=r[0]-e[0],o[1]=r[1]-e[1],o[2]=r[2]-e[2],a[0]=o[0]*Math.cos(n)-o[1]*Math.sin(n),a[1]=o[0]*Math.sin(n)+o[1]*Math.cos(n),a[2]=o[2],t[0]=a[0]+e[0],t[1]=a[1]+e[1],t[2]=a[2]+e[2],t}function S(t,r){var e=t[0],n=t[1],o=t[2],a=r[0],s=r[1],u=r[2],i=Math.sqrt(e*e+n*n+o*o)*Math.sqrt(a*a+s*s+u*u),c=i&&E(t,r)/i;return Math.acos(Math.min(Math.max(c,-1),1))}function k(t){return t[0]=0,t[1]=0,t[2]=0,t}function W(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function F(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function Q(r,e){var n=r[0],o=r[1],a=r[2],s=e[0],u=e[1],i=e[2];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(a-i)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(i))}var V=p;exports.sub=V;var X=f;exports.mul=X;var Z=x;exports.div=Z;var B=y;exports.dist=B;var C=O;exports.sqrDist=C;var G=a;exports.len=G;var H=P;exports.sqrLen=H;var J=function(){var t=n();return function(r,e,n,o,a,s){var u,i;for(e||(e=3),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,u=n;u<i;u+=e)t[0]=r[u],t[1]=r[u+1],t[2]=r[u+2],a(t,t,s),r[u]=t[0],r[u+1]=t[1],r[u+2]=t[2];return r}}();exports.forEach=J;
},{"./common.js":"XJqx"}],"zWbG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.fromValues=a,exports.copy=u,exports.set=s,exports.add=i,exports.subtract=c,exports.multiply=p,exports.divide=f,exports.ceil=x,exports.floor=h,exports.min=M,exports.max=l,exports.round=v,exports.scale=d,exports.scaleAndAdd=m,exports.distance=b,exports.squaredDistance=O,exports.length=y,exports.squaredLength=A,exports.negate=P,exports.inverse=R,exports.normalize=q,exports.dot=E,exports.cross=g,exports.lerp=w,exports.random=D,exports.transformMat4=j,exports.transformQuat=N,exports.zero=Y,exports.str=_,exports.exactEquals=L,exports.equals=I,exports.forEach=exports.sqrLen=exports.len=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function o(r){var e=new t.ARRAY_TYPE(4);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e}function a(r,e,n,o){var a=new t.ARRAY_TYPE(4);return a[0]=r,a[1]=e,a[2]=n,a[3]=o,a}function u(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function s(t,r,e,n,o){return t[0]=r,t[1]=e,t[2]=n,t[3]=o,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t}function c(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t}function p(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t[3]=r[3]*e[3],t}function f(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t[3]=r[3]/e[3],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t[3]=Math.ceil(r[3]),t}function h(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t[3]=Math.floor(r[3]),t}function M(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t[3]=Math.min(r[3],e[3]),t}function l(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t[3]=Math.max(r[3],e[3]),t}function v(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t[3]=Math.round(r[3]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return Math.hypot(e,n,o,a)}function O(t,r){var e=r[0]-t[0],n=r[1]-t[1],o=r[2]-t[2],a=r[3]-t[3];return e*e+n*n+o*o+a*a}function y(t){var r=t[0],e=t[1],n=t[2],o=t[3];return Math.hypot(r,e,n,o)}function A(t){var r=t[0],e=t[1],n=t[2],o=t[3];return r*r+e*e+n*n+o*o}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t}function R(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t[3]=1/r[3],t}function q(t,r){var e=r[0],n=r[1],o=r[2],a=r[3],u=e*e+n*n+o*o+a*a;return u>0&&(u=1/Math.sqrt(u)),t[0]=e*u,t[1]=n*u,t[2]=o*u,t[3]=a*u,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]}function g(t,r,e,n){var o=e[0]*n[1]-e[1]*n[0],a=e[0]*n[2]-e[2]*n[0],u=e[0]*n[3]-e[3]*n[0],s=e[1]*n[2]-e[2]*n[1],i=e[1]*n[3]-e[3]*n[1],c=e[2]*n[3]-e[3]*n[2],p=r[0],f=r[1],x=r[2],h=r[3];return t[0]=f*c-x*i+h*s,t[1]=-p*c+x*u-h*a,t[2]=p*i-f*u+h*o,t[3]=-p*s+f*a-x*o,t}function w(t,r,e,n){var o=r[0],a=r[1],u=r[2],s=r[3];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t[2]=u+n*(e[2]-u),t[3]=s+n*(e[3]-s),t}function D(r,e){var n,o,a,u,s,i;e=e||1;do{s=(n=2*t.RANDOM()-1)*n+(o=2*t.RANDOM()-1)*o}while(s>=1);do{i=(a=2*t.RANDOM()-1)*a+(u=2*t.RANDOM()-1)*u}while(i>=1);var c=Math.sqrt((1-s)/i);return r[0]=e*n,r[1]=e*o,r[2]=e*a*c,r[3]=e*u*c,r}function j(t,r,e){var n=r[0],o=r[1],a=r[2],u=r[3];return t[0]=e[0]*n+e[4]*o+e[8]*a+e[12]*u,t[1]=e[1]*n+e[5]*o+e[9]*a+e[13]*u,t[2]=e[2]*n+e[6]*o+e[10]*a+e[14]*u,t[3]=e[3]*n+e[7]*o+e[11]*a+e[15]*u,t}function N(t,r,e){var n=r[0],o=r[1],a=r[2],u=e[0],s=e[1],i=e[2],c=e[3],p=c*n+s*a-i*o,f=c*o+i*n-u*a,x=c*a+u*o-s*n,h=-u*n-s*o-i*a;return t[0]=p*c+h*-u+f*-i-x*-s,t[1]=f*c+h*-s+x*-u-p*-i,t[2]=x*c+h*-i+p*-s-f*-u,t[3]=r[3],t}function Y(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function _(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function L(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function I(r,e){var n=r[0],o=r[1],a=r[2],u=r[3],s=e[0],i=e[1],c=e[2],p=e[3];return Math.abs(n-s)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(o-i)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(a-c)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(u-p)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))}var S=c;exports.sub=S;var T=p;exports.mul=T;var k=f;exports.div=k;var z=b;exports.dist=z;var W=O;exports.sqrDist=W;var F=y;exports.len=F;var Q=A;exports.sqrLen=Q;var V=function(){var t=n();return function(r,e,n,o,a,u){var s,i;for(e||(e=4),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,s=n;s<i;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],t[3]=r[s+3],a(t,t,u),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2],r[s+3]=t[3];return r}}();exports.forEach=V;
},{"./common.js":"XJqx"}],"KdRW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=s,exports.identity=u,exports.setAxisAngle=p,exports.getAxisAngle=c,exports.getAngle=i,exports.multiply=x,exports.rotateX=l,exports.rotateY=f,exports.rotateZ=v,exports.calculateW=h,exports.exp=M,exports.ln=q,exports.pow=d,exports.slerp=m,exports.random=g,exports.invert=y,exports.conjugate=P,exports.fromMat3=A,exports.fromEuler=O,exports.str=j,exports.setAxes=exports.sqlerp=exports.rotationTo=exports.equals=exports.exactEquals=exports.normalize=exports.sqrLen=exports.squaredLength=exports.len=exports.length=exports.lerp=exports.dot=exports.scale=exports.mul=exports.add=exports.set=exports.copy=exports.fromValues=exports.clone=void 0;var t=n(require("./common.js")),r=n(require("./mat3.js")),e=n(require("./vec3.js")),o=n(require("./vec4.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a();if(r&&r.has(t))return r.get(t);var e={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var s=o?Object.getOwnPropertyDescriptor(t,n):null;s&&(s.get||s.set)?Object.defineProperty(e,n,s):e[n]=t[n]}return e.default=t,r&&r.set(t,e),e}function s(){var r=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function u(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function p(t,r,e){e*=.5;var o=Math.sin(e);return t[0]=o*r[0],t[1]=o*r[1],t[2]=o*r[2],t[3]=Math.cos(e),t}function c(r,e){var o=2*Math.acos(e[3]),a=Math.sin(o/2);return a>t.EPSILON?(r[0]=e[0]/a,r[1]=e[1]/a,r[2]=e[2]/a):(r[0]=1,r[1]=0,r[2]=0),o}function i(t,r){var e=D(t,r);return Math.acos(2*e*e-1)}function x(t,r,e){var o=r[0],a=r[1],n=r[2],s=r[3],u=e[0],p=e[1],c=e[2],i=e[3];return t[0]=o*i+s*u+a*c-n*p,t[1]=a*i+s*p+n*u-o*c,t[2]=n*i+s*c+o*p-a*u,t[3]=s*i-o*u-a*p-n*c,t}function l(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p+s*u,t[1]=a*p+n*u,t[2]=n*p-a*u,t[3]=s*p-o*u,t}function f(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p-n*u,t[1]=a*p+s*u,t[2]=n*p+o*u,t[3]=s*p-a*u,t}function v(t,r,e){e*=.5;var o=r[0],a=r[1],n=r[2],s=r[3],u=Math.sin(e),p=Math.cos(e);return t[0]=o*p+a*u,t[1]=a*p-o*u,t[2]=n*p+s*u,t[3]=s*p-n*u,t}function h(t,r){var e=r[0],o=r[1],a=r[2];return t[0]=e,t[1]=o,t[2]=a,t[3]=Math.sqrt(Math.abs(1-e*e-o*o-a*a)),t}function M(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=Math.sqrt(e*e+o*o+a*a),u=Math.exp(n),p=s>0?u*Math.sin(s)/s:0;return t[0]=e*p,t[1]=o*p,t[2]=a*p,t[3]=u*Math.cos(s),t}function q(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=Math.sqrt(e*e+o*o+a*a),u=s>0?Math.atan2(s,n)/s:0;return t[0]=e*u,t[1]=o*u,t[2]=a*u,t[3]=.5*Math.log(e*e+o*o+a*a+n*n),t}function d(t,r,e){return q(t,r),_(t,t,e),M(t,t),t}function m(r,e,o,a){var n,s,u,p,c,i=e[0],x=e[1],l=e[2],f=e[3],v=o[0],h=o[1],M=o[2],q=o[3];return(s=i*v+x*h+l*M+f*q)<0&&(s=-s,v=-v,h=-h,M=-M,q=-q),1-s>t.EPSILON?(n=Math.acos(s),u=Math.sin(n),p=Math.sin((1-a)*n)/u,c=Math.sin(a*n)/u):(p=1-a,c=a),r[0]=p*i+c*v,r[1]=p*x+c*h,r[2]=p*l+c*M,r[3]=p*f+c*q,r}function g(r){var e=t.RANDOM(),o=t.RANDOM(),a=t.RANDOM(),n=Math.sqrt(1-e),s=Math.sqrt(e);return r[0]=n*Math.sin(2*Math.PI*o),r[1]=n*Math.cos(2*Math.PI*o),r[2]=s*Math.sin(2*Math.PI*a),r[3]=s*Math.cos(2*Math.PI*a),r}function y(t,r){var e=r[0],o=r[1],a=r[2],n=r[3],s=e*e+o*o+a*a+n*n,u=s?1/s:0;return t[0]=-e*u,t[1]=-o*u,t[2]=-a*u,t[3]=n*u,t}function P(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t}function A(t,r){var e,o=r[0]+r[4]+r[8];if(o>0)e=Math.sqrt(o+1),t[3]=.5*e,e=.5/e,t[0]=(r[5]-r[7])*e,t[1]=(r[6]-r[2])*e,t[2]=(r[1]-r[3])*e;else{var a=0;r[4]>r[0]&&(a=1),r[8]>r[3*a+a]&&(a=2);var n=(a+1)%3,s=(a+2)%3;e=Math.sqrt(r[3*a+a]-r[3*n+n]-r[3*s+s]+1),t[a]=.5*e,e=.5/e,t[3]=(r[3*n+s]-r[3*s+n])*e,t[n]=(r[3*n+a]+r[3*a+n])*e,t[s]=(r[3*s+a]+r[3*a+s])*e}return t}function O(t,r,e,o){var a=.5*Math.PI/180;r*=a,e*=a,o*=a;var n=Math.sin(r),s=Math.cos(r),u=Math.sin(e),p=Math.cos(e),c=Math.sin(o),i=Math.cos(o);return t[0]=n*p*i-s*u*c,t[1]=s*u*i+n*p*c,t[2]=s*p*c-n*u*i,t[3]=s*p*i+n*u*c,t}function j(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var b=o.clone;exports.clone=b;var E=o.fromValues;exports.fromValues=E;var I=o.copy;exports.copy=I;var L=o.set;exports.set=L;var R=o.add;exports.add=R;var w=x;exports.mul=w;var _=o.scale;exports.scale=_;var D=o.dot;exports.dot=D;var N=o.lerp;exports.lerp=N;var V=o.length;exports.length=V;var Y=V;exports.len=Y;var z=o.squaredLength;exports.squaredLength=z;var T=z;exports.sqrLen=T;var W=o.normalize;exports.normalize=W;var k=o.exactEquals;exports.exactEquals=k;var S=o.equals;exports.equals=S;var F=function(){var t=e.create(),r=e.fromValues(1,0,0),o=e.fromValues(0,1,0);return function(a,n,s){var u=e.dot(n,s);return u<-.999999?(e.cross(t,r,n),e.len(t)<1e-6&&e.cross(t,o,n),e.normalize(t,t),p(a,t,Math.PI),a):u>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(e.cross(t,n,s),a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=1+u,W(a,a))}}();exports.rotationTo=F;var X=function(){var t=s(),r=s();return function(e,o,a,n,s,u){return m(t,o,s,u),m(r,a,n,u),m(e,t,r,2*u*(1-u)),e}}();exports.sqlerp=X;var Z=function(){var t=r.create();return function(r,e,o,a){return t[0]=o[0],t[3]=o[1],t[6]=o[2],t[1]=a[0],t[4]=a[1],t[7]=a[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],W(r,A(r,t))}}();exports.setAxes=Z;
},{"./common.js":"XJqx","./mat3.js":"vtQf","./vec3.js":"AWBd","./vec4.js":"zWbG"}],"buGF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=o,exports.clone=s,exports.fromValues=u,exports.fromRotationTranslationValues=p,exports.fromRotationTranslation=i,exports.fromTranslation=c,exports.fromRotation=f,exports.fromMat4=x,exports.copy=h,exports.identity=l,exports.set=M,exports.getDual=b,exports.setDual=m,exports.getTranslation=d,exports.translate=R,exports.rotateX=y,exports.rotateY=O,exports.rotateZ=g,exports.rotateByQuatAppend=A,exports.rotateByQuatPrepend=E,exports.rotateAroundAxis=L,exports.add=Y,exports.multiply=q,exports.scale=T,exports.lerp=w,exports.invert=I,exports.conjugate=N,exports.normalize=Q,exports.str=V,exports.exactEquals=W,exports.equals=X,exports.sqrLen=exports.squaredLength=exports.len=exports.length=exports.dot=exports.mul=exports.setReal=exports.getReal=void 0;var t=n(require("./common.js")),r=n(require("./quat.js")),e=n(require("./mat4.js"));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}function n(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var r=a();if(r&&r.has(t))return r.get(t);var e={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=n?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(e,o,s):e[o]=t[o]}return e.default=t,r&&r.set(t,e),e}function o(){var r=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r}function s(r){var e=new t.ARRAY_TYPE(8);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e}function u(r,e,a,n,o,s,u,p){var i=new t.ARRAY_TYPE(8);return i[0]=r,i[1]=e,i[2]=a,i[3]=n,i[4]=o,i[5]=s,i[6]=u,i[7]=p,i}function p(r,e,a,n,o,s,u){var p=new t.ARRAY_TYPE(8);p[0]=r,p[1]=e,p[2]=a,p[3]=n;var i=.5*o,c=.5*s,f=.5*u;return p[4]=i*n+c*a-f*e,p[5]=c*n+f*r-i*a,p[6]=f*n+i*e-c*r,p[7]=-i*r-c*e-f*a,p}function i(t,r,e){var a=.5*e[0],n=.5*e[1],o=.5*e[2],s=r[0],u=r[1],p=r[2],i=r[3];return t[0]=s,t[1]=u,t[2]=p,t[3]=i,t[4]=a*i+n*p-o*u,t[5]=n*i+o*s-a*p,t[6]=o*i+a*u-n*s,t[7]=-a*s-n*u-o*p,t}function c(t,r){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*r[0],t[5]=.5*r[1],t[6]=.5*r[2],t[7]=0,t}function f(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function x(a,n){var o=r.create();e.getRotation(o,n);var s=new t.ARRAY_TYPE(3);return e.getTranslation(s,n),i(a,o,s),a}function h(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t}function l(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function M(t,r,e,a,n,o,s,u,p){return t[0]=r,t[1]=e,t[2]=a,t[3]=n,t[4]=o,t[5]=s,t[6]=u,t[7]=p,t}var v=r.copy;function b(t,r){return t[0]=r[4],t[1]=r[5],t[2]=r[6],t[3]=r[7],t}exports.getReal=v;var P=r.copy;function m(t,r){return t[4]=r[0],t[5]=r[1],t[6]=r[2],t[7]=r[3],t}function d(t,r){var e=r[4],a=r[5],n=r[6],o=r[7],s=-r[0],u=-r[1],p=-r[2],i=r[3];return t[0]=2*(e*i+o*s+a*p-n*u),t[1]=2*(a*i+o*u+n*s-e*p),t[2]=2*(n*i+o*p+e*u-a*s),t}function R(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=.5*e[0],p=.5*e[1],i=.5*e[2],c=r[4],f=r[5],x=r[6],h=r[7];return t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=s*u+n*i-o*p+c,t[5]=s*p+o*u-a*i+f,t[6]=s*i+a*p-n*u+x,t[7]=-a*u-n*p-o*i+h,t}function y(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],c=e[6],f=e[7],x=p*u+f*n+i*s-c*o,h=i*u+f*o+c*n-p*s,l=c*u+f*s+p*o-i*n,M=f*u-p*n-i*o-c*s;return r.rotateX(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=x*u+M*n+h*s-l*o,t[5]=h*u+M*o+l*n-x*s,t[6]=l*u+M*s+x*o-h*n,t[7]=M*u-x*n-h*o-l*s,t}function O(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],c=e[6],f=e[7],x=p*u+f*n+i*s-c*o,h=i*u+f*o+c*n-p*s,l=c*u+f*s+p*o-i*n,M=f*u-p*n-i*o-c*s;return r.rotateY(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=x*u+M*n+h*s-l*o,t[5]=h*u+M*o+l*n-x*s,t[6]=l*u+M*s+x*o-h*n,t[7]=M*u-x*n-h*o-l*s,t}function g(t,e,a){var n=-e[0],o=-e[1],s=-e[2],u=e[3],p=e[4],i=e[5],c=e[6],f=e[7],x=p*u+f*n+i*s-c*o,h=i*u+f*o+c*n-p*s,l=c*u+f*s+p*o-i*n,M=f*u-p*n-i*o-c*s;return r.rotateZ(t,e,a),n=t[0],o=t[1],s=t[2],u=t[3],t[4]=x*u+M*n+h*s-l*o,t[5]=h*u+M*o+l*n-x*s,t[6]=l*u+M*s+x*o-h*n,t[7]=M*u-x*n-h*o-l*s,t}function A(t,r,e){var a=e[0],n=e[1],o=e[2],s=e[3],u=r[0],p=r[1],i=r[2],c=r[3];return t[0]=u*s+c*a+p*o-i*n,t[1]=p*s+c*n+i*a-u*o,t[2]=i*s+c*o+u*n-p*a,t[3]=c*s-u*a-p*n-i*o,u=r[4],p=r[5],i=r[6],c=r[7],t[4]=u*s+c*a+p*o-i*n,t[5]=p*s+c*n+i*a-u*o,t[6]=i*s+c*o+u*n-p*a,t[7]=c*s-u*a-p*n-i*o,t}function E(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=e[0],p=e[1],i=e[2],c=e[3];return t[0]=a*c+s*u+n*i-o*p,t[1]=n*c+s*p+o*u-a*i,t[2]=o*c+s*i+a*p-n*u,t[3]=s*c-a*u-n*p-o*i,u=e[4],p=e[5],i=e[6],c=e[7],t[4]=a*c+s*u+n*i-o*p,t[5]=n*c+s*p+o*u-a*i,t[6]=o*c+s*i+a*p-n*u,t[7]=s*c-a*u-n*p-o*i,t}function L(r,e,a,n){if(Math.abs(n)<t.EPSILON)return h(r,e);var o=Math.hypot(a[0],a[1],a[2]);n*=.5;var s=Math.sin(n),u=s*a[0]/o,p=s*a[1]/o,i=s*a[2]/o,c=Math.cos(n),f=e[0],x=e[1],l=e[2],M=e[3];r[0]=f*c+M*u+x*i-l*p,r[1]=x*c+M*p+l*u-f*i,r[2]=l*c+M*i+f*p-x*u,r[3]=M*c-f*u-x*p-l*i;var v=e[4],b=e[5],P=e[6],m=e[7];return r[4]=v*c+m*u+b*i-P*p,r[5]=b*c+m*p+P*u-v*i,r[6]=P*c+m*i+v*p-b*u,r[7]=m*c-v*u-b*p-P*i,r}function Y(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t[6]=r[6]+e[6],t[7]=r[7]+e[7],t}function q(t,r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=e[4],p=e[5],i=e[6],c=e[7],f=r[4],x=r[5],h=r[6],l=r[7],M=e[0],v=e[1],b=e[2],P=e[3];return t[0]=a*P+s*M+n*b-o*v,t[1]=n*P+s*v+o*M-a*b,t[2]=o*P+s*b+a*v-n*M,t[3]=s*P-a*M-n*v-o*b,t[4]=a*c+s*u+n*i-o*p+f*P+l*M+x*b-h*v,t[5]=n*c+s*p+o*u-a*i+x*P+l*v+h*M-f*b,t[6]=o*c+s*i+a*p-n*u+h*P+l*b+f*v-x*M,t[7]=s*c-a*u-n*p-o*i+l*P-f*M-x*v-h*b,t}exports.setReal=P;var j=q;function T(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t}exports.mul=j;var _=r.dot;function w(t,r,e,a){var n=1-a;return _(r,e)<0&&(a=-a),t[0]=r[0]*n+e[0]*a,t[1]=r[1]*n+e[1]*a,t[2]=r[2]*n+e[2]*a,t[3]=r[3]*n+e[3]*a,t[4]=r[4]*n+e[4]*a,t[5]=r[5]*n+e[5]*a,t[6]=r[6]*n+e[6]*a,t[7]=r[7]*n+e[7]*a,t}function I(t,r){var e=k(r);return t[0]=-r[0]/e,t[1]=-r[1]/e,t[2]=-r[2]/e,t[3]=r[3]/e,t[4]=-r[4]/e,t[5]=-r[5]/e,t[6]=-r[6]/e,t[7]=r[7]/e,t}function N(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t[4]=-r[4],t[5]=-r[5],t[6]=-r[6],t[7]=r[7],t}exports.dot=_;var S=r.length;exports.length=S;var D=S;exports.len=D;var k=r.squaredLength;exports.squaredLength=k;var B=k;function Q(t,r){var e=k(r);if(e>0){e=Math.sqrt(e);var a=r[0]/e,n=r[1]/e,o=r[2]/e,s=r[3]/e,u=r[4],p=r[5],i=r[6],c=r[7],f=a*u+n*p+o*i+s*c;t[0]=a,t[1]=n,t[2]=o,t[3]=s,t[4]=(u-a*f)/e,t[5]=(p-n*f)/e,t[6]=(i-o*f)/e,t[7]=(c-s*f)/e}return t}function V(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function W(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]}function X(r,e){var a=r[0],n=r[1],o=r[2],s=r[3],u=r[4],p=r[5],i=r[6],c=r[7],f=e[0],x=e[1],h=e[2],l=e[3],M=e[4],v=e[5],b=e[6],P=e[7];return Math.abs(a-f)<=t.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(n-x)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(o-h)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(s-l)<=t.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(u-M)<=t.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(p-v)<=t.EPSILON*Math.max(1,Math.abs(p),Math.abs(v))&&Math.abs(i-b)<=t.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(c-P)<=t.EPSILON*Math.max(1,Math.abs(c),Math.abs(P))}exports.sqrLen=B;
},{"./common.js":"XJqx","./quat.js":"KdRW","./mat4.js":"w3aR"}],"XSo1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=n,exports.clone=o,exports.fromValues=a,exports.copy=u,exports.set=s,exports.add=i,exports.subtract=c,exports.multiply=p,exports.divide=f,exports.ceil=x,exports.floor=h,exports.min=v,exports.max=M,exports.round=l,exports.scale=d,exports.scaleAndAdd=m,exports.distance=b,exports.squaredDistance=y,exports.length=P,exports.squaredLength=q,exports.negate=A,exports.inverse=O,exports.normalize=g,exports.dot=E,exports.cross=R,exports.lerp=j,exports.random=Y,exports.transformMat2=_,exports.transformMat2d=w,exports.transformMat3=D,exports.transformMat4=L,exports.rotate=T,exports.angle=I,exports.zero=N,exports.str=k,exports.exactEquals=z,exports.equals=S,exports.forEach=exports.sqrLen=exports.sqrDist=exports.dist=exports.div=exports.mul=exports.sub=exports.len=void 0;var t=e(require("./common.js"));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}function e(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var u=o?Object.getOwnPropertyDescriptor(t,a):null;u&&(u.get||u.set)?Object.defineProperty(n,a,u):n[a]=t[a]}return n.default=t,e&&e.set(t,n),n}function n(){var r=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function o(r){var e=new t.ARRAY_TYPE(2);return e[0]=r[0],e[1]=r[1],e}function a(r,e){var n=new t.ARRAY_TYPE(2);return n[0]=r,n[1]=e,n}function u(t,r){return t[0]=r[0],t[1]=r[1],t}function s(t,r,e){return t[0]=r,t[1]=e,t}function i(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t}function c(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t}function p(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t}function f(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t}function x(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t}function h(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t}function v(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t}function M(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t}function l(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t}function d(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t}function m(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t}function b(t,r){var e=r[0]-t[0],n=r[1]-t[1];return Math.hypot(e,n)}function y(t,r){var e=r[0]-t[0],n=r[1]-t[1];return e*e+n*n}function P(t){var r=t[0],e=t[1];return Math.hypot(r,e)}function q(t){var r=t[0],e=t[1];return r*r+e*e}function A(t,r){return t[0]=-r[0],t[1]=-r[1],t}function O(t,r){return t[0]=1/r[0],t[1]=1/r[1],t}function g(t,r){var e=r[0],n=r[1],o=e*e+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=r[0]*o,t[1]=r[1]*o,t}function E(t,r){return t[0]*r[0]+t[1]*r[1]}function R(t,r,e){var n=r[0]*e[1]-r[1]*e[0];return t[0]=t[1]=0,t[2]=n,t}function j(t,r,e,n){var o=r[0],a=r[1];return t[0]=o+n*(e[0]-o),t[1]=a+n*(e[1]-a),t}function Y(r,e){e=e||1;var n=2*t.RANDOM()*Math.PI;return r[0]=Math.cos(n)*e,r[1]=Math.sin(n)*e,r}function _(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o,t[1]=e[1]*n+e[3]*o,t}function w(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[2]*o+e[4],t[1]=e[1]*n+e[3]*o+e[5],t}function D(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[3]*o+e[6],t[1]=e[1]*n+e[4]*o+e[7],t}function L(t,r,e){var n=r[0],o=r[1];return t[0]=e[0]*n+e[4]*o+e[12],t[1]=e[1]*n+e[5]*o+e[13],t}function T(t,r,e,n){var o=r[0]-e[0],a=r[1]-e[1],u=Math.sin(n),s=Math.cos(n);return t[0]=o*s-a*u+e[0],t[1]=o*u+a*s+e[1],t}function I(t,r){var e=t[0],n=t[1],o=r[0],a=r[1],u=Math.sqrt(e*e+n*n)*Math.sqrt(o*o+a*a),s=u&&(e*o+n*a)/u;return Math.acos(Math.min(Math.max(s,-1),1))}function N(t){return t[0]=0,t[1]=0,t}function k(t){return"vec2("+t[0]+", "+t[1]+")"}function z(t,r){return t[0]===r[0]&&t[1]===r[1]}function S(r,e){var n=r[0],o=r[1],a=e[0],u=e[1];return Math.abs(n-a)<=t.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-u)<=t.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))}var W=P;exports.len=W;var F=c;exports.sub=F;var V=p;exports.mul=V;var B=f;exports.div=B;var C=b;exports.dist=C;var G=y;exports.sqrDist=G;var H=q;exports.sqrLen=H;var J=function(){var t=n();return function(r,e,n,o,a,u){var s,i;for(e||(e=2),n||(n=0),i=o?Math.min(o*e+n,r.length):r.length,s=n;s<i;s+=e)t[0]=r[s],t[1]=r[s+1],a(t,t,u),r[s]=t[0],r[s+1]=t[1];return r}}();exports.forEach=J;
},{"./common.js":"XJqx"}],"IF0X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.vec4=exports.vec3=exports.vec2=exports.quat2=exports.quat=exports.mat4=exports.mat3=exports.mat2d=exports.mat2=exports.glMatrix=void 0;var e=v(require("./common.js"));exports.glMatrix=e;var r=v(require("./mat2.js"));exports.mat2=r;var t=v(require("./mat2d.js"));exports.mat2d=t;var o=v(require("./mat3.js"));exports.mat3=o;var a=v(require("./mat4.js"));exports.mat4=a;var s=v(require("./quat.js"));exports.quat=s;var u=v(require("./quat2.js"));exports.quat2=u;var p=v(require("./vec2.js"));exports.vec2=p;var i=v(require("./vec3.js"));exports.vec3=i;var n=v(require("./vec4.js"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function v(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=c();if(r&&r.has(e))return r.get(e);var t={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var s=o?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(t,a,s):t[a]=e[a]}return t.default=e,r&&r.set(e,t),t}exports.vec4=n;
},{"./common.js":"XJqx","./mat2.js":"eN7R","./mat2d.js":"M21d","./mat3.js":"vtQf","./mat4.js":"w3aR","./quat.js":"KdRW","./quat2.js":"buGF","./vec2.js":"XSo1","./vec3.js":"AWBd","./vec4.js":"zWbG"}],"EBub":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof e&&e.amd?e(r):t.createREGL=r()}(this,function(){"use strict";var e=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray},t=function(e,t){for(var r=Object.keys(t),n=0;n<r.length;++n)e[r[n]]=t[r[n]];return e},r="\n";function n(e){var t=new Error("(regl) "+e);throw console.error(t),t}function a(e,t){e||n(t)}function i(e){return e?": "+e:""}function o(e,t){switch(t){case"number":return"number"==typeof e;case"object":return"object"==typeof e;case"string":return"string"==typeof e;case"boolean":return"boolean"==typeof e;case"function":return"function"==typeof e;case"undefined":return void 0===e;case"symbol":return"symbol"==typeof e}}function f(e,t,r){t.indexOf(e)<0&&n("invalid value"+i(r)+". must be one of: "+t)}var u=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function s(e,t){for(e+="";e.length<t;)e=" "+e;return e}function c(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function l(e,t){this.number=e,this.line=t,this.errors=[]}function d(e,t,r){this.file=e,this.line=t,this.message=r}function m(){var e=new Error,t=(e.stack||e).toString(),r=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(t);if(r)return r[1];var n=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(t);return n?n[1]:"unknown"}function p(){var e=new Error,t=(e.stack||e).toString(),r=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(t);if(r)return r[1];var n=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(t);return n?n[1]:"unknown"}function h(e,t){var r,n=e.split("\n"),a=1,i=0,o={unknown:new c,0:new c};o.unknown.name=o[0].name=t||m(),o.unknown.lines.push(new l(0,""));for(var f=0;f<n.length;++f){var u=n[f],s=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(s)switch(s[1]){case"line":var d=/(\d+)(\s+\d+)?/.exec(s[2]);d&&(a=0|d[1],d[2]&&((i=0|d[2])in o||(o[i]=new c)));break;case"define":var p=/SHADER_NAME(_B64)?\s+(.*)$/.exec(s[2]);p&&(o[i].name=p[1]?(r=p[2],"undefined"!=typeof atob?atob(r):"base64:"+r):p[2])}o[i].lines.push(new l(a++,u))}return Object.keys(o).forEach(function(e){var t=o[e];t.lines.forEach(function(e){t.index[e.number]=e})}),o}function b(e){e._commandRef=m()}function v(e,t){var r=p();n(e+" in command "+(t||m())+("unknown"===r?"":" called from "+r))}function g(e,t,r,n){o(e,t)||v("invalid parameter type"+i(r)+". expected "+t+", got "+typeof e,n||m())}var y=33071,x=9728,w=9984,A=9985,_=9986,k=9987,S=5126,E=32819,O=32820,T=33635,j=34042,D={};function C(e,t){return e===O||e===E||e===T?2:e===j?4:D[e]*t}function z(e){return!(e&e-1||!e)}D[5120]=D[5121]=1,D[5122]=D[5123]=D[36193]=D[T]=D[E]=D[O]=2,D[5124]=D[5125]=D[S]=D[j]=4;var F=t(a,{optional:function(e){e()},raise:n,commandRaise:v,command:function(e,t,r){e||v(t,r||m())},parameter:function(e,t,r){e in t||n("unknown parameter ("+e+")"+i(r)+". possible values: "+Object.keys(t).join())},commandParameter:function(e,t,r,n){e in t||v("unknown parameter ("+e+")"+i(r)+". possible values: "+Object.keys(t).join(),n||m())},constructor:function(e){Object.keys(e).forEach(function(e){u.indexOf(e)<0&&n('invalid regl constructor argument "'+e+'". must be one of '+u)})},type:function(e,t,r){o(e,t)||n("invalid parameter type"+i(r)+". expected "+t+", got "+typeof e)},commandType:g,isTypedArray:function(t,r){e(t)||n("invalid parameter type"+i(r)+". must be a typed array")},nni:function(e,t){e>=0&&(0|e)===e||n("invalid parameter type, ("+e+")"+i(t)+". must be a nonnegative integer")},oneOf:f,shaderError:function(e,t,n,i,o){if(!e.getShaderParameter(t,e.COMPILE_STATUS)){var f=e.getShaderInfoLog(t),u=i===e.FRAGMENT_SHADER?"fragment":"vertex";g(n,"string",u+" shader source must be a string",o);var c=h(n,o),l=function(e){var t=[];return e.split("\n").forEach(function(e){if(!(e.length<5)){var r=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(e);r?t.push(new d(0|r[1],0|r[2],r[3].trim())):e.length>0&&t.push(new d("unknown",0,e))}}),t}(f);!function(e,t){t.forEach(function(t){var r=e[t.file];if(r){var n=r.index[t.line];if(n)return n.errors.push(t),void(r.hasErrors=!0)}e.unknown.hasErrors=!0,e.unknown.lines[0].errors.push(t)})}(c,l),Object.keys(c).forEach(function(e){var t=c[e];if(t.hasErrors){var n=[""],a=[""];i("file number "+e+": "+t.name+"\n","color:red;text-decoration:underline;font-weight:bold"),t.lines.forEach(function(e){if(e.errors.length>0){i(s(e.number,4)+"|  ","background-color:yellow; font-weight:bold"),i(e.line+r,"color:red; background-color:yellow; font-weight:bold");var t=0;e.errors.forEach(function(n){var a=n.message,o=/^\s*'(.*)'\s*:\s*(.*)$/.exec(a);if(o){var f=o[1];switch(a=o[2],f){case"assign":f="="}t=Math.max(e.line.indexOf(f,t),0)}else t=0;i(s("| ",6)),i(s("^^^",t+3)+r,"font-weight:bold"),i(s("| ",6)),i(a+r,"font-weight:bold")}),i(s("| ",6)+r)}else i(s(e.number,4)+"|  "),i(e.line+r,"color:red")}),"undefined"==typeof document||window.chrome?console.log(n.join("")):(a[0]=n.join("%c"),console.log.apply(console,a))}function i(e,t){n.push(e),a.push(t||"")}}),a.raise("Error compiling "+u+" shader, "+c[0].name)}},linkError:function(e,t,n,i,o){if(!e.getProgramParameter(t,e.LINK_STATUS)){var f=e.getProgramInfoLog(t),u=h(n,o),s='Error linking program with vertex shader, "'+h(i,o)[0].name+'", and fragment shader "'+u[0].name+'"';"undefined"!=typeof document?console.log("%c"+s+r+"%c"+f,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(s+r+f),a.raise(s)}},callSite:p,saveCommandRef:b,saveDrawInfo:function(e,t,r,n){function a(e){return e?n.id(e):0}function i(e,t){Object.keys(t).forEach(function(t){e[n.id(t)]=!0})}b(e),e._fragId=a(e.static.frag),e._vertId=a(e.static.vert);var o=e._uniformSet={};i(o,t.static),i(o,t.dynamic);var f=e._attributeSet={};i(f,r.static),i(f,r.dynamic),e._hasCount="count"in e.static||"count"in e.dynamic||"elements"in e.static||"elements"in e.dynamic},framebufferFormat:function(e,t,r){e.texture?f(e.texture._texture.internalformat,t,"unsupported texture format for attachment"):f(e.renderbuffer._renderbuffer.format,r,"unsupported renderbuffer format for attachment")},guessCommand:m,texture2D:function(e,t,r){var n,i=t.width,o=t.height,f=t.channels;a(i>0&&i<=r.maxTextureSize&&o>0&&o<=r.maxTextureSize,"invalid texture shape"),e.wrapS===y&&e.wrapT===y||a(z(i)&&z(o),"incompatible wrap mode for texture, both width and height must be power of 2"),1===t.mipmask?1!==i&&1!==o&&a(e.minFilter!==w&&e.minFilter!==_&&e.minFilter!==A&&e.minFilter!==k,"min filter requires mipmap"):(a(z(i)&&z(o),"texture must be a square power of 2 to support mipmapping"),a(t.mipmask===(i<<1)-1,"missing or incomplete mipmap data")),t.type===S&&(r.extensions.indexOf("oes_texture_float_linear")<0&&a(e.minFilter===x&&e.magFilter===x,"filter not supported, must enable oes_texture_float_linear"),a(!e.genMipmaps,"mipmap generation not supported with float textures"));var u=t.images;for(n=0;n<16;++n)if(u[n]){var s=i>>n,c=o>>n;a(t.mipmask&1<<n,"missing mipmap data");var l=u[n];if(a(l.width===s&&l.height===c,"invalid shape for mip images"),a(l.format===t.format&&l.internalformat===t.internalformat&&l.type===t.type,"incompatible type for mip image"),l.compressed);else if(l.data){var d=Math.ceil(C(l.type,f)*s/l.unpackAlignment)*l.unpackAlignment;a(l.data.byteLength===d*c,"invalid data for image, buffer size is inconsistent with image format")}else l.element||l.copy}else e.genMipmaps||a(0==(t.mipmask&1<<n),"extra mipmap data");t.compressed&&a(!e.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(e,t,r,n){var i=e.width,o=e.height,f=e.channels;a(i>0&&i<=n.maxTextureSize&&o>0&&o<=n.maxTextureSize,"invalid texture shape"),a(i===o,"cube map must be square"),a(t.wrapS===y&&t.wrapT===y,"wrap mode not supported by cube map");for(var u=0;u<r.length;++u){var s=r[u];a(s.width===i&&s.height===o,"inconsistent cube map face shape"),t.genMipmaps&&(a(!s.compressed,"can not generate mipmap for compressed textures"),a(1===s.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=s.images,l=0;l<16;++l){var d=c[l];if(d){var m=i>>l,p=o>>l;a(s.mipmask&1<<l,"missing mipmap data"),a(d.width===m&&d.height===p,"invalid shape for mip images"),a(d.format===e.format&&d.internalformat===e.internalformat&&d.type===e.type,"incompatible type for mip image"),d.compressed||(d.data?a(d.data.byteLength===m*p*Math.max(C(d.type,f),d.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):d.element||d.copy)}}}}}),B=0,V=0;function P(e,t){this.id=B++,this.type=e,this.data=t}function L(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function R(e){return"["+function e(t){if(0===t.length)return[];var r=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&r===n&&('"'===r||"'"===r))return['"'+L(t.substr(1,t.length-2))+'"'];var a=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(a)return e(t.substr(0,a.index)).concat(e(a[1])).concat(e(t.substr(a.index+a[0].length)));var i=t.split(".");if(1===i.length)return['"'+L(t)+'"'];for(var o=[],f=0;f<i.length;++f)o=o.concat(e(i[f]));return o}(e).join("][")+"]"}var I={DynamicVariable:P,define:function(e,t){return new P(e,R(t+""))},isDynamic:function(e){return"function"==typeof e&&!e._reglType||e instanceof P},unbox:function(e,t){return"function"==typeof e?new P(V,e):e},accessor:R},M={next:"function"==typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"==typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},W="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function U(e){return"string"==typeof e?e.split():(F(Array.isArray(e),"invalid extension array"),e)}function G(e){return"string"==typeof e?(F("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(e)):e}function H(e){var r,n,a,i,o,f=e||{},u={},s=[],c=[],l="undefined"==typeof window?1:window.devicePixelRatio,d=!1,m=function(e){e&&F.raise(e)},p=function(){};if("string"==typeof f?(F("undefined"!=typeof document,"selector queries only supported in DOM enviroments"),r=document.querySelector(f),F(r,"invalid query string for element")):"object"==typeof f?"string"==typeof(o=f).nodeName&&"function"==typeof o.appendChild&&"function"==typeof o.getBoundingClientRect?r=f:!function(e){return"function"==typeof e.drawArrays||"function"==typeof e.drawElements}(f)?(F.constructor(f),"gl"in f?i=f.gl:"canvas"in f?a=G(f.canvas):"container"in f&&(n=G(f.container)),"attributes"in f&&(u=f.attributes,F.type(u,"object","invalid context attributes")),"extensions"in f&&(s=U(f.extensions)),"optionalExtensions"in f&&(c=U(f.optionalExtensions)),"onDone"in f&&(F.type(f.onDone,"function","invalid or missing onDone callback"),m=f.onDone),"profile"in f&&(d=!!f.profile),"pixelRatio"in f&&(l=+f.pixelRatio,F(l>0,"invalid pixel ratio"))):a=(i=f).canvas:F.raise("invalid arguments to regl"),r&&("canvas"===r.nodeName.toLowerCase()?a=r:n=r),!i){if(!a){F("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var h=function(e,r,n){var a,i=document.createElement("canvas");function o(){var r=window.innerWidth,a=window.innerHeight;if(e!==document.body){var o=e.getBoundingClientRect();r=o.right-o.left,a=o.bottom-o.top}i.width=n*r,i.height=n*a,t(i.style,{width:r+"px",height:a+"px"})}return t(i.style,{border:0,margin:0,padding:0,top:0,left:0}),e.appendChild(i),e===document.body&&(i.style.position="absolute",t(e.style,{margin:0,padding:0})),e!==document.body&&"function"==typeof ResizeObserver?(a=new ResizeObserver(function(){setTimeout(o)})).observe(e):window.addEventListener("resize",o,!1),o(),{canvas:i,onDestroy:function(){a?a.disconnect():window.removeEventListener("resize",o),e.removeChild(i)}}}(n||document.body,0,l);if(!h)return null;a=h.canvas,p=h.onDestroy}void 0===u.premultipliedAlpha&&(u.premultipliedAlpha=!0),i=function(e,t){function r(r){try{return e.getContext(r,t)}catch(n){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}(a,u)}return i?{gl:i,canvas:a,container:n,extensions:s,optionalExtensions:c,pixelRatio:l,profile:d,onDone:m,onDestroy:p}:(p(),m("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function N(e,t){for(var r=Array(e),n=0;n<e;++n)r[n]=t(n);return r}var q=5120,Q=5121,Y=5122,X=5123,$=5124,K=5125,J=5126;function Z(e){var t,r;return t=(e>65535)<<4,t|=r=((e>>>=t)>255)<<3,t|=r=((e>>>=r)>15)<<2,(t|=r=((e>>>=r)>3)<<1)|(e>>>=r)>>1}function ee(){var e=N(8,function(){return[]});function t(t){var r=function(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}(t),n=e[Z(r)>>2];return n.length>0?n.pop():new ArrayBuffer(r)}function r(t){e[Z(t.byteLength)>>2].push(t)}return{alloc:t,free:r,allocType:function(e,r){var n=null;switch(e){case q:n=new Int8Array(t(r),0,r);break;case Q:n=new Uint8Array(t(r),0,r);break;case Y:n=new Int16Array(t(2*r),0,r);break;case X:n=new Uint16Array(t(2*r),0,r);break;case $:n=new Int32Array(t(4*r),0,r);break;case K:n=new Uint32Array(t(4*r),0,r);break;case J:n=new Float32Array(t(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n},freeType:function(e){r(e.buffer)}}}var te=ee();te.zero=ee();var re=function(e,t){var r=1;t.ext_texture_filter_anisotropic&&(r=e.getParameter(34047));var n=1,a=1;t.webgl_draw_buffers&&(n=e.getParameter(34852),a=e.getParameter(36063));var i=!!t.oes_texture_float;if(i){var o=e.createTexture();e.bindTexture(3553,o),e.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var f=e.createFramebuffer();if(e.bindFramebuffer(36160,f),e.framebufferTexture2D(36160,36064,3553,o,0),e.bindTexture(3553,null),36053!==e.checkFramebufferStatus(36160))i=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(16384);var u=te.allocType(5126,4);e.readPixels(0,0,1,1,6408,5126,u),e.getError()?i=!1:(e.deleteFramebuffer(f),e.deleteTexture(o),i=1===u[0]),te.freeType(u)}}var s=!0;if(!("undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)))){var c=e.createTexture(),l=te.allocType(5121,36);e.activeTexture(33984),e.bindTexture(34067,c),e.texImage2D(34069,0,6408,3,3,0,6408,5121,l),te.freeType(l),e.bindTexture(34067,null),e.deleteTexture(c),s=!e.getError()}return{colorBits:[e.getParameter(3410),e.getParameter(3411),e.getParameter(3412),e.getParameter(3413)],depthBits:e.getParameter(3414),stencilBits:e.getParameter(3415),subpixelBits:e.getParameter(3408),extensions:Object.keys(t).filter(function(e){return!!t[e]}),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:a,pointSizeDims:e.getParameter(33901),lineWidthDims:e.getParameter(33902),maxViewportDims:e.getParameter(3386),maxCombinedTextureUnits:e.getParameter(35661),maxCubeMapSize:e.getParameter(34076),maxRenderbufferSize:e.getParameter(34024),maxTextureUnits:e.getParameter(34930),maxTextureSize:e.getParameter(3379),maxAttributes:e.getParameter(34921),maxVertexUniforms:e.getParameter(36347),maxVertexTextureUnits:e.getParameter(35660),maxVaryingVectors:e.getParameter(36348),maxFragmentUniforms:e.getParameter(36349),glsl:e.getParameter(35724),renderer:e.getParameter(7937),vendor:e.getParameter(7936),version:e.getParameter(7938),readFloat:i,npotTextureCube:s}};function ne(t){return!!t&&"object"==typeof t&&Array.isArray(t.shape)&&Array.isArray(t.stride)&&"number"==typeof t.offset&&t.shape.length===t.stride.length&&(Array.isArray(t.data)||e(t.data))}var ae=function(e){return Object.keys(e).map(function(t){return e[t]})},ie={shape:function(e){for(var t=[],r=e;r.length;r=r[0])t.push(r.length);return t},flatten:function(e,t,r,n){var a=1;if(t.length)for(var i=0;i<t.length;++i)a*=t[i];else a=0;var o=n||te.allocType(r,a);switch(t.length){case 0:break;case 1:!function(e,t,r){for(var n=0;n<t;++n)r[n]=e[n]}(e,t[0],o);break;case 2:!function(e,t,r,n){for(var a=0,i=0;i<t;++i)for(var o=e[i],f=0;f<r;++f)n[a++]=o[f]}(e,t[0],t[1],o);break;case 3:oe(e,t[0],t[1],t[2],o,0);break;default:!function e(t,r,n,a,i){var o=1;for(var f=n+1;f<r.length;++f)o*=r[f];var u=r[n];if(r.length-n==4){var s=r[n+1],c=r[n+2],l=r[n+3];for(f=0;f<u;++f)oe(t[f],s,c,l,a,i),i+=o}else for(f=0;f<u;++f)e(t[f],r,n+1,a,i),i+=o}(e,t,0,o,0)}return o}};function oe(e,t,r,n,a,i){for(var o=i,f=0;f<t;++f)for(var u=e[f],s=0;s<r;++s)for(var c=u[s],l=0;l<n;++l)a[o++]=c[l]}var fe={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ue={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},se={dynamic:35048,stream:35040,static:35044},ce=ie.flatten,le=ie.shape,de=35044,me=35040,pe=5121,he=5126,be=[];function ve(e){return 0|fe[Object.prototype.toString.call(e)]}function ge(e,t){for(var r=0;r<t.length;++r)e[r]=t[r]}function ye(e,t,r,n,a,i,o){for(var f=0,u=0;u<r;++u)for(var s=0;s<n;++s)e[f++]=t[a*u+i*s+o]}be[5120]=1,be[5122]=2,be[5124]=4,be[5121]=1,be[5123]=2,be[5125]=4,be[5126]=4;var xe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},we=0,Ae=1,_e=4,ke=5120,Se=5121,Ee=5122,Oe=5123,Te=5124,je=5125,De=34963,Ce=35040,ze=35044;var Fe=new Float32Array(1),Be=new Uint32Array(Fe.buffer),Ve=5123;function Pe(e){for(var t=te.allocType(Ve,e.length),r=0;r<e.length;++r)if(isNaN(e[r]))t[r]=65535;else if(e[r]===1/0)t[r]=31744;else if(e[r]===-1/0)t[r]=64512;else{Fe[0]=e[r];var n=Be[0],a=n>>>31<<15,i=(n<<1>>>24)-127,o=n>>13&1023;if(i<-24)t[r]=a;else if(i<-14){var f=-14-i;t[r]=a+(o+1024>>f)}else t[r]=i>15?a+31744:a+(i+15<<10)+o}return t}function Le(t){return Array.isArray(t)||e(t)}var Re=function(e){return!(e&e-1||!e)},Ie=34467,Me=3553,We=34067,Ue=34069,Ge=6408,He=6406,Ne=6407,qe=6409,Qe=6410,Ye=32854,Xe=32855,$e=36194,Ke=32819,Je=32820,Ze=33635,et=34042,tt=6402,rt=34041,nt=35904,at=35906,it=36193,ot=33776,ft=33777,ut=33778,st=33779,ct=35986,lt=35987,dt=34798,mt=35840,pt=35841,ht=35842,bt=35843,vt=36196,gt=5121,yt=5123,xt=5125,wt=5126,At=10242,_t=10243,kt=10497,St=33071,Et=33648,Ot=10240,Tt=10241,jt=9728,Dt=9729,Ct=9984,zt=9985,Ft=9986,Bt=9987,Vt=33170,Pt=4352,Lt=4353,Rt=4354,It=34046,Mt=3317,Wt=37440,Ut=37441,Gt=37443,Ht=37444,Nt=33984,qt=[Ct,Ft,zt,Bt],Qt=[0,qe,Qe,Ne,Ge],Yt={};function Xt(e){return"[object "+e+"]"}Yt[qe]=Yt[He]=Yt[tt]=1,Yt[rt]=Yt[Qe]=2,Yt[Ne]=Yt[nt]=3,Yt[Ge]=Yt[at]=4;var $t=Xt("HTMLCanvasElement"),Kt=Xt("OffscreenCanvas"),Jt=Xt("CanvasRenderingContext2D"),Zt=Xt("ImageBitmap"),er=Xt("HTMLImageElement"),tr=Xt("HTMLVideoElement"),rr=Object.keys(fe).concat([$t,Kt,Jt,Zt,er,tr]),nr=[];nr[gt]=1,nr[wt]=4,nr[it]=2,nr[yt]=2,nr[xt]=4;var ar=[];function ir(e){return Array.isArray(e)&&(0===e.length||"number"==typeof e[0])}function or(e){return!!Array.isArray(e)&&!(0===e.length||!Le(e[0]))}function fr(e){return Object.prototype.toString.call(e)}function ur(e){return fr(e)===$t}function sr(e){return fr(e)===Kt}function cr(e){if(!e)return!1;var t=fr(e);return rr.indexOf(t)>=0||(ir(e)||or(e)||ne(e))}function lr(e){return 0|fe[Object.prototype.toString.call(e)]}function dr(e,t){return te.allocType(e.type===it?wt:e.type,t)}function mr(e,t){e.type===it?(e.data=Pe(t),te.freeType(t)):e.data=t}function pr(e,t,r,n,a,i){var o;if(o=void 0!==ar[e]?ar[e]:Yt[e]*nr[t],i&&(o*=6),a){for(var f=0,u=r;u>=1;)f+=o*u*u,u/=2;return f}return o*r*n}function hr(r,n,a,i,o,f,u){var s={"don't care":Pt,"dont care":Pt,nice:Rt,fast:Lt},c={repeat:kt,clamp:St,mirror:Et},l={nearest:jt,linear:Dt},d=t({mipmap:Bt,"nearest mipmap nearest":Ct,"linear mipmap nearest":zt,"nearest mipmap linear":Ft,"linear mipmap linear":Bt},l),m={none:0,browser:Ht},p={uint8:gt,rgba4:Ke,rgb565:Ze,"rgb5 a1":Je},h={alpha:He,luminance:qe,"luminance alpha":Qe,rgb:Ne,rgba:Ge,rgba4:Ye,"rgb5 a1":Xe,rgb565:$e},b={};n.ext_srgb&&(h.srgb=nt,h.srgba=at),n.oes_texture_float&&(p.float32=p.float=wt),n.oes_texture_half_float&&(p.float16=p["half float"]=it),n.webgl_depth_texture&&(t(h,{depth:tt,"depth stencil":rt}),t(p,{uint16:yt,uint32:xt,"depth stencil":et})),n.webgl_compressed_texture_s3tc&&t(b,{"rgb s3tc dxt1":ot,"rgba s3tc dxt1":ft,"rgba s3tc dxt3":ut,"rgba s3tc dxt5":st}),n.webgl_compressed_texture_atc&&t(b,{"rgb atc":ct,"rgba atc explicit alpha":lt,"rgba atc interpolated alpha":dt}),n.webgl_compressed_texture_pvrtc&&t(b,{"rgb pvrtc 4bppv1":mt,"rgb pvrtc 2bppv1":pt,"rgba pvrtc 4bppv1":ht,"rgba pvrtc 2bppv1":bt}),n.webgl_compressed_texture_etc1&&(b["rgb etc1"]=vt);var v=Array.prototype.slice.call(r.getParameter(Ie));Object.keys(b).forEach(function(e){var t=b[e];v.indexOf(t)>=0&&(h[e]=t)});var g=Object.keys(h);a.textureFormats=g;var y=[];Object.keys(h).forEach(function(e){var t=h[e];y[t]=e});var x=[];Object.keys(p).forEach(function(e){var t=p[e];x[t]=e});var w=[];Object.keys(l).forEach(function(e){var t=l[e];w[t]=e});var A=[];Object.keys(d).forEach(function(e){var t=d[e];A[t]=e});var _=[];Object.keys(c).forEach(function(e){var t=c[e];_[t]=e});var k=g.reduce(function(e,t){var r=h[t];return r===qe||r===He||r===qe||r===Qe||r===tt||r===rt||n.ext_srgb&&(r===nt||r===at)?e[r]=r:r===Xe||t.indexOf("rgba")>=0?e[r]=Ge:e[r]=Ne,e},{});function S(){this.internalformat=Ge,this.format=Ge,this.type=gt,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Ht,this.width=0,this.height=0,this.channels=0}function E(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function O(e,t){if("object"==typeof t&&t){if("premultiplyAlpha"in t&&(F.type(t.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(F.type(t.flipY,"boolean","invalid texture flip"),e.flipY=t.flipY),"alignment"in t&&(F.oneOf(t.alignment,[1,2,4,8],"invalid texture unpack alignment"),e.unpackAlignment=t.alignment),"colorSpace"in t&&(F.parameter(t.colorSpace,m,"invalid colorSpace"),e.colorSpace=m[t.colorSpace]),"type"in t){var r=t.type;F(n.oes_texture_float||!("float"===r||"float32"===r),"you must enable the OES_texture_float extension in order to use floating point textures."),F(n.oes_texture_half_float||!("half float"===r||"float16"===r),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),F(n.webgl_depth_texture||!("uint16"===r||"uint32"===r||"depth stencil"===r),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),F.parameter(r,p,"invalid texture type"),e.type=p[r]}var i=e.width,o=e.height,f=e.channels,u=!1;"shape"in t?(F(Array.isArray(t.shape)&&t.shape.length>=2,"shape must be an array"),i=t.shape[0],o=t.shape[1],3===t.shape.length&&(f=t.shape[2],F(f>0&&f<=4,"invalid number of channels"),u=!0),F(i>=0&&i<=a.maxTextureSize,"invalid width"),F(o>=0&&o<=a.maxTextureSize,"invalid height")):("radius"in t&&(i=o=t.radius,F(i>=0&&i<=a.maxTextureSize,"invalid radius")),"width"in t&&(i=t.width,F(i>=0&&i<=a.maxTextureSize,"invalid width")),"height"in t&&(o=t.height,F(o>=0&&o<=a.maxTextureSize,"invalid height")),"channels"in t&&(f=t.channels,F(f>0&&f<=4,"invalid number of channels"),u=!0)),e.width=0|i,e.height=0|o,e.channels=0|f;var s=!1;if("format"in t){var c=t.format;F(n.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),F.parameter(c,h,"invalid texture format");var l=e.internalformat=h[c];e.format=k[l],c in p&&("type"in t||(e.type=p[c])),c in b&&(e.compressed=!0),s=!0}!u&&s?e.channels=Yt[e.format]:u&&!s?e.channels!==Qt[e.format]&&(e.format=e.internalformat=Qt[e.channels]):s&&u&&F(e.channels===Yt[e.format],"number of channels inconsistent with specified format")}}function T(e){r.pixelStorei(Wt,e.flipY),r.pixelStorei(Ut,e.premultiplyAlpha),r.pixelStorei(Gt,e.colorSpace),r.pixelStorei(Mt,e.unpackAlignment)}function j(){S.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function D(t,r){var n=null;if(cr(r)?n=r:r&&(F.type(r,"object","invalid pixel data type"),O(t,r),"x"in r&&(t.xOffset=0|r.x),"y"in r&&(t.yOffset=0|r.y),cr(r.data)&&(n=r.data)),F(!t.compressed||n instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),r.copy){F(!n,"can not specify copy and data field for the same texture");var i=o.viewportWidth,f=o.viewportHeight;t.width=t.width||i-t.xOffset,t.height=t.height||f-t.yOffset,t.needsCopy=!0,F(t.xOffset>=0&&t.xOffset<i&&t.yOffset>=0&&t.yOffset<f&&t.width>0&&t.width<=i&&t.height>0&&t.height<=f,"copy texture read out of bounds")}else if(n){if(e(n))t.channels=t.channels||4,t.data=n,"type"in r||t.type!==gt||(t.type=lr(n));else if(ir(n))t.channels=t.channels||4,function(e,t){var r=t.length;switch(e.type){case gt:case yt:case xt:case wt:var n=te.allocType(e.type,r);n.set(t),e.data=n;break;case it:e.data=Pe(t);break;default:F.raise("unsupported texture type, must specify a typed array")}}(t,n),t.alignment=1,t.needsFree=!0;else if(ne(n)){var u=n.data;Array.isArray(u)||t.type!==gt||(t.type=lr(u));var s,c,l,d,m,p,h=n.shape,b=n.stride;3===h.length?(l=h[2],p=b[2]):(F(2===h.length,"invalid ndarray pixel data, must be 2 or 3D"),l=1,p=1),s=h[0],c=h[1],d=b[0],m=b[1],t.alignment=1,t.width=s,t.height=c,t.channels=l,t.format=t.internalformat=Qt[l],t.needsFree=!0,function(e,t,r,n,a,i){for(var o=e.width,f=e.height,u=e.channels,s=dr(e,o*f*u),c=0,l=0;l<f;++l)for(var d=0;d<o;++d)for(var m=0;m<u;++m)s[c++]=t[r*d+n*l+a*m+i];mr(e,s)}(t,u,d,m,p,n.offset)}else if(ur(n)||sr(n)||fr(n)===Jt)ur(n)||sr(n)?t.element=n:t.element=n.canvas,t.width=t.element.width,t.height=t.element.height,t.channels=4;else if(function(e){return fr(e)===Zt}(n))t.element=n,t.width=n.width,t.height=n.height,t.channels=4;else if(function(e){return fr(e)===er}(n))t.element=n,t.width=n.naturalWidth,t.height=n.naturalHeight,t.channels=4;else if(function(e){return fr(e)===tr}(n))t.element=n,t.width=n.videoWidth,t.height=n.videoHeight,t.channels=4;else if(or(n)){var v=t.width||n[0].length,g=t.height||n.length,y=t.channels;y=Le(n[0][0])?y||n[0][0].length:y||1;for(var x=ie.shape(n),w=1,A=0;A<x.length;++A)w*=x[A];var _=dr(t,w);ie.flatten(n,x,"",_),mr(t,_),t.alignment=1,t.width=v,t.height=g,t.channels=y,t.format=t.internalformat=Qt[y],t.needsFree=!0}}else t.width=t.width||1,t.height=t.height||1,t.channels=t.channels||4;t.type===wt?F(a.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):t.type===it&&F(a.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function C(e,t,n){var a=e.element,o=e.data,f=e.internalformat,u=e.format,s=e.type,c=e.width,l=e.height;T(e),a?r.texImage2D(t,n,u,u,s,a):e.compressed?r.compressedTexImage2D(t,n,f,c,l,0,o):e.needsCopy?(i(),r.copyTexImage2D(t,n,u,e.xOffset,e.yOffset,c,l,0)):r.texImage2D(t,n,u,c,l,0,u,s,o||null)}function z(e,t,n,a,o){var f=e.element,u=e.data,s=e.internalformat,c=e.format,l=e.type,d=e.width,m=e.height;T(e),f?r.texSubImage2D(t,o,n,a,c,l,f):e.compressed?r.compressedTexSubImage2D(t,o,n,a,s,d,m,u):e.needsCopy?(i(),r.copyTexSubImage2D(t,o,n,a,e.xOffset,e.yOffset,d,m)):r.texSubImage2D(t,o,n,a,d,m,c,l,u)}var B=[];function V(){return B.pop()||new j}function P(e){e.needsFree&&te.freeType(e.data),j.call(e),B.push(e)}function L(){S.call(this),this.genMipmaps=!1,this.mipmapHint=Pt,this.mipmask=0,this.images=Array(16)}function R(e,t,r){var n=e.images[0]=V();e.mipmask=1,n.width=e.width=t,n.height=e.height=r,n.channels=e.channels=4}function I(e,t){var r=null;if(cr(t))E(r=e.images[0]=V(),e),D(r,t),e.mipmask=1;else if(O(e,t),Array.isArray(t.mipmap))for(var n=t.mipmap,a=0;a<n.length;++a)E(r=e.images[a]=V(),e),r.width>>=a,r.height>>=a,D(r,n[a]),e.mipmask|=1<<a;else E(r=e.images[0]=V(),e),D(r,t),e.mipmask=1;E(e,e.images[0]),!e.compressed||e.internalformat!==ot&&e.internalformat!==ft&&e.internalformat!==ut&&e.internalformat!==st||F(e.width%4==0&&e.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function M(e,t){for(var r=e.images,n=0;n<r.length;++n){if(!r[n])return;C(r[n],t,n)}}var W=[];function U(){var e=W.pop()||new L;S.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function G(e){for(var t=e.images,r=0;r<t.length;++r)t[r]&&P(t[r]),t[r]=null;W.push(e)}function H(){this.minFilter=jt,this.magFilter=jt,this.wrapS=St,this.wrapT=St,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Pt}function N(e,t){if("min"in t){var r=t.min;F.parameter(r,d),e.minFilter=d[r],qt.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var n=t.mag;F.parameter(n,l),e.magFilter=l[n]}var i=e.wrapS,o=e.wrapT;if("wrap"in t){var f=t.wrap;"string"==typeof f?(F.parameter(f,c),i=o=c[f]):Array.isArray(f)&&(F.parameter(f[0],c),F.parameter(f[1],c),i=c[f[0]],o=c[f[1]])}else{if("wrapS"in t){var u=t.wrapS;F.parameter(u,c),i=c[u]}if("wrapT"in t){var m=t.wrapT;F.parameter(m,c),o=c[m]}}if(e.wrapS=i,e.wrapT=o,"anisotropic"in t){var p=t.anisotropic;F("number"==typeof p&&p>=1&&p<=a.maxAnisotropic,"aniso samples must be between 1 and "),e.anisotropic=t.anisotropic}if("mipmap"in t){var h=!1;switch(typeof t.mipmap){case"string":F.parameter(t.mipmap,s,"invalid mipmap hint"),e.mipmapHint=s[t.mipmap],e.genMipmaps=!0,h=!0;break;case"boolean":h=e.genMipmaps=t.mipmap;break;case"object":F(Array.isArray(t.mipmap),"invalid mipmap type"),e.genMipmaps=!1,h=!0;break;default:F.raise("invalid mipmap type")}!h||"min"in t||(e.minFilter=Ct)}}function q(e,t){r.texParameteri(t,Tt,e.minFilter),r.texParameteri(t,Ot,e.magFilter),r.texParameteri(t,At,e.wrapS),r.texParameteri(t,_t,e.wrapT),n.ext_texture_filter_anisotropic&&r.texParameteri(t,It,e.anisotropic),e.genMipmaps&&(r.hint(Vt,e.mipmapHint),r.generateMipmap(t))}var Q=0,Y={},X=a.maxTextureUnits,$=Array(X).map(function(){return null});function K(e){S.call(this),this.mipmask=0,this.internalformat=Ge,this.id=Q++,this.refCount=1,this.target=e,this.texture=r.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new H,u.profile&&(this.stats={size:0})}function J(e){r.activeTexture(Nt),r.bindTexture(e.target,e.texture)}function Z(){var e=$[0];e?r.bindTexture(e.target,e.texture):r.bindTexture(Me,null)}function ee(e){var t=e.texture;F(t,"must not double destroy texture");var n=e.unit,a=e.target;n>=0&&(r.activeTexture(Nt+n),r.bindTexture(a,null),$[n]=null),r.deleteTexture(t),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete Y[e.id],f.textureCount--}return t(K.prototype,{bind:function(){this.bindCount+=1;var e=this.unit;if(e<0){for(var t=0;t<X;++t){var n=$[t];if(n){if(n.bindCount>0)continue;n.unit=-1}$[t]=this,e=t;break}e>=X&&F.raise("insufficient number of texture units"),u.profile&&f.maxTextureUnits<e+1&&(f.maxTextureUnits=e+1),this.unit=e,r.activeTexture(Nt+e),r.bindTexture(this.target,this.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&ee(this)}}),u.profile&&(f.getTotalTextureSize=function(){var e=0;return Object.keys(Y).forEach(function(t){e+=Y[t].stats.size}),e}),{create2D:function(e,t){var n=new K(Me);function i(e,t){var r=n.texInfo;H.call(r);var o=U();return"number"==typeof e?R(o,0|e,"number"==typeof t?0|t:0|e):e?(F.type(e,"object","invalid arguments to regl.texture"),N(r,e),I(o,e)):R(o,1,1),r.genMipmaps&&(o.mipmask=(o.width<<1)-1),n.mipmask=o.mipmask,E(n,o),F.texture2D(r,o,a),n.internalformat=o.internalformat,i.width=o.width,i.height=o.height,J(n),M(o,Me),q(r,Me),Z(),G(o),u.profile&&(n.stats.size=pr(n.internalformat,n.type,o.width,o.height,r.genMipmaps,!1)),i.format=y[n.internalformat],i.type=x[n.type],i.mag=w[r.magFilter],i.min=A[r.minFilter],i.wrapS=_[r.wrapS],i.wrapT=_[r.wrapT],i}return Y[n.id]=n,f.textureCount++,i(e,t),i.subimage=function(e,t,r,a){F(!!e,"must specify image data");var o=0|t,f=0|r,u=0|a,s=V();return E(s,n),s.width=0,s.height=0,D(s,e),s.width=s.width||(n.width>>u)-o,s.height=s.height||(n.height>>u)-f,F(n.type===s.type&&n.format===s.format&&n.internalformat===s.internalformat,"incompatible format for texture.subimage"),F(o>=0&&f>=0&&o+s.width<=n.width&&f+s.height<=n.height,"texture.subimage write out of bounds"),F(n.mipmask&1<<u,"missing mipmap data"),F(s.data||s.element||s.needsCopy,"missing image data"),J(n),z(s,Me,o,f,u),Z(),P(s),i},i.resize=function(e,t){var a=0|e,o=0|t||a;if(a===n.width&&o===n.height)return i;i.width=n.width=a,i.height=n.height=o,J(n);for(var f=0;n.mipmask>>f;++f){var s=a>>f,c=o>>f;if(!s||!c)break;r.texImage2D(Me,f,n.format,s,c,0,n.format,n.type,null)}return Z(),u.profile&&(n.stats.size=pr(n.internalformat,n.type,a,o,!1,!1)),i},i._reglType="texture2d",i._texture=n,u.profile&&(i.stats=n.stats),i.destroy=function(){n.decRef()},i},createCube:function(e,t,n,i,o,s){var c=new K(We);Y[c.id]=c,f.cubeCount++;var l=new Array(6);function d(e,t,r,n,i,o){var f,s=c.texInfo;for(H.call(s),f=0;f<6;++f)l[f]=U();if("number"!=typeof e&&e)if("object"==typeof e)if(t)I(l[0],e),I(l[1],t),I(l[2],r),I(l[3],n),I(l[4],i),I(l[5],o);else if(N(s,e),O(c,e),"faces"in e){var m=e.faces;for(F(Array.isArray(m)&&6===m.length,"cube faces must be a length 6 array"),f=0;f<6;++f)F("object"==typeof m[f]&&!!m[f],"invalid input for cube map face"),E(l[f],c),I(l[f],m[f])}else for(f=0;f<6;++f)I(l[f],e);else F.raise("invalid arguments to cube map");else{var p=0|e||1;for(f=0;f<6;++f)R(l[f],p,p)}for(E(c,l[0]),a.npotTextureCube||F(Re(c.width)&&Re(c.height),"your browser does not support non power or two texture dimensions"),s.genMipmaps?c.mipmask=(l[0].width<<1)-1:c.mipmask=l[0].mipmask,F.textureCube(c,s,l,a),c.internalformat=l[0].internalformat,d.width=l[0].width,d.height=l[0].height,J(c),f=0;f<6;++f)M(l[f],Ue+f);for(q(s,We),Z(),u.profile&&(c.stats.size=pr(c.internalformat,c.type,d.width,d.height,s.genMipmaps,!0)),d.format=y[c.internalformat],d.type=x[c.type],d.mag=w[s.magFilter],d.min=A[s.minFilter],d.wrapS=_[s.wrapS],d.wrapT=_[s.wrapT],f=0;f<6;++f)G(l[f]);return d}return d(e,t,n,i,o,s),d.subimage=function(e,t,r,n,a){F(!!t,"must specify image data"),F("number"==typeof e&&e===(0|e)&&e>=0&&e<6,"invalid face");var i=0|r,o=0|n,f=0|a,u=V();return E(u,c),u.width=0,u.height=0,D(u,t),u.width=u.width||(c.width>>f)-i,u.height=u.height||(c.height>>f)-o,F(c.type===u.type&&c.format===u.format&&c.internalformat===u.internalformat,"incompatible format for texture.subimage"),F(i>=0&&o>=0&&i+u.width<=c.width&&o+u.height<=c.height,"texture.subimage write out of bounds"),F(c.mipmask&1<<f,"missing mipmap data"),F(u.data||u.element||u.needsCopy,"missing image data"),J(c),z(u,Ue+e,i,o,f),Z(),P(u),d},d.resize=function(e){var t=0|e;if(t!==c.width){d.width=c.width=t,d.height=c.height=t,J(c);for(var n=0;n<6;++n)for(var a=0;c.mipmask>>a;++a)r.texImage2D(Ue+n,a,c.format,t>>a,t>>a,0,c.format,c.type,null);return Z(),u.profile&&(c.stats.size=pr(c.internalformat,c.type,d.width,d.height,!1,!0)),d}},d._reglType="textureCube",d._texture=c,u.profile&&(d.stats=c.stats),d.destroy=function(){c.decRef()},d},clear:function(){for(var e=0;e<X;++e)r.activeTexture(Nt+e),r.bindTexture(Me,null),$[e]=null;ae(Y).forEach(ee),f.cubeCount=0,f.textureCount=0},getTexture:function(e){return null},restore:function(){for(var e=0;e<X;++e){var t=$[e];t&&(t.bindCount=0,t.unit=-1,$[e]=null)}ae(Y).forEach(function(e){e.texture=r.createTexture(),r.bindTexture(e.target,e.texture);for(var t=0;t<32;++t)if(0!=(e.mipmask&1<<t))if(e.target===Me)r.texImage2D(Me,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);else for(var n=0;n<6;++n)r.texImage2D(Ue+n,t,e.internalformat,e.width>>t,e.height>>t,0,e.internalformat,e.type,null);q(e.texInfo,e.target)})}}}ar[Ye]=2,ar[Xe]=2,ar[$e]=2,ar[rt]=4,ar[ot]=.5,ar[ft]=.5,ar[ut]=1,ar[st]=1,ar[ct]=.5,ar[lt]=1,ar[dt]=1,ar[mt]=.5,ar[pt]=.25,ar[ht]=.5,ar[bt]=.25,ar[vt]=.5;var br=36161,vr=32854,gr=[];function yr(e,t,r){return gr[e]*t*r}gr[vr]=2,gr[32855]=2,gr[36194]=2,gr[33189]=2,gr[36168]=1,gr[34041]=4,gr[35907]=4,gr[34836]=16,gr[34842]=8,gr[34843]=6;var xr=function(e,t,r,n,a){var i={rgba4:vr,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};t.ext_srgb&&(i.srgba=35907),t.ext_color_buffer_half_float&&(i.rgba16f=34842,i.rgb16f=34843),t.webgl_color_buffer_float&&(i.rgba32f=34836);var o=[];Object.keys(i).forEach(function(e){var t=i[e];o[t]=e});var f=0,u={};function s(e){this.id=f++,this.refCount=1,this.renderbuffer=e,this.format=vr,this.width=0,this.height=0,a.profile&&(this.stats={size:0})}function c(t){var r=t.renderbuffer;F(r,"must not double destroy renderbuffer"),e.bindRenderbuffer(br,null),e.deleteRenderbuffer(r),t.renderbuffer=null,t.refCount=0,delete u[t.id],n.renderbufferCount--}return s.prototype.decRef=function(){--this.refCount<=0&&c(this)},a.profile&&(n.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach(function(t){e+=u[t].stats.size}),e}),{create:function(t,f){var c=new s(e.createRenderbuffer());function l(t,n){var f=0,u=0,s=vr;if("object"==typeof t&&t){var d=t;if("shape"in d){var m=d.shape;F(Array.isArray(m)&&m.length>=2,"invalid renderbuffer shape"),f=0|m[0],u=0|m[1]}else"radius"in d&&(f=u=0|d.radius),"width"in d&&(f=0|d.width),"height"in d&&(u=0|d.height);"format"in d&&(F.parameter(d.format,i,"invalid renderbuffer format"),s=i[d.format])}else"number"==typeof t?(f=0|t,u="number"==typeof n?0|n:f):t?F.raise("invalid arguments to renderbuffer constructor"):f=u=1;if(F(f>0&&u>0&&f<=r.maxRenderbufferSize&&u<=r.maxRenderbufferSize,"invalid renderbuffer size"),f!==c.width||u!==c.height||s!==c.format)return l.width=c.width=f,l.height=c.height=u,c.format=s,e.bindRenderbuffer(br,c.renderbuffer),e.renderbufferStorage(br,s,f,u),F(0===e.getError(),"invalid render buffer format"),a.profile&&(c.stats.size=yr(c.format,c.width,c.height)),l.format=o[c.format],l}return u[c.id]=c,n.renderbufferCount++,l(t,f),l.resize=function(t,n){var i=0|t,o=0|n||i;return i===c.width&&o===c.height?l:(F(i>0&&o>0&&i<=r.maxRenderbufferSize&&o<=r.maxRenderbufferSize,"invalid renderbuffer size"),l.width=c.width=i,l.height=c.height=o,e.bindRenderbuffer(br,c.renderbuffer),e.renderbufferStorage(br,c.format,i,o),F(0===e.getError(),"invalid render buffer format"),a.profile&&(c.stats.size=yr(c.format,c.width,c.height)),l)},l._reglType="renderbuffer",l._renderbuffer=c,a.profile&&(l.stats=c.stats),l.destroy=function(){c.decRef()},l},clear:function(){ae(u).forEach(c)},restore:function(){ae(u).forEach(function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(br,t.renderbuffer),e.renderbufferStorage(br,t.format,t.width,t.height)}),e.bindRenderbuffer(br,null)}}},wr=36160,Ar=36161,_r=3553,kr=34069,Sr=36064,Er=36096,Or=36128,Tr=33306,jr=36053,Dr=6402,Cr=[6407,6408],zr=[];zr[6408]=4,zr[6407]=3;var Fr=[];Fr[5121]=1,Fr[5126]=4,Fr[36193]=2;var Br=33189,Vr=36168,Pr=34041,Lr=[32854,32855,36194,35907,34842,34843,34836],Rr={};Rr[jr]="complete",Rr[36054]="incomplete attachment",Rr[36057]="incomplete dimensions",Rr[36055]="incomplete, missing attachment",Rr[36061]="unsupported";var Ir=5126,Mr=34962;function Wr(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Ir,this.offset=0,this.stride=0,this.divisor=0}var Ur=35632,Gr=35633,Hr=35718,Nr=35721;var qr=6408,Qr=5121,Yr=3333,Xr=5126;function $r(t,r,n,a,i,o,f){function u(u){var s;null===r.next?(F(i.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),s=Qr):(F(null!==r.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),s=r.next.colorAttachments[0].texture._texture.type,o.oes_texture_float?(F(s===Qr||s===Xr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),s===Xr&&F(f.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):F(s===Qr,"Reading from a framebuffer is only allowed for the type 'uint8'"));var c=0,l=0,d=a.framebufferWidth,m=a.framebufferHeight,p=null;e(u)?p=u:u&&(F.type(u,"object","invalid arguments to regl.read()"),c=0|u.x,l=0|u.y,F(c>=0&&c<a.framebufferWidth,"invalid x offset for regl.read"),F(l>=0&&l<a.framebufferHeight,"invalid y offset for regl.read"),d=0|(u.width||a.framebufferWidth-c),m=0|(u.height||a.framebufferHeight-l),p=u.data||null),p&&(s===Qr?F(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):s===Xr&&F(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),F(d>0&&d+c<=a.framebufferWidth,"invalid width for read pixels"),F(m>0&&m+l<=a.framebufferHeight,"invalid height for read pixels"),n();var h=d*m*4;return p||(s===Qr?p=new Uint8Array(h):s===Xr&&(p=p||new Float32Array(h))),F.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),F(p.byteLength>=h,"data buffer for regl.read() too small"),t.pixelStorei(Yr,4),t.readPixels(c,l,d,m,qr,s,p),p}return function(e){return e&&"framebuffer"in e?function(e){var t;return r.setFBO({framebuffer:e.framebuffer},function(){t=u(e)}),t}(e):u(e)}}function Kr(e){return Array.prototype.slice.call(e)}function Jr(e){return Kr(e).join("")}var Zr="xyzw".split(""),en=5121,tn=1,rn=2,nn=0,an=1,on=2,fn=3,un=4,sn="dither",cn="blend.enable",ln="blend.color",dn="blend.equation",mn="blend.func",pn="depth.enable",hn="depth.func",bn="depth.range",vn="depth.mask",gn="colorMask",yn="cull.enable",xn="cull.face",wn="frontFace",An="lineWidth",_n="polygonOffset.enable",kn="polygonOffset.offset",Sn="sample.alpha",En="sample.enable",On="sample.coverage",Tn="stencil.enable",jn="stencil.mask",Dn="stencil.func",Cn="stencil.opFront",zn="stencil.opBack",Fn="scissor.enable",Bn="scissor.box",Vn="viewport",Pn="profile",Ln="framebuffer",Rn="vert",In="frag",Mn="elements",Wn="primitive",Un="count",Gn="offset",Hn="instances",Nn="vao",qn=Ln+"Width",Qn=Ln+"Height",Yn=Vn+"Width",Xn=Vn+"Height",$n="drawingBufferWidth",Kn="drawingBufferHeight",Jn=[mn,dn,Dn,Cn,zn,On,Vn,Bn,kn],Zn=34962,ea=34963,ta=3553,ra=34067,na=2884,aa=3042,ia=3024,oa=2960,fa=2929,ua=3089,sa=32823,ca=32926,la=32928,da=5126,ma=35664,pa=35665,ha=35666,ba=5124,va=35667,ga=35668,ya=35669,xa=35670,wa=35671,Aa=35672,_a=35673,ka=35674,Sa=35675,Ea=35676,Oa=35678,Ta=35680,ja=4,Da=1028,Ca=1029,za=2304,Fa=2305,Ba=32775,Va=32776,Pa=519,La=7680,Ra=0,Ia=1,Ma=32774,Wa=513,Ua=36160,Ga=36064,Ha={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Na=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],qa={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Qa={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ya={frag:35632,vert:35633},Xa={cw:za,ccw:Fa};function $a(t){return Array.isArray(t)||e(t)||ne(t)}function Ka(e){return e.sort(function(e,t){return e===Vn?-1:t===Vn?1:e<t?-1:1})}function Ja(e,t,r,n){this.thisDep=e,this.contextDep=t,this.propDep=r,this.append=n}function Za(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function ei(e){return new Ja(!1,!1,!1,e)}function ti(e,t){var r=e.type;if(r===nn){var n=e.data.length;return new Ja(!0,n>=1,n>=2,t)}if(r===un){var a=e.data;return new Ja(a.thisDep,a.contextDep,a.propDep,t)}return new Ja(r===fn,r===on,r===an,t)}var ri=new Ja(!1,!1,!1,function(){});function ni(e,r,n,a,i,o,f,u,s,c,l,d,m,p,h){var b=c.Record,v={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(v.min=Ba,v.max=Va);var g=n.angle_instanced_arrays,y=n.webgl_draw_buffers,x={dirty:!0,profile:h.profile},w={},A=[],_={},k={};function S(e){return e.replace(".","_")}function E(e,t,r){var n=S(e);A.push(e),w[n]=x[n]=!!r,_[n]=t}function O(e,t,r){var n=S(e);A.push(e),Array.isArray(r)?(x[n]=r.slice(),w[n]=r.slice()):x[n]=w[n]=r,k[n]=t}E(sn,ia),E(cn,aa),O(ln,"blendColor",[0,0,0,0]),O(dn,"blendEquationSeparate",[Ma,Ma]),O(mn,"blendFuncSeparate",[Ia,Ra,Ia,Ra]),E(pn,fa,!0),O(hn,"depthFunc",Wa),O(bn,"depthRange",[0,1]),O(vn,"depthMask",!0),O(gn,gn,[!0,!0,!0,!0]),E(yn,na),O(xn,"cullFace",Ca),O(wn,wn,Fa),O(An,An,1),E(_n,sa),O(kn,"polygonOffset",[0,0]),E(Sn,ca),E(En,la),O(On,"sampleCoverage",[1,!1]),E(Tn,oa),O(jn,"stencilMask",-1),O(Dn,"stencilFunc",[Pa,0,-1]),O(Cn,"stencilOpSeparate",[Da,La,La,La]),O(zn,"stencilOpSeparate",[Ca,La,La,La]),E(Fn,ua),O(Bn,"scissor",[0,0,e.drawingBufferWidth,e.drawingBufferHeight]),O(Vn,Vn,[0,0,e.drawingBufferWidth,e.drawingBufferHeight]);var T={gl:e,context:m,strings:r,next:w,current:x,draw:d,elements:o,buffer:i,shader:l,attributes:c.state,vao:c,uniforms:s,framebuffer:u,extensions:n,timer:p,isBufferArgs:$a},j={primTypes:xe,compareFuncs:qa,blendFuncs:Ha,blendEquations:v,stencilOps:Qa,glTypes:ue,orientationType:Xa};F.optional(function(){T.isArrayLike=Le}),y&&(j.backBuffer=[Ca],j.drawBuffer=N(a.maxDrawbuffers,function(e){return 0===e?[0]:N(e,function(e){return Ga+e})}));var D=0;function C(){var e=function(){var e=0,r=[],n=[];function a(){var r=[],n=[];return t(function(){r.push.apply(r,Kr(arguments))},{def:function(){var t="v"+e++;return n.push(t),arguments.length>0&&(r.push(t,"="),r.push.apply(r,Kr(arguments)),r.push(";")),t},toString:function(){return Jr([n.length>0?"var "+n.join(",")+";":"",Jr(r)])}})}function i(){var e=a(),r=a(),n=e.toString,i=r.toString;function o(t,n){r(t,n,"=",e.def(t,n),";")}return t(function(){e.apply(e,Kr(arguments))},{def:e.def,entry:e,exit:r,save:o,set:function(t,r,n){o(t,r),e(t,r,"=",n,";")},toString:function(){return n()+i()}})}var o=a(),f={};return{global:o,link:function(t){for(var a=0;a<n.length;++a)if(n[a]===t)return r[a];var i="g"+e++;return r.push(i),n.push(t),i},block:a,proc:function(e,r){var n=[];function a(){var e="a"+n.length;return n.push(e),e}r=r||0;for(var o=0;o<r;++o)a();var u=i(),s=u.toString;return f[e]=t(u,{arg:a,toString:function(){return Jr(["function(",n.join(),"){",s(),"}"])}})},scope:i,cond:function(){var e=Jr(arguments),r=i(),n=i(),a=r.toString,o=n.toString;return t(r,{then:function(){return r.apply(r,Kr(arguments)),this},else:function(){return n.apply(n,Kr(arguments)),this},toString:function(){var t=o();return t&&(t="else{"+t+"}"),Jr(["if(",e,"){",a(),"}",t])}})},compile:function(){var e=['"use strict";',o,"return {"];Object.keys(f).forEach(function(t){e.push('"',t,'":',f[t].toString(),",")}),e.push("}");var t=Jr(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,n)}}}(),n=e.link,a=e.global;e.id=D++,e.batchId="0";var i=n(T),o=e.shared={props:"a0"};Object.keys(T).forEach(function(e){o[e]=a.def(i,".",e)}),F.optional(function(){e.CHECK=n(F),e.commandStr=F.guessCommand(),e.command=n(e.commandStr),e.assert=function(e,t,r){e("if(!(",t,"))",this.CHECK,".commandRaise(",n(r),",",this.command,");")},j.invalidBlendCombinations=Na});var f=e.next={},u=e.current={};Object.keys(k).forEach(function(e){Array.isArray(x[e])&&(f[e]=a.def(o.next,".",e),u[e]=a.def(o.current,".",e))});var s=e.constants={};Object.keys(j).forEach(function(e){s[e]=a.def(JSON.stringify(j[e]))}),e.invoke=function(t,r){switch(r.type){case nn:var a=["this",o.context,o.props,e.batchId];return t.def(n(r.data),".call(",a.slice(0,Math.max(r.data.length+1,4)),")");case an:return t.def(o.props,r.data);case on:return t.def(o.context,r.data);case fn:return t.def("this",r.data);case un:return r.data.append(e,t),r.data.ref}},e.attribCache={};var l={};return e.scopeAttrib=function(e){var t=r.id(e);if(t in l)return l[t];var a=c.scope[t];return a||(a=c.scope[t]=new b),l[t]=n(a)},e}function z(e,t,f,s,d){var m=e.static,p=e.dynamic;F.optional(function(){var e=[Ln,Rn,In,Mn,Wn,Gn,Un,Hn,Pn,Nn].concat(A);function t(t){Object.keys(t).forEach(function(t){F.command(e.indexOf(t)>=0,'unknown parameter "'+t+'"',d.commandStr)})}t(m),t(p)});var h=function(e,t){var r=e.static;if("string"==typeof r[In]&&"string"==typeof r[Rn]){if(Object.keys(t.dynamic).length>0)return null;var n=t.static,a=Object.keys(n);if(a.length>0&&"number"==typeof n[a[0]]){for(var i=[],o=0;o<a.length;++o)F("number"==typeof n[a[o]],"must specify all vertex attribute locations when using vaos"),i.push([0|n[a[o]],a[o]]);return i}}return null}(e,t),y=function(e,t){var r=e.static,n=e.dynamic;if(Ln in r){var a=r[Ln];return a?(a=u.getFramebuffer(a),F.command(a,"invalid framebuffer object"),ei(function(e,t){var r=e.link(a),n=e.shared;t.set(n.framebuffer,".next",r);var i=n.context;return t.set(i,"."+qn,r+".width"),t.set(i,"."+Qn,r+".height"),r})):ei(function(e,t){var r=e.shared;t.set(r.framebuffer,".next","null");var n=r.context;return t.set(n,"."+qn,n+"."+$n),t.set(n,"."+Qn,n+"."+Kn),"null"})}if(Ln in n){var i=n[Ln];return ti(i,function(e,t){var r=e.invoke(t,i),n=e.shared,a=n.framebuffer,o=t.def(a,".getFramebuffer(",r,")");F.optional(function(){e.assert(t,"!"+r+"||"+o,"invalid framebuffer object")}),t.set(a,".next",o);var f=n.context;return t.set(f,"."+qn,o+"?"+o+".width:"+f+"."+$n),t.set(f,"."+Qn,o+"?"+o+".height:"+f+"."+Kn),o})}return null}(e),x=function(e,t,r){var n=e.static,a=e.dynamic;function i(e){if(e in n){var i=n[e];F.commandType(i,"object","invalid "+e,r.commandStr);var o,f,u=!0,s=0|i.x,c=0|i.y;return"width"in i?(o=0|i.width,F.command(o>=0,"invalid "+e,r.commandStr)):u=!1,"height"in i?(f=0|i.height,F.command(f>=0,"invalid "+e,r.commandStr)):u=!1,new Ja(!u&&t&&t.thisDep,!u&&t&&t.contextDep,!u&&t&&t.propDep,function(e,t){var r=e.shared.context,n=o;"width"in i||(n=t.def(r,".",qn,"-",s));var a=f;return"height"in i||(a=t.def(r,".",Qn,"-",c)),[s,c,n,a]})}if(e in a){var l=a[e],d=ti(l,function(t,r){var n=t.invoke(r,l);F.optional(function(){t.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+e)});var a=t.shared.context,i=r.def(n,".x|0"),o=r.def(n,".y|0"),f=r.def('"width" in ',n,"?",n,".width|0:","(",a,".",qn,"-",i,")"),u=r.def('"height" in ',n,"?",n,".height|0:","(",a,".",Qn,"-",o,")");return F.optional(function(){t.assert(r,f+">=0&&"+u+">=0","invalid "+e)}),[i,o,f,u]});return t&&(d.thisDep=d.thisDep||t.thisDep,d.contextDep=d.contextDep||t.contextDep,d.propDep=d.propDep||t.propDep),d}return t?new Ja(t.thisDep,t.contextDep,t.propDep,function(e,t){var r=e.shared.context;return[0,0,t.def(r,".",qn),t.def(r,".",Qn)]}):null}var o=i(Vn);if(o){var f=o;o=new Ja(o.thisDep,o.contextDep,o.propDep,function(e,t){var r=f.append(e,t),n=e.shared.context;return t.set(n,"."+Yn,r[2]),t.set(n,"."+Xn,r[3]),r})}return{viewport:o,scissor_box:i(Bn)}}(e,y,d),w=function(e,t){var r=e.static,n=e.dynamic,a=function(){if(Mn in r){var e=r[Mn];$a(e)?e=o.getElements(o.create(e,!0)):e&&(e=o.getElements(e),F.command(e,"invalid elements",t.commandStr));var a=ei(function(t,r){if(e){var n=t.link(e);return t.ELEMENTS=n,n}return t.ELEMENTS=null,null});return a.value=e,a}if(Mn in n){var i=n[Mn];return ti(i,function(e,t){var r=e.shared,n=r.isBufferArgs,a=r.elements,o=e.invoke(t,i),f=t.def("null"),u=t.def(n,"(",o,")"),s=e.cond(u).then(f,"=",a,".createStream(",o,");").else(f,"=",a,".getElements(",o,");");return F.optional(function(){e.assert(s.else,"!"+o+"||"+f,"invalid elements")}),t.entry(s),t.exit(e.cond(u).then(a,".destroyStream(",f,");")),e.ELEMENTS=f,f})}return null}();function i(e,i){if(e in r){var o=0|r[e];return F.command(!i||o>=0,"invalid "+e,t.commandStr),ei(function(e,t){return i&&(e.OFFSET=o),o})}if(e in n){var f=n[e];return ti(f,function(t,r){var n=t.invoke(r,f);return i&&(t.OFFSET=n,F.optional(function(){t.assert(r,n+">=0","invalid "+e)})),n})}return i&&a?ei(function(e,t){return e.OFFSET="0",0}):null}var f=i(Gn,!0);return{elements:a,primitive:function(){if(Wn in r){var e=r[Wn];return F.commandParameter(e,xe,"invalid primitve",t.commandStr),ei(function(t,r){return xe[e]})}if(Wn in n){var i=n[Wn];return ti(i,function(e,t){var r=e.constants.primTypes,n=e.invoke(t,i);return F.optional(function(){e.assert(t,n+" in "+r,"invalid primitive, must be one of "+Object.keys(xe))}),t.def(r,"[",n,"]")})}return a?Za(a)?a.value?ei(function(e,t){return t.def(e.ELEMENTS,".primType")}):ei(function(){return ja}):new Ja(a.thisDep,a.contextDep,a.propDep,function(e,t){var r=e.ELEMENTS;return t.def(r,"?",r,".primType:",ja)}):null}(),count:function(){if(Un in r){var e=0|r[Un];return F.command("number"==typeof e&&e>=0,"invalid vertex count",t.commandStr),ei(function(){return e})}if(Un in n){var i=n[Un];return ti(i,function(e,t){var r=e.invoke(t,i);return F.optional(function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">=0&&"+r+"===("+r+"|0)","invalid vertex count")}),r})}if(a){if(Za(a)){if(a)return f?new Ja(f.thisDep,f.contextDep,f.propDep,function(e,t){var r=t.def(e.ELEMENTS,".vertCount-",e.OFFSET);return F.optional(function(){e.assert(t,r+">=0","invalid vertex offset/element buffer too small")}),r}):ei(function(e,t){return t.def(e.ELEMENTS,".vertCount")});var o=ei(function(){return-1});return F.optional(function(){o.MISSING=!0}),o}var u=new Ja(a.thisDep||f.thisDep,a.contextDep||f.contextDep,a.propDep||f.propDep,function(e,t){var r=e.ELEMENTS;return e.OFFSET?t.def(r,"?",r,".vertCount-",e.OFFSET,":-1"):t.def(r,"?",r,".vertCount:-1")});return F.optional(function(){u.DYNAMIC=!0}),u}return null}(),instances:i(Hn,!1),offset:f}}(e,d),_=function(e,t){var r=e.static,n=e.dynamic,i={};return A.forEach(function(e){var o=S(e);function f(t,a){if(e in r){var f=t(r[e]);i[o]=ei(function(){return f})}else if(e in n){var u=n[e];i[o]=ti(u,function(e,t){return a(e,t,e.invoke(t,u))})}}switch(e){case yn:case cn:case sn:case Tn:case pn:case Fn:case _n:case Sn:case En:case vn:return f(function(r){return F.commandType(r,"boolean",e,t.commandStr),r},function(t,r,n){return F.optional(function(){t.assert(r,"typeof "+n+'==="boolean"',"invalid flag "+e,t.commandStr)}),n});case hn:return f(function(r){return F.commandParameter(r,qa,"invalid "+e,t.commandStr),qa[r]},function(t,r,n){var a=t.constants.compareFuncs;return F.optional(function(){t.assert(r,n+" in "+a,"invalid "+e+", must be one of "+Object.keys(qa))}),r.def(a,"[",n,"]")});case bn:return f(function(e){return F.command(Le(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&e[0]<=e[1],"depth range is 2d array",t.commandStr),e},function(e,t,r){return F.optional(function(){e.assert(t,e.shared.isArrayLike+"("+r+")&&"+r+".length===2&&typeof "+r+'[0]==="number"&&typeof '+r+'[1]==="number"&&'+r+"[0]<="+r+"[1]","depth range must be a 2d array")}),[t.def("+",r,"[0]"),t.def("+",r,"[1]")]});case mn:return f(function(e){F.commandType(e,"object","blend.func",t.commandStr);var r="srcRGB"in e?e.srcRGB:e.src,n="srcAlpha"in e?e.srcAlpha:e.src,a="dstRGB"in e?e.dstRGB:e.dst,i="dstAlpha"in e?e.dstAlpha:e.dst;return F.commandParameter(r,Ha,o+".srcRGB",t.commandStr),F.commandParameter(n,Ha,o+".srcAlpha",t.commandStr),F.commandParameter(a,Ha,o+".dstRGB",t.commandStr),F.commandParameter(i,Ha,o+".dstAlpha",t.commandStr),F.command(-1===Na.indexOf(r+", "+a),"unallowed blending combination (srcRGB, dstRGB) = ("+r+", "+a+")",t.commandStr),[Ha[r],Ha[a],Ha[n],Ha[i]]},function(t,r,n){var a=t.constants.blendFuncs;function i(i,o){var f=r.def('"',i,o,'" in ',n,"?",n,".",i,o,":",n,".",i);return F.optional(function(){t.assert(r,f+" in "+a,"invalid "+e+"."+i+o+", must be one of "+Object.keys(Ha))}),f}F.optional(function(){t.assert(r,n+"&&typeof "+n+'==="object"',"invalid blend func, must be an object")});var o=i("src","RGB"),f=i("dst","RGB");F.optional(function(){var e=t.constants.invalidBlendCombinations;t.assert(r,e+".indexOf("+o+'+", "+'+f+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var u=r.def(a,"[",o,"]"),s=r.def(a,"[",i("src","Alpha"),"]");return[u,r.def(a,"[",f,"]"),s,r.def(a,"[",i("dst","Alpha"),"]")]});case dn:return f(function(r){return"string"==typeof r?(F.commandParameter(r,v,"invalid "+e,t.commandStr),[v[r],v[r]]):"object"==typeof r?(F.commandParameter(r.rgb,v,e+".rgb",t.commandStr),F.commandParameter(r.alpha,v,e+".alpha",t.commandStr),[v[r.rgb],v[r.alpha]]):void F.commandRaise("invalid blend.equation",t.commandStr)},function(t,r,n){var a=t.constants.blendEquations,i=r.def(),o=r.def(),f=t.cond("typeof ",n,'==="string"');return F.optional(function(){function r(e,r,n){t.assert(e,n+" in "+a,"invalid "+r+", must be one of "+Object.keys(v))}r(f.then,e,n),t.assert(f.else,n+"&&typeof "+n+'==="object"',"invalid "+e),r(f.else,e+".rgb",n+".rgb"),r(f.else,e+".alpha",n+".alpha")}),f.then(i,"=",o,"=",a,"[",n,"];"),f.else(i,"=",a,"[",n,".rgb];",o,"=",a,"[",n,".alpha];"),r(f),[i,o]});case ln:return f(function(e){return F.command(Le(e)&&4===e.length,"blend.color must be a 4d array",t.commandStr),N(4,function(t){return+e[t]})},function(e,t,r){return F.optional(function(){e.assert(t,e.shared.isArrayLike+"("+r+")&&"+r+".length===4","blend.color must be a 4d array")}),N(4,function(e){return t.def("+",r,"[",e,"]")})});case jn:return f(function(e){return F.commandType(e,"number",o,t.commandStr),0|e},function(e,t,r){return F.optional(function(){e.assert(t,"typeof "+r+'==="number"',"invalid stencil.mask")}),t.def(r,"|0")});case Dn:return f(function(r){F.commandType(r,"object",o,t.commandStr);var n=r.cmp||"keep",a=r.ref||0,i="mask"in r?r.mask:-1;return F.commandParameter(n,qa,e+".cmp",t.commandStr),F.commandType(a,"number",e+".ref",t.commandStr),F.commandType(i,"number",e+".mask",t.commandStr),[qa[n],a,i]},function(e,t,r){var n=e.constants.compareFuncs;return F.optional(function(){function a(){e.assert(t,Array.prototype.join.call(arguments,""),"invalid stencil.func")}a(r+"&&typeof ",r,'==="object"'),a('!("cmp" in ',r,")||(",r,".cmp in ",n,")")}),[t.def('"cmp" in ',r,"?",n,"[",r,".cmp]",":",La),t.def(r,".ref|0"),t.def('"mask" in ',r,"?",r,".mask|0:-1")]});case Cn:case zn:return f(function(r){F.commandType(r,"object",o,t.commandStr);var n=r.fail||"keep",a=r.zfail||"keep",i=r.zpass||"keep";return F.commandParameter(n,Qa,e+".fail",t.commandStr),F.commandParameter(a,Qa,e+".zfail",t.commandStr),F.commandParameter(i,Qa,e+".zpass",t.commandStr),[e===zn?Ca:Da,Qa[n],Qa[a],Qa[i]]},function(t,r,n){var a=t.constants.stencilOps;function i(i){return F.optional(function(){t.assert(r,'!("'+i+'" in '+n+")||("+n+"."+i+" in "+a+")","invalid "+e+"."+i+", must be one of "+Object.keys(Qa))}),r.def('"',i,'" in ',n,"?",a,"[",n,".",i,"]:",La)}return F.optional(function(){t.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+e)}),[e===zn?Ca:Da,i("fail"),i("zfail"),i("zpass")]});case kn:return f(function(e){F.commandType(e,"object",o,t.commandStr);var r=0|e.factor,n=0|e.units;return F.commandType(r,"number",o+".factor",t.commandStr),F.commandType(n,"number",o+".units",t.commandStr),[r,n]},function(t,r,n){return F.optional(function(){t.assert(r,n+"&&typeof "+n+'==="object"',"invalid "+e)}),[r.def(n,".factor|0"),r.def(n,".units|0")]});case xn:return f(function(e){var r=0;return"front"===e?r=Da:"back"===e&&(r=Ca),F.command(!!r,o,t.commandStr),r},function(e,t,r){return F.optional(function(){e.assert(t,r+'==="front"||'+r+'==="back"',"invalid cull.face")}),t.def(r,'==="front"?',Da,":",Ca)});case An:return f(function(e){return F.command("number"==typeof e&&e>=a.lineWidthDims[0]&&e<=a.lineWidthDims[1],"invalid line width, must be a positive number between "+a.lineWidthDims[0]+" and "+a.lineWidthDims[1],t.commandStr),e},function(e,t,r){return F.optional(function(){e.assert(t,"typeof "+r+'==="number"&&'+r+">="+a.lineWidthDims[0]+"&&"+r+"<="+a.lineWidthDims[1],"invalid line width")}),r});case wn:return f(function(e){return F.commandParameter(e,Xa,o,t.commandStr),Xa[e]},function(e,t,r){return F.optional(function(){e.assert(t,r+'==="cw"||'+r+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),t.def(r+'==="cw"?'+za+":"+Fa)});case gn:return f(function(e){return F.command(Le(e)&&4===e.length,"color.mask must be length 4 array",t.commandStr),e.map(function(e){return!!e})},function(e,t,r){return F.optional(function(){e.assert(t,e.shared.isArrayLike+"("+r+")&&"+r+".length===4","invalid color.mask")}),N(4,function(e){return"!!"+r+"["+e+"]"})});case On:return f(function(e){F.command("object"==typeof e&&e,o,t.commandStr);var r="value"in e?e.value:1,n=!!e.invert;return F.command("number"==typeof r&&r>=0&&r<=1,"sample.coverage.value must be a number between 0 and 1",t.commandStr),[r,n]},function(e,t,r){return F.optional(function(){e.assert(t,r+"&&typeof "+r+'==="object"',"invalid sample.coverage")}),[t.def('"value" in ',r,"?+",r,".value:1"),t.def("!!",r,".invert")]})}}),i}(e,d),k=function(e,t,n){var a=e.static,i=e.dynamic;function o(e){if(e in a){var t=r.id(a[e]);F.optional(function(){l.shader(Ya[e],t,F.guessCommand())});var n=ei(function(){return t});return n.id=t,n}if(e in i){var o=i[e];return ti(o,function(t,r){var n=t.invoke(r,o),a=r.def(t.shared.strings,".id(",n,")");return F.optional(function(){r(t.shared.shader,".shader(",Ya[e],",",a,",",t.command,");")}),a})}return null}var f,u=o(In),s=o(Rn),c=null;return Za(u)&&Za(s)?(c=l.program(s.id,u.id,null,n),f=ei(function(e,t){return e.link(c)})):f=new Ja(u&&u.thisDep||s&&s.thisDep,u&&u.contextDep||s&&s.contextDep,u&&u.propDep||s&&s.propDep,function(e,t){var r,n=e.shared.shader;r=u?u.append(e,t):t.def(n,".",In);var a=n+".program("+(s?s.append(e,t):t.def(n,".",Rn))+","+r;return F.optional(function(){a+=","+e.command}),t.def(a+")")}),{frag:u,vert:s,progVar:f,program:c}}(e,0,h);function E(e){var t=x[e];t&&(_[e]=t)}E(Vn),E(S(Bn));var O=Object.keys(_).length>0,T={framebuffer:y,draw:w,shader:k,state:_,dirty:O,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(T.profile=function(e){var t,r=e.static,n=e.dynamic;if(Pn in r){var a=!!r[Pn];(t=ei(function(e,t){return a})).enable=a}else if(Pn in n){var i=n[Pn];t=ti(i,function(e,t){return e.invoke(t,i)})}return t}(e),T.uniforms=function(e,t){var r=e.static,n=e.dynamic,a={};return Object.keys(r).forEach(function(e){var n,i=r[e];if("number"==typeof i||"boolean"==typeof i)n=ei(function(){return i});else if("function"==typeof i){var o=i._reglType;"texture2d"===o||"textureCube"===o?n=ei(function(e){return e.link(i)}):"framebuffer"===o||"framebufferCube"===o?(F.command(i.color.length>0,'missing color attachment for framebuffer sent to uniform "'+e+'"',t.commandStr),n=ei(function(e){return e.link(i.color[0])})):F.commandRaise('invalid data for uniform "'+e+'"',t.commandStr)}else Le(i)?n=ei(function(t){return t.global.def("[",N(i.length,function(r){return F.command("number"==typeof i[r]||"boolean"==typeof i[r],"invalid uniform "+e,t.commandStr),i[r]}),"]")}):F.commandRaise('invalid or missing data for uniform "'+e+'"',t.commandStr);n.value=i,a[e]=n}),Object.keys(n).forEach(function(e){var t=n[e];a[e]=ti(t,function(e,r){return e.invoke(r,t)})}),a}(f,d),T.drawVAO=T.scopeVAO=function(e,t){var r=e.static,n=e.dynamic;if(Nn in r){var a=r[Nn];return null!==a&&null===c.getVAO(a)&&(a=c.createVAO(a)),ei(function(e){return e.link(c.getVAO(a))})}if(Nn in n){var i=n[Nn];return ti(i,function(e,t){var r=e.invoke(t,i);return t.def(e.shared.vao+".getVAO("+r+")")})}return null}(e),!T.drawVAO&&k.program&&!h&&n.angle_instanced_arrays){var j=!0,D=k.program.attributes.map(function(e){var r=t.static[e];return j=j&&!!r,r});if(j&&D.length>0){var C=c.getVAO(c.createVAO(D));T.drawVAO=new Ja(null,null,null,function(e,t){return e.link(C)}),T.useVAO=!0}}return h?T.useVAO=!0:T.attributes=function(e,t){var n=e.static,a=e.dynamic,o={};return Object.keys(n).forEach(function(e){var a=n[e],f=r.id(e),u=new b;if($a(a))u.state=tn,u.buffer=i.getBuffer(i.create(a,Zn,!1,!0)),u.type=0;else{var s=i.getBuffer(a);if(s)u.state=tn,u.buffer=s,u.type=0;else if(F.command("object"==typeof a&&a,"invalid data for attribute "+e,t.commandStr),"constant"in a){var c=a.constant;u.buffer="null",u.state=rn,"number"==typeof c?u.x=c:(F.command(Le(c)&&c.length>0&&c.length<=4,"invalid constant for attribute "+e,t.commandStr),Zr.forEach(function(e,t){t<c.length&&(u[e]=c[t])}))}else{s=$a(a.buffer)?i.getBuffer(i.create(a.buffer,Zn,!1,!0)):i.getBuffer(a.buffer),F.command(!!s,'missing buffer for attribute "'+e+'"',t.commandStr);var l=0|a.offset;F.command(l>=0,'invalid offset for attribute "'+e+'"',t.commandStr);var d=0|a.stride;F.command(d>=0&&d<256,'invalid stride for attribute "'+e+'", must be integer betweeen [0, 255]',t.commandStr);var m=0|a.size;F.command(!("size"in a)||m>0&&m<=4,'invalid size for attribute "'+e+'", must be 1,2,3,4',t.commandStr);var p=!!a.normalized,h=0;"type"in a&&(F.commandParameter(a.type,ue,"invalid type for attribute "+e,t.commandStr),h=ue[a.type]);var v=0|a.divisor;"divisor"in a&&(F.command(0===v||g,'cannot specify divisor for attribute "'+e+'", instancing not supported',t.commandStr),F.command(v>=0,'invalid divisor for attribute "'+e+'"',t.commandStr)),F.optional(function(){var r=t.commandStr,n=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(a).forEach(function(t){F.command(n.indexOf(t)>=0,'unknown parameter "'+t+'" for attribute pointer "'+e+'" (valid parameters are '+n+")",r)})}),u.buffer=s,u.state=tn,u.size=m,u.normalized=p,u.type=h||s.dtype,u.offset=l,u.stride=d,u.divisor=v}}o[e]=ei(function(e,t){var r=e.attribCache;if(f in r)return r[f];var n={isStream:!1};return Object.keys(u).forEach(function(e){n[e]=u[e]}),u.buffer&&(n.buffer=e.link(u.buffer),n.type=n.type||n.buffer+".dtype"),r[f]=n,n})}),Object.keys(a).forEach(function(e){var t=a[e];o[e]=ti(t,function(r,n){var a=r.invoke(n,t),i=r.shared,o=r.constants,f=i.isBufferArgs,u=i.buffer;F.optional(function(){r.assert(n,a+"&&(typeof "+a+'==="object"||typeof '+a+'==="function")&&('+f+"("+a+")||"+u+".getBuffer("+a+")||"+u+".getBuffer("+a+".buffer)||"+f+"("+a+'.buffer)||("constant" in '+a+"&&(typeof "+a+'.constant==="number"||'+i.isArrayLike+"("+a+".constant))))",'invalid dynamic attribute "'+e+'"')});var s={isStream:n.def(!1)},c=new b;c.state=tn,Object.keys(c).forEach(function(e){s[e]=n.def(""+c[e])});var l=s.buffer,d=s.type;function m(e){n(s[e],"=",a,".",e,"|0;")}return n("if(",f,"(",a,")){",s.isStream,"=true;",l,"=",u,".createStream(",Zn,",",a,");",d,"=",l,".dtype;","}else{",l,"=",u,".getBuffer(",a,");","if(",l,"){",d,"=",l,".dtype;",'}else if("constant" in ',a,"){",s.state,"=",rn,";","if(typeof "+a+'.constant === "number"){',s[Zr[0]],"=",a,".constant;",Zr.slice(1).map(function(e){return s[e]}).join("="),"=0;","}else{",Zr.map(function(e,t){return s[e]+"="+a+".constant.length>"+t+"?"+a+".constant["+t+"]:0;"}).join(""),"}}else{","if(",f,"(",a,".buffer)){",l,"=",u,".createStream(",Zn,",",a,".buffer);","}else{",l,"=",u,".getBuffer(",a,".buffer);","}",d,'="type" in ',a,"?",o.glTypes,"[",a,".type]:",l,".dtype;",s.normalized,"=!!",a,".normalized;"),m("size"),m("offset"),m("stride"),m("divisor"),n("}}"),n.exit("if(",s.isStream,"){",u,".destroyStream(",l,");","}"),s})}),o}(t,d),T.context=function(e){var t=e.static,r=e.dynamic,n={};return Object.keys(t).forEach(function(e){var r=t[e];n[e]=ei(function(e,t){return"number"==typeof r||"boolean"==typeof r?""+r:e.link(r)})}),Object.keys(r).forEach(function(e){var t=r[e];n[e]=ti(t,function(e,r){return e.invoke(r,t)})}),n}(s),T}function B(e,t,r){var n=e.shared.context,a=e.scope();Object.keys(r).forEach(function(i){t.save(n,"."+i);var o=r[i];a(n,".",i,"=",o.append(e,t),";")}),t(a)}function V(e,t,r,n){var a,i=e.shared,o=i.gl,f=i.framebuffer;y&&(a=t.def(i.extensions,".webgl_draw_buffers"));var u,s=e.constants,c=s.drawBuffer,l=s.backBuffer;u=r?r.append(e,t):t.def(f,".next"),n||t("if(",u,"!==",f,".cur){"),t("if(",u,"){",o,".bindFramebuffer(",Ua,",",u,".framebuffer);"),y&&t(a,".drawBuffersWEBGL(",c,"[",u,".colorAttachments.length]);"),t("}else{",o,".bindFramebuffer(",Ua,",null);"),y&&t(a,".drawBuffersWEBGL(",l,");"),t("}",f,".cur=",u,";"),n||t("}")}function P(e,t,r){var n=e.shared,a=n.gl,i=e.current,o=e.next,f=n.current,u=n.next,s=e.cond(f,".dirty");A.forEach(function(t){var n,c,l=S(t);if(!(l in r.state))if(l in o){n=o[l],c=i[l];var d=N(x[l].length,function(e){return s.def(n,"[",e,"]")});s(e.cond(d.map(function(e,t){return e+"!=="+c+"["+t+"]"}).join("||")).then(a,".",k[l],"(",d,");",d.map(function(e,t){return c+"["+t+"]="+e}).join(";"),";"))}else{n=s.def(u,".",l);var m=e.cond(n,"!==",f,".",l);s(m),l in _?m(e.cond(n).then(a,".enable(",_[l],");").else(a,".disable(",_[l],");"),f,".",l,"=",n,";"):m(a,".",k[l],"(",n,");",f,".",l,"=",n,";")}}),0===Object.keys(r.state).length&&s(f,".dirty=false;"),t(s)}function L(e,t,r,n){var a=e.shared,i=e.current,o=a.current,f=a.gl;Ka(Object.keys(r)).forEach(function(a){var u=r[a];if(!n||n(u)){var s=u.append(e,t);if(_[a]){var c=_[a];Za(u)?t(f,s?".enable(":".disable(",c,");"):t(e.cond(s).then(f,".enable(",c,");").else(f,".disable(",c,");")),t(o,".",a,"=",s,";")}else if(Le(s)){var l=i[a];t(f,".",k[a],"(",s,");",s.map(function(e,t){return l+"["+t+"]="+e}).join(";"),";")}else t(f,".",k[a],"(",s,");",o,".",a,"=",s,";")}})}function R(e,t){g&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function M(e,t,r,n,a){var i,o,f,u=e.shared,s=e.stats,c=u.current,l=u.timer,d=r.profile;function m(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function h(e){e(i=t.def(),"=",m(),";"),"string"==typeof a?e(s,".count+=",a,";"):e(s,".count++;"),p&&(n?e(o=t.def(),"=",l,".getNumPendingQueries();"):e(l,".beginQuery(",s,");"))}function b(e){e(s,".cpuTime+=",m(),"-",i,";"),p&&(n?e(l,".pushScopeStats(",o,",",l,".getNumPendingQueries(),",s,");"):e(l,".endQuery();"))}function v(e){var r=t.def(c,".profile");t(c,".profile=",e,";"),t.exit(c,".profile=",r,";")}if(d){if(Za(d))return void(d.enable?(h(t),b(t.exit),v("true")):v("false"));v(f=d.append(e,t))}else f=t.def(c,".profile");var g=e.block();h(g),t("if(",f,"){",g,"}");var y=e.block();b(y),t.exit("if(",f,"){",y,"}")}function W(e,t,r,n,a){var i=e.shared;n.forEach(function(n){var o,f=n.name,u=r.attributes[f];if(u){if(!a(u))return;o=u.append(e,t)}else{if(!a(ri))return;var s=e.scopeAttrib(f);F.optional(function(){e.assert(t,s+".state","missing attribute "+f)}),o={},Object.keys(new b).forEach(function(e){o[e]=t.def(s,".",e)})}!function(r,n,a){var o=i.gl,f=t.def(r,".location"),u=t.def(i.attributes,"[",f,"]"),s=a.state,c=a.buffer,l=[a.x,a.y,a.z,a.w],d=["buffer","normalized","offset","stride"];function m(){t("if(!",u,".buffer){",o,".enableVertexAttribArray(",f,");}");var r,i=a.type;if(r=a.size?t.def(a.size,"||",n):n,t("if(",u,".type!==",i,"||",u,".size!==",r,"||",d.map(function(e){return u+"."+e+"!=="+a[e]}).join("||"),"){",o,".bindBuffer(",Zn,",",c,".buffer);",o,".vertexAttribPointer(",[f,r,i,a.normalized,a.stride,a.offset],");",u,".type=",i,";",u,".size=",r,";",d.map(function(e){return u+"."+e+"="+a[e]+";"}).join(""),"}"),g){var s=a.divisor;t("if(",u,".divisor!==",s,"){",e.instancing,".vertexAttribDivisorANGLE(",[f,s],");",u,".divisor=",s,";}")}}function p(){t("if(",u,".buffer){",o,".disableVertexAttribArray(",f,");",u,".buffer=null;","}if(",Zr.map(function(e,t){return u+"."+e+"!=="+l[t]}).join("||"),"){",o,".vertexAttrib4f(",f,",",l,");",Zr.map(function(e,t){return u+"."+e+"="+l[t]+";"}).join(""),"}")}s===tn?m():s===rn?p():(t("if(",s,"===",tn,"){"),m(),t("}else{"),p(),t("}"))}(e.link(n),function(e){switch(e){case ma:case va:case wa:return 2;case pa:case ga:case Aa:return 3;case ha:case ya:case _a:return 4;default:return 1}}(n.info.type),o)})}function U(e,t,n,a,i){for(var o,f=e.shared,u=f.gl,s=0;s<a.length;++s){var c,l=a[s],d=l.name,m=l.info.type,p=n.uniforms[d],h=e.link(l)+".location";if(p){if(!i(p))continue;if(Za(p)){var b=p.value;if(F.command(null!=b,'missing uniform "'+d+'"',e.commandStr),m===Oa||m===Ta){F.command("function"==typeof b&&(m===Oa&&("texture2d"===b._reglType||"framebuffer"===b._reglType)||m===Ta&&("textureCube"===b._reglType||"framebufferCube"===b._reglType)),"invalid texture for uniform "+d,e.commandStr);var v=e.link(b._texture||b.color[0]._texture);t(u,".uniform1i(",h,",",v+".bind());"),t.exit(v,".unbind();")}else if(m===ka||m===Sa||m===Ea){F.optional(function(){F.command(Le(b),"invalid matrix for uniform "+d,e.commandStr),F.command(m===ka&&4===b.length||m===Sa&&9===b.length||m===Ea&&16===b.length,"invalid length for matrix uniform "+d,e.commandStr)});var g=e.global.def("new Float32Array(["+Array.prototype.slice.call(b)+"])"),y=2;m===Sa?y=3:m===Ea&&(y=4),t(u,".uniformMatrix",y,"fv(",h,",false,",g,");")}else{switch(m){case da:F.commandType(b,"number","uniform "+d,e.commandStr),o="1f";break;case ma:F.command(Le(b)&&2===b.length,"uniform "+d,e.commandStr),o="2f";break;case pa:F.command(Le(b)&&3===b.length,"uniform "+d,e.commandStr),o="3f";break;case ha:F.command(Le(b)&&4===b.length,"uniform "+d,e.commandStr),o="4f";break;case xa:F.commandType(b,"boolean","uniform "+d,e.commandStr),o="1i";break;case ba:F.commandType(b,"number","uniform "+d,e.commandStr),o="1i";break;case wa:case va:F.command(Le(b)&&2===b.length,"uniform "+d,e.commandStr),o="2i";break;case Aa:case ga:F.command(Le(b)&&3===b.length,"uniform "+d,e.commandStr),o="3i";break;case _a:case ya:F.command(Le(b)&&4===b.length,"uniform "+d,e.commandStr),o="4i"}t(u,".uniform",o,"(",h,",",Le(b)?Array.prototype.slice.call(b):b,");")}continue}c=p.append(e,t)}else{if(!i(ri))continue;c=t.def(f.uniforms,"[",r.id(d),"]")}m===Oa?t("if(",c,"&&",c,'._reglType==="framebuffer"){',c,"=",c,".color[0];","}"):m===Ta&&t("if(",c,"&&",c,'._reglType==="framebufferCube"){',c,"=",c,".color[0];","}"),F.optional(function(){function r(r,n){e.assert(t,r,'bad data or missing for uniform "'+d+'".  '+n)}function n(e){r("typeof "+c+'==="'+e+'"',"invalid type, expected "+e)}function a(t,n){r(f.isArrayLike+"("+c+")&&"+c+".length==="+t,"invalid vector, should have length "+t,e.commandStr)}function i(t){r("typeof "+c+'==="function"&&'+c+'._reglType==="texture'+(t===ta?"2d":"Cube")+'"',"invalid texture type",e.commandStr)}switch(m){case ba:n("number");break;case va:a(2);break;case ga:a(3);break;case ya:a(4);break;case da:n("number");break;case ma:a(2);break;case pa:a(3);break;case ha:a(4);break;case xa:n("boolean");break;case wa:a(2);break;case Aa:a(3);break;case _a:case ka:a(4);break;case Sa:a(9);break;case Ea:a(16);break;case Oa:i(ta);break;case Ta:i(ra)}});var x=1;switch(m){case Oa:case Ta:var w=t.def(c,"._texture");t(u,".uniform1i(",h,",",w,".bind());"),t.exit(w,".unbind();");continue;case ba:case xa:o="1i";break;case va:case wa:o="2i",x=2;break;case ga:case Aa:o="3i",x=3;break;case ya:case _a:o="4i",x=4;break;case da:o="1f";break;case ma:o="2f",x=2;break;case pa:o="3f",x=3;break;case ha:o="4f",x=4;break;case ka:o="Matrix2fv";break;case Sa:o="Matrix3fv";break;case Ea:o="Matrix4fv"}if(t(u,".uniform",o,"(",h,","),"M"===o.charAt(0)){var A=Math.pow(m-ka+2,2),_=e.global.def("new Float32Array(",A,")");t("false,(Array.isArray(",c,")||",c," instanceof Float32Array)?",c,":(",N(A,function(e){return _+"["+e+"]="+c+"["+e+"]"}),",",_,")")}else t(x>1?N(x,function(e){return c+"["+e+"]"}):c);t(");")}}function G(e,t,r,n){var a=e.shared,i=a.gl,o=a.draw,f=n.draw;var u=function(){var a,u=f.elements,s=t;return u?((u.contextDep&&n.contextDynamic||u.propDep)&&(s=r),a=u.append(e,s)):a=s.def(o,".",Mn),a&&s("if("+a+")"+i+".bindBuffer("+ea+","+a+".buffer.buffer);"),a}();function s(a){var i=f[a];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(e,r):i.append(e,t):t.def(o,".",a)}var c,l,d=s(Wn),m=s(Gn),p=function(){var a,i=f.count,u=t;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(u=r),a=i.append(e,u),F.optional(function(){i.MISSING&&e.assert(t,"false","missing vertex count"),i.DYNAMIC&&e.assert(u,a+">=0","missing vertex count")})):(a=u.def(o,".",Un),F.optional(function(){e.assert(u,a+">=0","missing vertex count")})),a}();if("number"==typeof p){if(0===p)return}else r("if(",p,"){"),r.exit("}");g&&(c=s(Hn),l=e.instancing);var h=u+".type",b=f.elements&&Za(f.elements);function v(){function e(){r(l,".drawElementsInstancedANGLE(",[d,p,h,m+"<<(("+h+"-"+en+")>>1)",c],");")}function t(){r(l,".drawArraysInstancedANGLE(",[d,m,p,c],");")}u?b?e():(r("if(",u,"){"),e(),r("}else{"),t(),r("}")):t()}function y(){function e(){r(i+".drawElements("+[d,p,h,m+"<<(("+h+"-"+en+")>>1)"]+");")}function t(){r(i+".drawArrays("+[d,m,p]+");")}u?b?e():(r("if(",u,"){"),e(),r("}else{"),t(),r("}")):t()}g&&("number"!=typeof c||c>=0)?"string"==typeof c?(r("if(",c,">0){"),v(),r("}else if(",c,"<0){"),y(),r("}")):v():y()}function H(e,t,r,n,a){var i=C(),o=i.proc("body",a);return F.optional(function(){i.commandStr=t.commandStr,i.command=i.link(t.commandStr)}),g&&(i.instancing=o.def(i.shared.extensions,".angle_instanced_arrays")),e(i,o,r,n),i.compile().body}function q(e,t,r,n){R(e,t),r.useVAO?r.drawVAO?t(e.shared.vao,".setVAO(",r.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),W(e,t,r,n.attributes,function(){return!0})),U(e,t,r,n.uniforms,function(){return!0}),G(e,t,t,r)}function Q(e,t,r,n){function a(){return!0}e.batchId="a1",R(e,t),W(e,t,r,n.attributes,a),U(e,t,r,n.uniforms,a),G(e,t,t,r)}function Y(e,t,r,n){R(e,t);var a=r.contextDep,i=t.def(),o=t.def();e.shared.props=o,e.batchId=i;var f=e.scope(),u=e.scope();function s(e){return e.contextDep&&a||e.propDep}function c(e){return!s(e)}if(t(f.entry,"for(",i,"=0;",i,"<","a1",";++",i,"){",o,"=","a0","[",i,"];",u,"}",f.exit),r.needsContext&&B(e,u,r.context),r.needsFramebuffer&&V(e,u,r.framebuffer),L(e,u,r.state,s),r.profile&&s(r.profile)&&M(e,u,r,!1,!0),n)r.useVAO?r.drawVAO?s(r.drawVAO)?u(e.shared.vao,".setVAO(",r.drawVAO.append(e,u),");"):f(e.shared.vao,".setVAO(",r.drawVAO.append(e,f),");"):f(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(f(e.shared.vao,".setVAO(null);"),W(e,f,r,n.attributes,c),W(e,u,r,n.attributes,s)),U(e,f,r,n.uniforms,c),U(e,u,r,n.uniforms,s),G(e,f,u,r);else{var l=e.global.def("{}"),d=r.shader.progVar.append(e,u),m=u.def(d,".id"),p=u.def(l,"[",m,"]");u(e.shared.gl,".useProgram(",d,".program);","if(!",p,"){",p,"=",l,"[",m,"]=",e.link(function(t){return H(Q,e,r,t,2)}),"(",d,");}",p,".call(this,a0[",i,"],",i,");")}}function X(e,t,r){var n=t.static[r];if(n&&function(e){if("object"==typeof e&&!Le(e)){for(var t=Object.keys(e),r=0;r<t.length;++r)if(I.isDynamic(e[t[r]]))return!0;return!1}}(n)){var a=e.global,i=Object.keys(n),o=!1,f=!1,u=!1,s=e.global.def("{}");i.forEach(function(t){var r=n[t];if(I.isDynamic(r)){"function"==typeof r&&(r=n[t]=I.unbox(r));var i=ti(r,null);o=o||i.thisDep,u=u||i.propDep,f=f||i.contextDep}else{switch(a(s,".",t,"="),typeof r){case"number":a(r);break;case"string":a('"',r,'"');break;case"object":Array.isArray(r)&&a("[",r.join(),"]");break;default:a(e.link(r))}a(";")}}),t.dynamic[r]=new I.DynamicVariable(un,{thisDep:o,contextDep:f,propDep:u,ref:s,append:function(e,t){i.forEach(function(r){var a=n[r];if(I.isDynamic(a)){var i=e.invoke(t,a);t(s,".",r,"=",i,";")}})}}),delete t.static[r]}}return{next:w,current:x,procs:function(){var e=C(),t=e.proc("poll"),r=e.proc("refresh"),i=e.block();t(i),r(i);var o,f=e.shared,u=f.gl,s=f.next,c=f.current;i(c,".dirty=false;"),V(e,t),V(e,r,null,!0),g&&(o=e.link(g)),n.oes_vertex_array_object&&r(e.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var l=0;l<a.maxAttributes;++l){var d=r.def(f.attributes,"[",l,"]"),m=e.cond(d,".buffer");m.then(u,".enableVertexAttribArray(",l,");",u,".bindBuffer(",Zn,",",d,".buffer.buffer);",u,".vertexAttribPointer(",l,",",d,".size,",d,".type,",d,".normalized,",d,".stride,",d,".offset);").else(u,".disableVertexAttribArray(",l,");",u,".vertexAttrib4f(",l,",",d,".x,",d,".y,",d,".z,",d,".w);",d,".buffer=null;"),r(m),g&&r(o,".vertexAttribDivisorANGLE(",l,",",d,".divisor);")}return r(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(_).forEach(function(n){var a=_[n],o=i.def(s,".",n),f=e.block();f("if(",o,"){",u,".enable(",a,")}else{",u,".disable(",a,")}",c,".",n,"=",o,";"),r(f),t("if(",o,"!==",c,".",n,"){",f,"}")}),Object.keys(k).forEach(function(n){var a,o,f=k[n],l=x[n],d=e.block();if(d(u,".",f,"("),Le(l)){var m=l.length;a=e.global.def(s,".",n),o=e.global.def(c,".",n),d(N(m,function(e){return a+"["+e+"]"}),");",N(m,function(e){return o+"["+e+"]="+a+"["+e+"];"}).join("")),t("if(",N(m,function(e){return a+"["+e+"]!=="+o+"["+e+"]"}).join("||"),"){",d,"}")}else a=i.def(s,".",n),o=i.def(c,".",n),d(a,");",c,".",n,"=",a,";"),t("if(",a,"!==",o,"){",d,"}");r(d)}),e.compile()}(),compile:function(e,t,n,a,i){var o=C();o.stats=o.link(i),Object.keys(t.static).forEach(function(e){X(o,t,e)}),Jn.forEach(function(t){X(o,e,t)});var f=z(e,t,n,a,o);return function(e,t){var r=e.proc("draw",1);R(e,r),B(e,r,t.context),V(e,r,t.framebuffer),P(e,r,t),L(e,r,t.state),M(e,r,t,!1,!0);var n=t.shader.progVar.append(e,r);if(r(e.shared.gl,".useProgram(",n,".program);"),t.shader.program)q(e,r,t,t.shader.program);else{r(e.shared.vao,".setVAO(null);");var a=e.global.def("{}"),i=r.def(n,".id"),o=r.def(a,"[",i,"]");r(e.cond(o).then(o,".call(this,a0);").else(o,"=",a,"[",i,"]=",e.link(function(r){return H(q,e,t,r,1)}),"(",n,");",o,".call(this,a0);"))}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}(o,f),function(e,t){var n=e.proc("scope",3);e.batchId="a2";var a=e.shared,i=a.current;function o(r){var i=t.shader[r];i&&n.set(a.shader,"."+r,i.append(e,n))}B(e,n,t.context),t.framebuffer&&t.framebuffer.append(e,n),Ka(Object.keys(t.state)).forEach(function(r){var i=t.state[r].append(e,n);Le(i)?i.forEach(function(t,a){n.set(e.next[r],"["+a+"]",t)}):n.set(a.next,"."+r,i)}),M(e,n,t,!0,!0),[Mn,Gn,Un,Hn,Wn].forEach(function(r){var i=t.draw[r];i&&n.set(a.draw,"."+r,""+i.append(e,n))}),Object.keys(t.uniforms).forEach(function(i){n.set(a.uniforms,"["+r.id(i)+"]",t.uniforms[i].append(e,n))}),Object.keys(t.attributes).forEach(function(r){var a=t.attributes[r].append(e,n),i=e.scopeAttrib(r);Object.keys(new b).forEach(function(e){n.set(i,"."+e,a[e])})}),t.scopeVAO&&n.set(a.vao,".targetVAO",t.scopeVAO.append(e,n)),o(Rn),o(In),Object.keys(t.state).length>0&&(n(i,".dirty=true;"),n.exit(i,".dirty=true;")),n("a1(",e.shared.context,",a0,",e.batchId,");")}(o,f),function(e,t){var r=e.proc("batch",2);e.batchId="0",R(e,r);var n=!1,a=!0;Object.keys(t.context).forEach(function(e){n=n||t.context[e].propDep}),n||(B(e,r,t.context),a=!1);var i=t.framebuffer,o=!1;function f(e){return e.contextDep&&n||e.propDep}i?(i.propDep?n=o=!0:i.contextDep&&n&&(o=!0),o||V(e,r,i)):V(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(n=!0),P(e,r,t),L(e,r,t.state,function(e){return!f(e)}),t.profile&&f(t.profile)||M(e,r,t,!1,"a1"),t.contextDep=n,t.needsContext=a,t.needsFramebuffer=o;var u=t.shader.progVar;if(u.contextDep&&n||u.propDep)Y(e,r,t,null);else{var s=u.append(e,r);if(r(e.shared.gl,".useProgram(",s,".program);"),t.shader.program)Y(e,r,t,t.shader.program);else{r(e.shared.vao,".setVAO(null);");var c=e.global.def("{}"),l=r.def(s,".id"),d=r.def(c,"[",l,"]");r(e.cond(d).then(d,".call(this,a0,a1);").else(d,"=",c,"[",l,"]=",e.link(function(r){return H(Y,e,t,r,2)}),"(",s,");",d,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}(o,f),o.compile()}}}var ai=34918,ii=34919,oi=35007,fi=function(e,t){if(!t.ext_disjoint_timer_query)return null;var r=[];function n(e){r.push(e)}var a=[];function i(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var o=[];function f(e){o.push(e)}var u=[];function s(e,t,r){var n=o.pop()||new i;n.startQueryIndex=e,n.endQueryIndex=t,n.sum=0,n.stats=r,u.push(n)}var c=[],l=[];return{beginQuery:function(e){var n=r.pop()||t.ext_disjoint_timer_query.createQueryEXT();t.ext_disjoint_timer_query.beginQueryEXT(oi,n),a.push(n),s(a.length-1,a.length,e)},endQuery:function(){t.ext_disjoint_timer_query.endQueryEXT(oi)},pushScopeStats:s,update:function(){var e,r,i=a.length;if(0!==i){l.length=Math.max(l.length,i+1),c.length=Math.max(c.length,i+1),c[0]=0,l[0]=0;var o=0;for(e=0,r=0;r<a.length;++r){var s=a[r];t.ext_disjoint_timer_query.getQueryObjectEXT(s,ii)?(o+=t.ext_disjoint_timer_query.getQueryObjectEXT(s,ai),n(s)):a[e++]=s,c[r+1]=o,l[r+1]=e}for(a.length=e,e=0,r=0;r<u.length;++r){var d=u[r],m=d.startQueryIndex,p=d.endQueryIndex;d.sum+=c[p]-c[m];var h=l[m],b=l[p];b===h?(d.stats.gpuTime+=d.sum/1e6,f(d)):(d.startQueryIndex=h,d.endQueryIndex=b,u[e++]=d)}u.length=e}},getNumPendingQueries:function(){return a.length},clear:function(){r.push.apply(r,a);for(var e=0;e<r.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(r[e]);a.length=0,r.length=0},restore:function(){a.length=0,r.length=0}}},ui=16384,si=256,ci=1024,li=34962,di="webglcontextlost",mi="webglcontextrestored",pi=1,hi=2,bi=3;function vi(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}return function(r){var n=H(r);if(!n)return null;var a=n.gl,i=a.getContextAttributes(),o=a.isContextLost(),f=function(e,t){var r={};function n(t){F.type(t,"string","extension name must be string");var n,a=t.toLowerCase();try{n=r[a]=e.getExtension(a)}catch(i){}return!!n}for(var a=0;a<t.extensions.length;++a){var i=t.extensions[a];if(!n(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach(function(e){if(r[e]&&!n(e))throw new Error("(regl): error restoring extension "+e)})}}}(a,n);if(!f)return null;var u,s,c=(u={"":0},s=[""],{id:function(e){var t=u[e];return t||(t=u[e]=s.length,s.push(e),t)},str:function(e){return s[e]}}),l={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},d=f.extensions,m=fi(a,d),p=W(),h=a.drawingBufferWidth,b=a.drawingBufferHeight,v={tick:0,time:0,viewportWidth:h,viewportHeight:b,framebufferWidth:h,framebufferHeight:b,drawingBufferWidth:h,drawingBufferHeight:b,pixelRatio:n.pixelRatio},g=re(a,d),y=function(t,r,n,a){var i=0,o={};function f(e){this.id=i++,this.buffer=t.createBuffer(),this.type=e,this.usage=de,this.byteLength=0,this.dimension=1,this.dtype=pe,this.persistentData=null,n.profile&&(this.stats={size:0})}f.prototype.bind=function(){t.bindBuffer(this.type,this.buffer)},f.prototype.destroy=function(){l(this)};var u=[];function s(e,r,n){e.byteLength=r.byteLength,t.bufferData(e.type,r,n)}function c(t,r,n,a,i,o){var f,u;if(t.usage=n,Array.isArray(r)){if(t.dtype=a||he,r.length>0)if(Array.isArray(r[0])){f=le(r);for(var c=1,l=1;l<f.length;++l)c*=f[l];t.dimension=c,s(t,u=ce(r,f,t.dtype),n),o?t.persistentData=u:te.freeType(u)}else if("number"==typeof r[0]){t.dimension=i;var d=te.allocType(t.dtype,r.length);ge(d,r),s(t,d,n),o?t.persistentData=d:te.freeType(d)}else e(r[0])?(t.dimension=r[0].length,t.dtype=a||ve(r[0])||he,s(t,u=ce(r,[r.length,r[0].length],t.dtype),n),o?t.persistentData=u:te.freeType(u)):F.raise("invalid buffer data")}else if(e(r))t.dtype=a||ve(r),t.dimension=i,s(t,r,n),o&&(t.persistentData=new Uint8Array(new Uint8Array(r.buffer)));else if(ne(r)){f=r.shape;var m=r.stride,p=r.offset,h=0,b=0,v=0,g=0;1===f.length?(h=f[0],b=1,v=m[0],g=0):2===f.length?(h=f[0],b=f[1],v=m[0],g=m[1]):F.raise("invalid shape"),t.dtype=a||ve(r.data)||he,t.dimension=b;var y=te.allocType(t.dtype,h*b);ye(y,r.data,h,b,v,g,p),s(t,y,n),o?t.persistentData=y:te.freeType(y)}else r instanceof ArrayBuffer?(t.dtype=pe,t.dimension=i,s(t,r,n),o&&(t.persistentData=new Uint8Array(new Uint8Array(r)))):F.raise("invalid buffer data")}function l(e){r.bufferCount--,a(e);var n=e.buffer;F(n,"buffer must not be deleted already"),t.deleteBuffer(n),e.buffer=null,delete o[e.id]}return n.profile&&(r.getTotalBufferSize=function(){var e=0;return Object.keys(o).forEach(function(t){e+=o[t].stats.size}),e}),{create:function(a,i,u,s){r.bufferCount++;var d=new f(i);function m(r){var a=de,i=null,o=0,f=0,u=1;return Array.isArray(r)||e(r)||ne(r)||r instanceof ArrayBuffer?i=r:"number"==typeof r?o=0|r:r&&(F.type(r,"object","buffer arguments must be an object, a number or an array"),"data"in r&&(F(null===i||Array.isArray(i)||e(i)||ne(i),"invalid data for buffer"),i=r.data),"usage"in r&&(F.parameter(r.usage,se,"invalid buffer usage"),a=se[r.usage]),"type"in r&&(F.parameter(r.type,ue,"invalid buffer type"),f=ue[r.type]),"dimension"in r&&(F.type(r.dimension,"number","invalid dimension"),u=0|r.dimension),"length"in r&&(F.nni(o,"buffer length must be a nonnegative integer"),o=0|r.length)),d.bind(),i?c(d,i,a,f,u,s):(o&&t.bufferData(d.type,o,a),d.dtype=f||pe,d.usage=a,d.dimension=u,d.byteLength=o),n.profile&&(d.stats.size=d.byteLength*be[d.dtype]),m}function p(e,r){F(r+e.byteLength<=d.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+e.byteLength+" starting from offset "+r+" to a buffer of size "+d.byteLength),t.bufferSubData(d.type,r,e)}return o[d.id]=d,u||m(a),m._reglType="buffer",m._buffer=d,m.subdata=function(t,r){var n,a=0|(r||0);if(d.bind(),e(t)||t instanceof ArrayBuffer)p(t,a);else if(Array.isArray(t)){if(t.length>0)if("number"==typeof t[0]){var i=te.allocType(d.dtype,t.length);ge(i,t),p(i,a),te.freeType(i)}else if(Array.isArray(t[0])||e(t[0])){n=le(t);var o=ce(t,n,d.dtype);p(o,a),te.freeType(o)}else F.raise("invalid buffer data")}else if(ne(t)){n=t.shape;var f=t.stride,u=0,s=0,c=0,l=0;1===n.length?(u=n[0],s=1,c=f[0],l=0):2===n.length?(u=n[0],s=n[1],c=f[0],l=f[1]):F.raise("invalid shape");var h=Array.isArray(t.data)?d.dtype:ve(t.data),b=te.allocType(h,u*s);ye(b,t.data,u,s,c,l,t.offset),p(b,a),te.freeType(b)}else F.raise("invalid data for buffer subdata");return m},n.profile&&(m.stats=d.stats),m.destroy=function(){l(d)},m},createStream:function(e,t){var r=u.pop();return r||(r=new f(e)),r.bind(),c(r,t,me,0,1,!1),r},destroyStream:function(e){u.push(e)},clear:function(){ae(o).forEach(l),u.forEach(l)},getBuffer:function(e){return e&&e._buffer instanceof f?e._buffer:null},restore:function(){ae(o).forEach(function(e){e.buffer=t.createBuffer(),t.bindBuffer(e.type,e.buffer),t.bufferData(e.type,e.persistentData||e.byteLength,e.usage)})},_initBuffer:c}}(a,l,n,function(e){return x.destroyBuffer(e)}),x=function(t,r,n,a,i){for(var o=n.maxAttributes,f=new Array(o),u=0;u<o;++u)f[u]=new Wr;var s=0,c={},l={Record:Wr,scope:{},state:f,currentVAO:null,targetVAO:null,restore:d()?function(){d()&&ae(c).forEach(function(e){e.refresh()})}:function(){},createVAO:function(t){var n=new p;function f(t){F(Array.isArray(t),"arguments to vertex array constructor must be an array"),F(t.length<o,"too many attributes"),F(t.length>0,"must specify at least one attribute");for(var a=0;a<n.buffers.length;++a)n.buffers[a].destroy();n.buffers.length=0;var u=n.attributes;u.length=t.length;for(var s=0;s<t.length;++s){var c=t[s],l=u[s]=new Wr;if(Array.isArray(c)||e(c)||ne(c)){var d=i.create(c,Mr,!1,!0);l.buffer=i.getBuffer(d),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1,n.buffers.push(d)}else i.getBuffer(c)?(l.buffer=i.getBuffer(c),l.size=0|l.buffer.dimension,l.normalized=!1,l.type=l.buffer.dtype,l.offset=0,l.stride=0,l.divisor=0,l.state=1):i.getBuffer(c.buffer)?(l.buffer=i.getBuffer(c.buffer),l.size=0|(+c.size||l.buffer.dimension),l.normalized=!!c.normalized||!1,"type"in c?(F.parameter(c.type,ue,"invalid buffer type"),l.type=ue[c.type]):l.type=l.buffer.dtype,l.offset=0|(c.offset||0),l.stride=0|(c.stride||0),l.divisor=0|(c.divisor||0),l.state=1,F(l.size>=1&&l.size<=4,"size must be between 1 and 4"),F(l.offset>=0,"invalid offset"),F(l.stride>=0&&l.stride<=255,"stride must be between 0 and 255"),F(l.divisor>=0,"divisor must be positive"),F(!l.divisor||!!r.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in c?(F(s>0,"first attribute must not be a constant"),l.x=+c.x||0,l.y=+c.y||0,l.z=+c.z||0,l.w=+c.w||0,l.state=2):F(!1,"invalid attribute spec for location "+s)}return n.refresh(),f}return a.vaoCount+=1,f.destroy=function(){n.destroy()},f._vao=n,f._reglType="vao",f(t)},getVAO:function(e){return"function"==typeof e&&e._vao?e._vao:null},destroyBuffer:function(e){for(var r=0;r<f.length;++r){var n=f[r];n.buffer===e&&(t.disableVertexAttribArray(r),n.buffer=null)}},setVAO:d()?function(e){if(e!==l.currentVAO){var t=d();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),l.currentVAO=e}}:function(e){if(e!==l.currentVAO){if(e)e.bindAttrs();else for(var r=m(),n=0;n<f.length;++n){var a=f[n];a.buffer?(t.enableVertexAttribArray(n),t.vertexAttribPointer(n,a.size,a.type,a.normalized,a.stride,a.offfset),r&&r.vertexAttribDivisorANGLE(n,a.divisor)):(t.disableVertexAttribArray(n),t.vertexAttrib4f(n,a.x,a.y,a.z,a.w))}l.currentVAO=e}},clear:d()?function(){ae(c).forEach(function(e){e.destroy()})}:function(){}};function d(){return r.oes_vertex_array_object}function m(){return r.angle_instanced_arrays}function p(){this.id=++s,this.attributes=[];var e=d();this.vao=e?e.createVertexArrayOES():null,c[this.id]=this,this.buffers=[]}return p.prototype.bindAttrs=function(){for(var e=m(),r=this.attributes,n=0;n<r.length;++n){var a=r[n];a.buffer?(t.enableVertexAttribArray(n),t.bindBuffer(Mr,a.buffer.buffer),t.vertexAttribPointer(n,a.size,a.type,a.normalized,a.stride,a.offset),e&&e.vertexAttribDivisorANGLE(n,a.divisor)):(t.disableVertexAttribArray(n),t.vertexAttrib4f(n,a.x,a.y,a.z,a.w))}for(var i=r.length;i<o;++i)t.disableVertexAttribArray(i)},p.prototype.refresh=function(){var e=d();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),l.currentVAO=this)},p.prototype.destroy=function(){if(this.vao){var e=d();this===l.currentVAO&&(l.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}c[this.id]&&(delete c[this.id],a.vaoCount-=1)},l}(a,d,g,l,y),w=function(t,r,n,a){var i={},o=0,f={uint8:Se,uint16:Oe};function u(e){this.id=o++,i[this.id]=this,this.buffer=e,this.primType=_e,this.vertCount=0,this.type=0}r.oes_element_index_uint&&(f.uint32=je),u.prototype.bind=function(){this.buffer.bind()};var s=[];function c(a,i,o,f,u,s,c){var l;if(a.buffer.bind(),i){var d=c;c||e(i)&&(!ne(i)||e(i.data))||(d=r.oes_element_index_uint?je:Oe),n._initBuffer(a.buffer,i,o,d,3)}else t.bufferData(De,s,o),a.buffer.dtype=l||Se,a.buffer.usage=o,a.buffer.dimension=3,a.buffer.byteLength=s;if(l=c,!c){switch(a.buffer.dtype){case Se:case ke:l=Se;break;case Oe:case Ee:l=Oe;break;case je:case Te:l=je;break;default:F.raise("unsupported type for element array")}a.buffer.dtype=l}a.type=l,F(l!==je||!!r.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var m=u;m<0&&(m=a.buffer.byteLength,l===Oe?m>>=1:l===je&&(m>>=2)),a.vertCount=m;var p=f;if(f<0){p=_e;var h=a.buffer.dimension;1===h&&(p=we),2===h&&(p=Ae),3===h&&(p=_e)}a.primType=p}function l(e){a.elementsCount--,F(null!==e.buffer,"must not double destroy elements"),delete i[e.id],e.buffer.destroy(),e.buffer=null}return{create:function(t,r){var i=n.create(null,De,!0),o=new u(i._buffer);function s(t){if(t)if("number"==typeof t)i(t),o.primType=_e,o.vertCount=0|t,o.type=Se;else{var r=null,n=ze,a=-1,u=-1,l=0,d=0;Array.isArray(t)||e(t)||ne(t)?r=t:(F.type(t,"object","invalid arguments for elements"),"data"in t&&(r=t.data,F(Array.isArray(r)||e(r)||ne(r),"invalid data for element buffer")),"usage"in t&&(F.parameter(t.usage,se,"invalid element buffer usage"),n=se[t.usage]),"primitive"in t&&(F.parameter(t.primitive,xe,"invalid element buffer primitive"),a=xe[t.primitive]),"count"in t&&(F("number"==typeof t.count&&t.count>=0,"invalid vertex count for elements"),u=0|t.count),"type"in t&&(F.parameter(t.type,f,"invalid buffer type"),d=f[t.type]),"length"in t?l=0|t.length:(l=u,d===Oe||d===Ee?l*=2:d!==je&&d!==Te||(l*=4))),c(o,r,n,a,u,l,d)}else i(),o.primType=_e,o.vertCount=0,o.type=Se;return s}return a.elementsCount++,s(t),s._reglType="elements",s._elements=o,s.subdata=function(e,t){return i.subdata(e,t),s},s.destroy=function(){l(o)},s},createStream:function(e){var t=s.pop();return t||(t=new u(n.create(null,De,!0,!1)._buffer)),c(t,e,Ce,-1,-1,0,0),t},destroyStream:function(e){s.push(e)},getElements:function(e){return"function"==typeof e&&e._elements instanceof u?e._elements:null},clear:function(){ae(i).forEach(l)}}}(a,d,y,l),A=function(e,t,r,n){var a={},i={};function o(e,t,r,n){this.name=e,this.id=t,this.location=r,this.info=n}function f(e,t){for(var r=0;r<e.length;++r)if(e[r].id===t.id)return void(e[r].location=t.location);e.push(t)}function u(r,n,o){var f=r===Ur?a:i,u=f[n];if(!u){var s=t.str(n);u=e.createShader(r),e.shaderSource(u,s),e.compileShader(u),F.shaderError(e,u,s,r,o),f[n]=u}return u}var s={},c=[],l=0;function d(e,t){this.id=l++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],n.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function m(r,a,i){var s,c,l=u(Ur,r.fragId),d=u(Gr,r.vertId),m=r.program=e.createProgram();if(e.attachShader(m,l),e.attachShader(m,d),i)for(s=0;s<i.length;++s){var p=i[s];e.bindAttribLocation(m,p[0],p[1])}e.linkProgram(m),F.linkError(e,m,t.str(r.fragId),t.str(r.vertId),a);var h=e.getProgramParameter(m,Hr);n.profile&&(r.stats.uniformsCount=h);var b=r.uniforms;for(s=0;s<h;++s)if(c=e.getActiveUniform(m,s))if(c.size>1)for(var v=0;v<c.size;++v){var g=c.name.replace("[0]","["+v+"]");f(b,new o(g,t.id(g),e.getUniformLocation(m,g),c))}else f(b,new o(c.name,t.id(c.name),e.getUniformLocation(m,c.name),c));var y=e.getProgramParameter(m,Nr);n.profile&&(r.stats.attributesCount=y);var x=r.attributes;for(s=0;s<y;++s)(c=e.getActiveAttrib(m,s))&&f(x,new o(c.name,t.id(c.name),e.getAttribLocation(m,c.name),c))}return n.profile&&(r.getMaxUniformsCount=function(){var e=0;return c.forEach(function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)}),e},r.getMaxAttributesCount=function(){var e=0;return c.forEach(function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)}),e}),{clear:function(){var t=e.deleteShader.bind(e);ae(a).forEach(t),a={},ae(i).forEach(t),i={},c.forEach(function(t){e.deleteProgram(t.program)}),c.length=0,s={},r.shaderCount=0},program:function(e,t,n,a){F.command(e>=0,"missing vertex shader",n),F.command(t>=0,"missing fragment shader",n);var i=s[t];i||(i=s[t]={});var o=i[e];if(o&&!a)return o;var f=new d(t,e);return r.shaderCount++,m(f,n,a),o||(i[e]=f),c.push(f),f},restore:function(){a={},i={};for(var e=0;e<c.length;++e)m(c[e],null,c[e].attributes.map(function(e){return[e.location,e.name]}))},shader:u,frag:-1,vert:-1}}(a,c,l,n),_=hr(a,d,g,function(){E.procs.poll()},v,l,n),k=xr(a,d,g,l,n),S=function(e,r,n,a,i,o){var f={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],s=["rgba4","rgb565","rgb5 a1"];r.ext_srgb&&s.push("srgba"),r.ext_color_buffer_half_float&&s.push("rgba16f","rgb16f"),r.webgl_color_buffer_float&&s.push("rgba32f");var c=["uint8"];function l(e,t,r){this.target=e,this.texture=t,this.renderbuffer=r;var n=0,a=0;t?(n=t.width,a=t.height):r&&(n=r.width,a=r.height),this.width=n,this.height=a}function d(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function m(e,t,r){if(e)if(e.texture){var n=e.texture._texture,a=Math.max(1,n.width),i=Math.max(1,n.height);F(a===t&&i===r,"inconsistent width/height for supplied texture"),n.refCount+=1}else{var o=e.renderbuffer._renderbuffer;F(o.width===t&&o.height===r,"inconsistent width/height for renderbuffer"),o.refCount+=1}}function p(t,r){r&&(r.texture?e.framebufferTexture2D(wr,t,r.target,r.texture._texture.texture,0):e.framebufferRenderbuffer(wr,t,Ar,r.renderbuffer._renderbuffer.renderbuffer))}function h(e){var t=_r,r=null,n=null,a=e;"object"==typeof e&&(a=e.data,"target"in e&&(t=0|e.target)),F.type(a,"function","invalid attachment data");var i=a._reglType;return"texture2d"===i?(r=a,F(t===_r)):"textureCube"===i?(r=a,F(t>=kr&&t<kr+6,"invalid cube map target")):"renderbuffer"===i?(n=a,t=Ar):F.raise("invalid regl object for attachment"),new l(t,r,n)}function b(e,t,r,n,o){if(r){var f=a.create2D({width:e,height:t,format:n,type:o});return f._texture.refCount=0,new l(_r,f,null)}var u=i.create({width:e,height:t,format:n});return u._renderbuffer.refCount=0,new l(Ar,null,u)}function v(e){return e&&(e.texture||e.renderbuffer)}function g(e,t,r){e&&(e.texture?e.texture.resize(t,r):e.renderbuffer&&e.renderbuffer.resize(t,r),e.width=t,e.height=r)}r.oes_texture_half_float&&c.push("half float","float16"),r.oes_texture_float&&c.push("float","float32");var y=0,x={};function w(){this.id=y++,x[this.id]=this,this.framebuffer=e.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function A(e){e.colorAttachments.forEach(d),d(e.depthAttachment),d(e.stencilAttachment),d(e.depthStencilAttachment)}function _(t){var r=t.framebuffer;F(r,"must not double destroy framebuffer"),e.deleteFramebuffer(r),t.framebuffer=null,o.framebufferCount--,delete x[t.id]}function k(t){var r;e.bindFramebuffer(wr,t.framebuffer);var a=t.colorAttachments;for(r=0;r<a.length;++r)p(Sr+r,a[r]);for(r=a.length;r<n.maxColorAttachments;++r)e.framebufferTexture2D(wr,Sr+r,_r,null,0);e.framebufferTexture2D(wr,Tr,_r,null,0),e.framebufferTexture2D(wr,Er,_r,null,0),e.framebufferTexture2D(wr,Or,_r,null,0),p(Er,t.depthAttachment),p(Or,t.stencilAttachment),p(Tr,t.depthStencilAttachment);var i=e.checkFramebufferStatus(wr);e.isContextLost()||i===jr||F.raise("framebuffer configuration not supported, status = "+Rr[i]),e.bindFramebuffer(wr,f.next?f.next.framebuffer:null),f.cur=f.next,e.getError()}function S(e,a){var i=new w;function l(e,t){var a;F(f.next!==i,"can not update framebuffer which is currently in use");var o=0,d=0,p=!0,g=!0,y=null,x=!0,w="rgba",_="uint8",S=1,E=null,O=null,T=null,j=!1;if("number"==typeof e)o=0|e,d=0|t||o;else if(e){F.type(e,"object","invalid arguments for framebuffer");var D=e;if("shape"in D){var C=D.shape;F(Array.isArray(C)&&C.length>=2,"invalid shape for framebuffer"),o=C[0],d=C[1]}else"radius"in D&&(o=d=D.radius),"width"in D&&(o=D.width),"height"in D&&(d=D.height);("color"in D||"colors"in D)&&(y=D.color||D.colors,Array.isArray(y)&&F(1===y.length||r.webgl_draw_buffers,"multiple render targets not supported")),y||("colorCount"in D&&(S=0|D.colorCount,F(S>0,"invalid color buffer count")),"colorTexture"in D&&(x=!!D.colorTexture,w="rgba4"),"colorType"in D&&(_=D.colorType,x?(F(r.oes_texture_float||!("float"===_||"float32"===_),"you must enable OES_texture_float in order to use floating point framebuffer objects"),F(r.oes_texture_half_float||!("half float"===_||"float16"===_),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===_||"float16"===_?(F(r.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):"float"!==_&&"float32"!==_||(F(r.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),F.oneOf(_,c,"invalid color type")),"colorFormat"in D&&(w=D.colorFormat,u.indexOf(w)>=0?x=!0:s.indexOf(w)>=0?x=!1:x?F.oneOf(D.colorFormat,u,"invalid color format for texture"):F.oneOf(D.colorFormat,s,"invalid color format for renderbuffer"))),("depthTexture"in D||"depthStencilTexture"in D)&&(j=!(!D.depthTexture&&!D.depthStencilTexture),F(!j||r.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in D&&("boolean"==typeof D.depth?p=D.depth:(E=D.depth,g=!1)),"stencil"in D&&("boolean"==typeof D.stencil?g=D.stencil:(O=D.stencil,p=!1)),"depthStencil"in D&&("boolean"==typeof D.depthStencil?p=g=D.depthStencil:(T=D.depthStencil,p=!1,g=!1))}else o=d=1;var z=null,B=null,V=null,P=null;if(Array.isArray(y))z=y.map(h);else if(y)z=[h(y)];else for(z=new Array(S),a=0;a<S;++a)z[a]=b(o,d,x,w,_);F(r.webgl_draw_buffers||z.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),F(z.length<=n.maxColorAttachments,"too many color attachments, not supported"),o=o||z[0].width,d=d||z[0].height,E?B=h(E):p&&!g&&(B=b(o,d,j,"depth","uint32")),O?V=h(O):g&&!p&&(V=b(o,d,!1,"stencil","uint8")),T?P=h(T):!E&&!O&&g&&p&&(P=b(o,d,j,"depth stencil","depth stencil")),F(!!E+!!O+!!T<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var L=null;for(a=0;a<z.length;++a)if(m(z[a],o,d),F(!z[a]||z[a].texture&&Cr.indexOf(z[a].texture._texture.format)>=0||z[a].renderbuffer&&Lr.indexOf(z[a].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+a+" is invalid"),z[a]&&z[a].texture){var R=zr[z[a].texture._texture.format]*Fr[z[a].texture._texture.type];null===L?L=R:F(L===R,"all color attachments much have the same number of bits per pixel.")}return m(B,o,d),F(!B||B.texture&&B.texture._texture.format===Dr||B.renderbuffer&&B.renderbuffer._renderbuffer.format===Br,"invalid depth attachment for framebuffer object"),m(V,o,d),F(!V||V.renderbuffer&&V.renderbuffer._renderbuffer.format===Vr,"invalid stencil attachment for framebuffer object"),m(P,o,d),F(!P||P.texture&&P.texture._texture.format===Pr||P.renderbuffer&&P.renderbuffer._renderbuffer.format===Pr,"invalid depth-stencil attachment for framebuffer object"),A(i),i.width=o,i.height=d,i.colorAttachments=z,i.depthAttachment=B,i.stencilAttachment=V,i.depthStencilAttachment=P,l.color=z.map(v),l.depth=v(B),l.stencil=v(V),l.depthStencil=v(P),l.width=i.width,l.height=i.height,k(i),l}return o.framebufferCount++,l(e,a),t(l,{resize:function(e,t){F(f.next!==i,"can not resize a framebuffer which is currently in use");var r=Math.max(0|e,1),n=Math.max(0|t||r,1);if(r===i.width&&n===i.height)return l;for(var a=i.colorAttachments,o=0;o<a.length;++o)g(a[o],r,n);return g(i.depthAttachment,r,n),g(i.stencilAttachment,r,n),g(i.depthStencilAttachment,r,n),i.width=l.width=r,i.height=l.height=n,k(i),l},_reglType:"framebuffer",_framebuffer:i,destroy:function(){_(i),A(i)},use:function(e){f.setFBO({framebuffer:l},e)}})}return t(f,{getFramebuffer:function(e){if("function"==typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof w)return t}return null},create:S,createCube:function(e){var i=Array(6);function o(e){var n;F(i.indexOf(f.next)<0,"can not update framebuffer which is currently in use");var s,l={color:null},d=0,m=null,p="rgba",h="uint8",b=1;if("number"==typeof e)d=0|e;else if(e){F.type(e,"object","invalid arguments for framebuffer");var v=e;if("shape"in v){var g=v.shape;F(Array.isArray(g)&&g.length>=2,"invalid shape for framebuffer"),F(g[0]===g[1],"cube framebuffer must be square"),d=g[0]}else"radius"in v&&(d=0|v.radius),"width"in v?(d=0|v.width,"height"in v&&F(v.height===d,"must be square")):"height"in v&&(d=0|v.height);("color"in v||"colors"in v)&&(m=v.color||v.colors,Array.isArray(m)&&F(1===m.length||r.webgl_draw_buffers,"multiple render targets not supported")),m||("colorCount"in v&&(b=0|v.colorCount,F(b>0,"invalid color buffer count")),"colorType"in v&&(F.oneOf(v.colorType,c,"invalid color type"),h=v.colorType),"colorFormat"in v&&(p=v.colorFormat,F.oneOf(v.colorFormat,u,"invalid color format for texture"))),"depth"in v&&(l.depth=v.depth),"stencil"in v&&(l.stencil=v.stencil),"depthStencil"in v&&(l.depthStencil=v.depthStencil)}else d=1;if(m)if(Array.isArray(m))for(s=[],n=0;n<m.length;++n)s[n]=m[n];else s=[m];else{s=Array(b);var y={radius:d,format:p,type:h};for(n=0;n<b;++n)s[n]=a.createCube(y)}for(l.color=Array(s.length),n=0;n<s.length;++n){var x=s[n];F("function"==typeof x&&"textureCube"===x._reglType,"invalid cube map"),d=d||x.width,F(x.width===d&&x.height===d,"invalid cube map shape"),l.color[n]={target:kr,data:s[n]}}for(n=0;n<6;++n){for(var w=0;w<s.length;++w)l.color[w].target=kr+n;n>0&&(l.depth=i[0].depth,l.stencil=i[0].stencil,l.depthStencil=i[0].depthStencil),i[n]?i[n](l):i[n]=S(l)}return t(o,{width:d,height:d,color:s})}return o(e),t(o,{faces:i,resize:function(e){var t,r=0|e;if(F(r>0&&r<=n.maxCubeMapSize,"invalid radius for cube fbo"),r===o.width)return o;var a=o.color;for(t=0;t<a.length;++t)a[t].resize(r);for(t=0;t<6;++t)i[t].resize(r);return o.width=o.height=r,o},_reglType:"framebufferCube",destroy:function(){i.forEach(function(e){e.destroy()})}})},clear:function(){ae(x).forEach(_)},restore:function(){f.cur=null,f.next=null,f.dirty=!0,ae(x).forEach(function(t){t.framebuffer=e.createFramebuffer(),k(t)})}})}(a,d,g,_,k,l),E=ni(a,c,d,g,y,w,0,S,{},x,A,{elements:null,primitive:4,count:-1,offset:0,instances:-1},v,m,n),O=$r(a,S,E.procs.poll,v,i,d,g),T=E.next,j=a.canvas,D=[],C=[],z=[],B=[n.onDestroy],V=null;function P(){if(0===D.length)return m&&m.update(),void(V=null);V=M.next(P),$();for(var e=D.length-1;e>=0;--e){var t=D[e];t&&t(v,null,0)}a.flush(),m&&m.update()}function L(){!V&&D.length>0&&(V=M.next(P))}function R(){V&&(M.cancel(P),V=null)}function U(e){e.preventDefault(),o=!0,R(),C.forEach(function(e){e()})}function G(e){a.getError(),o=!1,f.restore(),A.restore(),y.restore(),_.restore(),k.restore(),S.restore(),x.restore(),m&&m.restore(),E.procs.refresh(),L(),z.forEach(function(e){e()})}function N(e){function r(e){var t={},r={};return Object.keys(e).forEach(function(n){var a=e[n];I.isDynamic(a)?r[n]=I.unbox(a,n):t[n]=a}),{dynamic:r,static:t}}F(!!e,"invalid args to regl({...})"),F.type(e,"object","invalid args to regl({...})");var n=r(e.context||{}),a=r(e.uniforms||{}),i=r(e.attributes||{}),f=r(function(e){var r=t({},e);function n(e){if(e in r){var t=r[e];delete r[e],Object.keys(t).forEach(function(n){r[e+"."+n]=t[n]})}}return delete r.uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),n("blend"),n("depth"),n("cull"),n("stencil"),n("polygonOffset"),n("scissor"),n("sample"),"vao"in e&&(r.vao=e.vao),r}(e)),u={gpuTime:0,cpuTime:0,count:0},s=E.compile(f,i,a,n,u),c=s.draw,l=s.batch,d=s.scope,m=[];return t(function(e,t){var r;if(o&&F.raise("context lost"),"function"==typeof e)return d.call(this,null,e,0);if("function"==typeof t)if("number"==typeof e)for(r=0;r<e;++r)d.call(this,null,t,r);else{if(!Array.isArray(e))return d.call(this,e,t,0);for(r=0;r<e.length;++r)d.call(this,e[r],t,r)}else if("number"==typeof e){if(e>0)return l.call(this,function(e){for(;m.length<e;)m.push(null);return m}(0|e),0|e)}else{if(!Array.isArray(e))return c.call(this,e);if(e.length)return l.call(this,e,e.length)}},{stats:u})}j&&(j.addEventListener(di,U,!1),j.addEventListener(mi,G,!1));var q=S.setFBO=N({framebuffer:I.define.call(null,pi,"framebuffer")});function Q(e,t){var r=0;E.procs.poll();var n=t.color;n&&(a.clearColor(+n[0]||0,+n[1]||0,+n[2]||0,+n[3]||0),r|=ui),"depth"in t&&(a.clearDepth(+t.depth),r|=si),"stencil"in t&&(a.clearStencil(0|t.stencil),r|=ci),F(!!r,"called regl.clear with no buffer specified"),a.clear(r)}function Y(e){return F.type(e,"function","regl.frame() callback must be a function"),D.push(e),L(),{cancel:function(){var t=vi(D,e);F(t>=0,"cannot cancel a frame twice"),D[t]=function e(){var t=vi(D,e);D[t]=D[D.length-1],D.length-=1,D.length<=0&&R()}}}}function X(){var e=T.viewport,t=T.scissor_box;e[0]=e[1]=t[0]=t[1]=0,v.viewportWidth=v.framebufferWidth=v.drawingBufferWidth=e[2]=t[2]=a.drawingBufferWidth,v.viewportHeight=v.framebufferHeight=v.drawingBufferHeight=e[3]=t[3]=a.drawingBufferHeight}function $(){v.tick+=1,v.time=J(),X(),E.procs.poll()}function K(){X(),E.procs.refresh(),m&&m.update()}function J(){return(W()-p)/1e3}K();var Z=t(N,{clear:function(e){if(F("object"==typeof e&&e,"regl.clear() takes an object as input"),"framebuffer"in e)if(e.framebuffer&&"framebufferCube"===e.framebuffer_reglType)for(var r=0;r<6;++r)q(t({framebuffer:e.framebuffer.faces[r]},e),Q);else q(e,Q);else Q(0,e)},prop:I.define.bind(null,pi),context:I.define.bind(null,hi),this:I.define.bind(null,bi),draw:N({}),buffer:function(e){return y.create(e,li,!1,!1)},elements:function(e){return w.create(e,!1)},texture:_.create2D,cube:_.createCube,renderbuffer:k.create,framebuffer:S.create,framebufferCube:S.createCube,vao:x.createVAO,attributes:i,frame:Y,on:function(e,t){var r;switch(F.type(t,"function","listener callback must be a function"),e){case"frame":return Y(t);case"lost":r=C;break;case"restore":r=z;break;case"destroy":r=B;break;default:F.raise("invalid event, must be one of frame,lost,restore,destroy")}return r.push(t),{cancel:function(){for(var e=0;e<r.length;++e)if(r[e]===t)return r[e]=r[r.length-1],void r.pop()}}},limits:g,hasExtension:function(e){return g.extensions.indexOf(e.toLowerCase())>=0},read:O,destroy:function(){D.length=0,R(),j&&(j.removeEventListener(di,U),j.removeEventListener(mi,G)),A.clear(),S.clear(),k.clear(),_.clear(),w.clear(),y.clear(),x.clear(),m&&m.clear(),B.forEach(function(e){e()})},_gl:a,_refresh:K,poll:function(){$(),m&&m.update()},now:J,stats:l});return n.onDone(null,Z),Z}});
},{}],"RhqW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AssetUrl=void 0,exports.AssetUrl="/";
},{}],"O23c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.numComponentsForAccessorType=exports.glEnumLookup=exports.arrayConstructorForComponentType=void 0,exports.arrayConstructorForComponentType={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},exports.glEnumLookup={9729:"linear",9986:"nearest mipmap linear",10497:"repeat"},exports.numComponentsForAccessorType={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};
},{}],"uqCz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getTypedDataView=void 0;var e=require("./gltf-constants");function t(t,r,o){var s=r.accessors[o],n=r.bufferViews[s.bufferView];return new e.arrayConstructorForComponentType[s.componentType](t,(s.byteOffset||0)+(n.byteOffset||0),s.count*e.numComponentsForAccessorType[s.type])}exports.getTypedDataView=t;
},{"./gltf-constants":"O23c"}],"UldJ":[function(require,module,exports) {
"use strict";function e(e,r){return Array.from({length:Math.ceil(e.length/r)},function(t,n){return e.slice(n*r,n*r+r)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.chunkArray=void 0,exports.chunkArray=e;
},{}],"cWTH":[function(require,module,exports) {
"use strict";function t(t,r,a){return Math.sqrt(Math.pow(t,2)+Math.pow(r,2)+Math.pow(a,2))}function r(t,r,a){return Math.atan2(r,t-a)}function a(t,r,a,n,o){t[0]+=r*a,t[1]+=r*n,t[2]+=r*o}function n(n,o){for(var h=o.length,e=n.length,M=new Array(h),u=0;u<h;++u)M[u]=[0,0,0];for(u=0;u<e;++u){var f=n[u],i=o[f[0]],p=o[f[1]],w=o[f[2]],s=i[0]-p[0],c=i[1]-p[1],v=i[2]-p[2],l=t(s,c,v),q=p[0]-w[0],g=p[1]-w[1],m=p[2]-w[2],d=t(q,g,m),x=t(w[0]-i[0],w[1]-i[1],w[2]-i[2]);if(!(Math.min(l,d,x)<1e-6)){var y=.5*(l+d+x),A=Math.sqrt((y-l)*(y-d)*(y-x)/y),b=c*m-v*g,j=v*q-s*m,k=s*g-c*q,z=t(b,j,k);b/=z,j/=z,k/=z,a(M[f[0]],r(y,A,d),b,j,k),a(M[f[1]],r(y,A,x),b,j,k),a(M[f[2]],r(y,A,l),b,j,k)}}for(u=0;u<h;++u){var B=M[u],C=Math.sqrt(Math.pow(B[0],2)+Math.pow(B[1],2)+Math.pow(B[2],2));C<1e-8?(B[0]=1,B[1]=0,B[2]=0):(B[0]/=C,B[1]/=C,B[2]/=C)}return M}module.exports=n;
},{}],"zkhT":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)},t=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(s,i){function o(e){try{u(n.next(e))}catch(t){i(t)}}function a(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?s(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}u((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var r,n,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(s=2&i[0]?n.return:i[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,i[1])).done)return s;switch(n=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(a){i=[6,a],n=0}finally{r=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderFactory=exports.loadImage=void 0;var n=require("./gltf-utils"),s=require("./gltf-constants"),i=require("gl-matrix"),o=require("./utils"),a=require("./constants"),u=require("angle-normals");function f(e){return t(this,void 0,Promise,function(){return r(this,function(t){return[2,new Promise(function(t){var r=new Image;r.src=a.AssetUrl+"/"+e,r.crossOrigin="anonymous",r.onload=function(){return t(r)}})]})})}function c(e,n,i,o){return t(this,void 0,Promise,function(){function a(n,a){return void 0===a&&(a=void 0),t(this,void 0,void 0,function(){var t,a,u,c,l,b,d,m,y,p;return r(this,function(r){switch(r.label){case 0:return t=e.textures[n],a=e.images[t.source].uri,[4,f(o+"/"+a)];case 1:return u=r.sent(),c=e.samplers||[],l=c[t.sampler],b=s.glEnumLookup[null==l?void 0:l.magFilter]||"nearest",d=s.glEnumLookup[null==l?void 0:l.minFilter]||"nearest",m=s.glEnumLookup[null==l?void 0:l.wrapS]||"repeat",y=s.glEnumLookup[null==l?void 0:l.wrapT]||"repeat",p="nearest mipmap linear"===d,[2,i.texture({data:u,mag:b,min:d,wrapS:m,wrapT:y,mipmap:p})]}})})}var u,c,l,b,d,m,y,p,h,v,w,g,T,x,O,F;return r(this,function(e){switch(e.label){case 0:return u={},c=n.pbrMetallicRoughness,l=c.baseColorFactor,b=c.baseColorTexture,d=c.metallicFactor,m=c.roughnessFactor,y=c.metallicRoughnessTexture,p=n.normalTexture,h=n.occlusionTexture,v=n.emissiveTexture,w=n.emissiveFactor,u.baseColorFactor=l||[1,1,1,1],u.metallicFactor=void 0===d?1:d,u.roughnessFactor=void 0===m?1:m,u.emissiveFactor=w||[0,0,0],b?(g=u,[4,a(b.index,"srgb")]):[3,2];case 1:g.baseColorTexture=e.sent(),e.label=2;case 2:return y?(T=u,[4,a(y.index)]):[3,4];case 3:T.metallicRoughnessTexture=e.sent(),e.label=4;case 4:return p?(x=u,[4,a(p.index)]):[3,6];case 5:x.normalTexture=e.sent(),e.label=6;case 6:return h?(O=u,[4,a(h.index)]):[3,8];case 7:O.occlusionTexture=e.sent(),e.label=8;case 8:return v?(F=u,[4,a(v.index)]):[3,10];case 9:F.emissiveTexture=e.sent(),e.label=10;case 10:return[2,u]}})})}function l(a,u,f){return function(l,b,d){var m=this;return a.meshes[b].primitives.map(function(b){return t(m,void 0,void 0,function(){var t,m,y,p,h,v,w,g,T,x,O,F,V,A,S,_,k,L,E;return r(this,function(r){switch(r.label){case 0:return t=b.attributes.NORMAL,m=b.attributes.POSITION,y=b.indices,p=n.getTypedDataView(u,a,y),h=a.accessors[m],v=a.bufferViews[h.bufferView],w=a.accessors[t],g=a.bufferViews[w.bufferView],T={position:{buffer:l.buffer(new Float32Array(u,v.byteOffset,v.byteLength/4)),offset:h.byteOffset,stride:v.byteStride},normal:{buffer:l.buffer(new Float32Array(u,v.byteOffset,v.byteLength/4)),offset:w.byteOffset,stride:g.byteStride}},void 0!==b.attributes.TANGENT&&(x=b.attributes.TANGENT,O=a.accessors[x],F=a.bufferViews[O.bufferView],T.aTangent={buffer:l.buffer(new Float32Array(u,F.byteOffset,F.byteLength/4)),offset:O.byteOffset,stride:F.byteStride}),void 0!==b.attributes.TEXCOORD_0&&(V=b.attributes.TEXCOORD_0,A=a.accessors[V],S=a.bufferViews[A.bufferView],T.uv={buffer:l.buffer(new Float32Array(u,S.byteOffset,S.byteLength/4)),offset:A.byteOffset,stride:S.byteStride}),_=b.material,k=a.materials[_],L={sceneTransform:function(e,t){return t.localTransform},modelTransform:function(e,t){return t.modelTransform}},void 0!==d&&(L=e(e({},L),function(e){var t=a.skins[e],r=a.skins[e].joints.length,f=t.inverseBindMatrices,c=o.chunkArray(n.getTypedDataView(u,a,f),s.numComponentsForAccessorType.MAT4);function l(e){return function(r,n){var s=i.mat4.create();return i.mat4.multiply(s,n.globalJointTransforms[t.joints[e]],c[e]),s}}for(var b={},d=0;d<r;d++)b["jointMatrix["+d+"]"]=l(d);return b}(d)),T=e(e({},T),function(e,t){var r=t.attributes.JOINTS_0,n=a.accessors[r],s=a.bufferViews[n.bufferView],i=t.attributes.WEIGHTS_0,o=a.accessors[i],f=a.bufferViews[o.bufferView];return{joint:{buffer:e.buffer(new Uint16Array(u,s.byteOffset,s.byteLength/2)),offset:n.byteOffset,stride:s.byteStride||0},weight:{buffer:e.buffer(new Float32Array(u,f.byteOffset,f.byteLength/4)),offset:o.byteOffset,stride:f.byteStride||0}}}(l,b))),E=[e({},L)],[4,c(a,k,l,f)];case 1:return L=e.apply(void 0,E.concat([r.sent()])),[2,{attributes:T,uniforms:L,elements:p}]}})})})}}exports.loadImage=f,exports.RenderFactory=l;
},{"./gltf-utils":"uqCz","./gltf-constants":"O23c","gl-matrix":"IF0X","./utils":"UldJ","./constants":"RhqW","angle-normals":"cWTH"}],"Uea7":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},t=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(a,o){function i(e){try{s(n.next(e))}catch(t){o(t)}}function u(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,u)}s((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var r,n,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(u){o=[6,u],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildRenderer=exports.loadMeshPrimitives=exports.buildNodeTransforms=void 0;var n=require("gl-matrix"),a=require("./render-factory"),o=require("./gltf-utils"),i=require("./utils"),u=require("./gltf-constants");function s(e){return e.matrix?e.matrix:n.mat4.fromRotationTranslationScale(n.mat4.create(),e.rotation||n.quat.create(),e.translation||n.vec3.create(),e.scale||n.vec3.fromValues(1,1,1))}function c(t,r,a){var o;void 0===a&&(a=n.mat4.create());var i=t[r],u=s(i),l=n.mat4.multiply(n.mat4.create(),a,u),f={};return(i.children||[]).forEach(function(r){f=e(e({},f),c(t,r,l))}),e(((o={})[r]=l,o),f)}function l(e,t){return void 0===e.animations||0===e.animations.length?[]:e.animations.map(function(r,n){return{name:r.name||"animation_"+n,channels:r.channels.map(function(n){var a=r.samplers[n.sampler],s=a.interpolation,c=Array.from(o.getTypedDataView(t,e,a.input)),l=i.chunkArray(o.getTypedDataView(t,e,a.output),u.numComponentsForAccessorType[e.accessors[a.output].type]);return{targetNode:n.target.node,targetPath:n.target.path,keyframes:c,keyframeValues:l,interpolation:s}})}})}function f(e,n,o,i){return t(this,void 0,Promise,function(){var u,s=this;return r(this,function(c){switch(c.label){case 0:return u=a.RenderFactory(n,o,i),[4,n.nodes.reduce(function(n,a,o){return t(s,void 0,void 0,function(){var t;return r(this,function(r){switch(r.label){case 0:return void 0===a.mesh?[2,n]:[4,Promise.all(u(e,a.mesh,a.skin))];case 1:return t=r.sent(),[4,n];case 2:return r.sent()[o]=t,[2,n]}})})},{})];case 1:return[2,c.sent()]}})})}function p(t,r,n,a,o){void 0===a&&(a=null),void 0===o&&(o={});var i=Object.keys(r).reduce(function(i,u){return i[u]=r[u].flatMap(function(r){var i=r.attributes,u=r.elements,s=e(e({},r.uniforms),o);return t({vert:n.vertBuilder(i,s,0),frag:n.fragBuilder(i,s),attributes:i,uniforms:s,elements:u,framebuffer:a})}),i},{});return function(t,r,n){void 0===n&&(n={}),Object.entries(i).forEach(function(a){var o=a[0];a[1].forEach(function(a){return a(e({modelTransform:t,localTransform:r[o],globalJointTransforms:r},n))})})}}exports.buildNodeTransforms=c,exports.loadMeshPrimitives=f,exports.buildRenderer=p;
},{"gl-matrix":"IF0X","./render-factory":"zkhT","./gltf-utils":"uqCz","./utils":"UldJ","./gltf-constants":"O23c"}],"dlDu":[function(require,module,exports) {
"use strict";function e(e,n,o){return void 0===o&&(o=0),"\n    precision mediump float;\n    \n    uniform mat4 projection, view, modelTransform;\n    "+(n.sceneTransform?"uniform mat4 sceneTransform;":"")+"\n    "+(o>0?"uniform mat4 jointMatrix["+o+"]":"")+"\n\n    attribute vec3 position;\n    attribute vec3 normal;\n    "+(e.uv?"attribute vec2 uv;":"")+"\n    "+(e.aTangent?"attribute vec4 aTangent;":"")+"\n    "+(e.joint?"attribute vec4 joint;":"")+"\n    "+(e.weight?"attribute vec4 weight;":"")+"\n\n    varying vec3 vWorldPos;\n    varying vec3 vNormal;\n    varying mat3 v_TBN;\n    "+(e.uv?"varying vec2 vuv;":"")+"\n\n    uniform mat4 depthProjection, depthView;\n    varying vec3 vPosDepthSpace; //TODO: will need w component when dealing with point light shadows.\n\n    void main() {\n      "+(o>0?"\n      mat4 skinMatrix = weight.x * jointMatrix[int(joint.x)] +\n                        weight.y * jointMatrix[int(joint.y)] +\n                        weight.z * jointMatrix[int(joint.z)] +\n                        weight.w * jointMatrix[int(joint.w)];\n      ":"")+"\n\n      mat4 localTransform = "+(o>0?"skinMatrix;":"sceneTransform;")+"\n      mat4 model = modelTransform * localTransform;\n\n      \n      "+(e.aTangent?"\n      vec3 T = normalize(vec3(model * aTangent));\n      vec3 N = normalize(vec3(model * vec4(normal, 0.0)));\n      vec3 B = normalize(cross(N, T));\n      v_TBN = mat3(T,B,N);\n      ":"")+"\n      \n      "+(e.uv?"vuv = uv;":"")+"\n      vNormal = mat3(model) * normal;\n      vec4 pos = model * vec4(position, 1.0);\n      vWorldPos = vec3(pos.xyz) / pos.w;\n      vPosDepthSpace = (depthProjection * depthView * pos).xyz;\n      gl_Position = projection * view * pos;\n    }\n  "}function n(e,n){return"\n\n    precision mediump float;\n    #extension GL_OES_standard_derivatives : enable\n\n    const float pi = 3.141592653;\n    const float GAMMA = 2.2;\n    const float INV_GAMMA = 1.0 / GAMMA;\n\n    uniform vec3 eye;\n    uniform vec3 lightDirection;\n    uniform vec4 baseColorFactor;\n    uniform float metallicFactor;\n    uniform float roughnessFactor;\n    uniform vec3 emissiveFactor;\n\n    varying vec2 vuv;\n    varying vec3 vNormal;\n    varying vec3 vWorldPos;\n    varying mat3 v_TBN;\n\n\n    "+(n.baseColorTexture?"uniform sampler2D baseColorTexture;":"")+"\n    "+(n.metallicRoughnessTexture?"uniform sampler2D metallicRoughnessTexture;":"")+"\n    "+(n.normalTexture?"uniform sampler2D normalTexture;":"")+"\n    "+(n.occlusionTexture?"uniform sampler2D occlusionTexture;":"")+"\n    "+(n.emissiveTexture?"uniform sampler2D emissiveTexture;":"")+"\n\n    "+(n.depthSampler?"uniform sampler2D depthSampler;":"")+"\n    varying vec3 vPosDepthSpace; //TODO: will need w component when dealing with point light shadows.\n\n  \n\n    vec3 linearTosRGB(vec3 color) {\n      return pow(color, vec3(INV_GAMMA));\n    }\n    \n    vec3 sRGBToLinear(vec3 srgbIn) {\n      return vec3(pow(srgbIn.xyz, vec3(GAMMA)));\n    }\n\n    vec4 sRGBToLinear(vec4 srgbIn) {\n      return vec4(sRGBToLinear(srgbIn.xyz), srgbIn.w);\n    }\n\n    vec3 getNormal() {\n      "+(e.aTangent&&n.normalTexture?"\n        vec3 N = texture2D(normalTexture, vuv).rgb;\n        N = v_TBN * normalize(N * 2.0 - 1.0);\n      ":"\n        vec3 N = normalize(vNormal);\n        // vec3 N = normalize(cross(dFdx(vWorldPos), dFdy(vWorldPos)));\n      ")+"\n      return N;\n    }\n\n    float getMetallic() {\n      "+(n.metallicRoughnessTexture?"float metallic = texture2D(metallicRoughnessTexture, vuv).b * metallicFactor;":"float metallic = metallicFactor;")+"\n      return metallic;\n    }\n\n    float getRoughness() {\n      "+(n.metallicRoughnessTexture?"float roughness = texture2D(metallicRoughnessTexture, vuv).g * roughnessFactor;":"float roughness = roughnessFactor;")+"\n      return roughness;\n    }\n\n    vec4 getBaseColor() {\n      "+(n.baseColorTexture?"vec4 baseColor = baseColorFactor;\n           baseColor *= sRGBToLinear(texture2D(baseColorTexture, vuv));":"vec4 baseColor = baseColorFactor;")+"\n      return baseColor;\n    }\n\n\n\n    "+exports.BRDFReflectanceSource+"\n    "+(n.depthSampler?exports.shadowMapSamplerSource:"")+"\n\n    void main() {\n      vec4 baseColor = getBaseColor();\n      float metallic = getMetallic();\n      float roughness = getRoughness();\n\n      vec3 ambient = vec3(.05) * baseColor.rgb;\n      vec3 radiance = vec3(5.0); // assumed lightColor\n      \n      vec3 dialectricSpecular = vec3(.04);\n      vec3 black = vec3(0.0);\n      \n      vec3 Cdiff = mix(baseColor.rgb * (1.0 - dialectricSpecular.r), black, metallic);\n      vec3 F0 = mix(dialectricSpecular, baseColor.rgb, metallic);\n      float alpha = roughness * roughness;\n      \n      vec3 N = getNormal();\n      vec3 V = normalize(eye - vWorldPos);\n      vec3 L = normalize(-lightDirection);\n      vec3 H = normalize(L + V);\n      \n      vec3 Lo = SchlickReflectance(N, V, L, H, radiance, Cdiff, roughness);\n      \n      "+(n.depthSampler?"float shadow = inShadow(vPosDepthSpace, N, L);":"float shadow = 1.0;")+"\n      vec3 color = ambient + (shadow * Lo);\n\n      // gamma correction\n      color = linearTosRGB(color);\n\n      gl_FragColor = vec4(color, 1.0);\n    }\n  "}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildPBRFrag=exports.buildPBRVert=exports.shadowMapSamplerSource=exports.BRDFReflectanceSource=void 0,exports.BRDFReflectanceSource="\nfloat FresnelSchlick(float VdotH) {\n  return pow(1.0 - VdotH, 5.0);\n}\n\nfloat MicrofacetDistribution(float NdotH, float a) {\n  float a2     = a*a;\n  float NdotH2 = NdotH*NdotH;\n  float num   = a2;\n  float denom = (NdotH2 * (a2 - 1.0) + 1.0);\n  denom = pi * denom * denom;\n  return num / max(denom, .00001);\n}\n\nfloat GeometrySchlickGGX(float NdotV, float roughness) {\n  float r = (roughness + 1.0);\n  float k = (r*r) / 8.0;\n\n  float nom   = NdotV;\n  float denom = NdotV * (1.0 - k) + k;\n\n  return nom / denom;\n}\n\nfloat GeometrySmith(vec3 N, vec3 V, vec3 L, float roughness) {\n  float NdotV = max(dot(N, V), 0.0);\n  float NdotL = max(dot(N, L), 0.0);\n  float ggx2 = GeometrySchlickGGX(NdotV, roughness);\n  float ggx1 = GeometrySchlickGGX(NdotL, roughness);\n  return ggx1 * ggx2;\n}\n\nvec3 SchlickReflectance(vec3 N, vec3 V, vec3 L, vec3 H, vec3 radiance, vec3 Cdiff, float roughness) {\n  float VdotH = clamp(dot(V, H), 0.0, 1.0);\n  float NdotL = clamp(dot(N, L), 0.0, 1.0);\n  float NdotV = clamp(dot(N, V), 0.0, 1.0);\n  float NdotH = clamp(dot(N, H), 0.0, 1.0);\n  float alpha = roughness * roughness;\n\n  float G = GeometrySmith(N, V, L, roughness);\n  float D = MicrofacetDistribution(NdotH, alpha);\n  float F = FresnelSchlick(VdotH);\n\n  float fspecular = F * G * D / max(4.0 * NdotL * NdotV, .0001);\n  vec3 diffuse = Cdiff / pi;\n  vec3 fdiffuse = (1.0 - F) * diffuse;\n  vec3 Lo = (fdiffuse + fspecular) * radiance * NdotL;\n  return Lo;\n}\n\n",exports.shadowMapSamplerSource="\nfloat inShadow(vec3 fragPosDepthSpace, vec3 normal, vec3 lightDir) {\n  vec3 sampleCoords = fragPosDepthSpace * 0.5 + 0.5;\n  float closest = texture2D(depthSampler, sampleCoords.xy).z;\n\n  if (closest == 1.0) {\n    return 1.0;\n  }\n\n  float current = fragPosDepthSpace.z;\n  float bias = max(0.05 * (1.0 - dot(normal, lightDir)), 0.005);  \n  return closest < current - bias ? 0.0 : 1.0;\n}\n",exports.buildPBRVert=e,exports.buildPBRFrag=n;
},{}],"FhO4":[function(require,module,exports) {
"use strict";function e(){return"\n    precision mediump float;\n    \n    uniform mat4 depthProjection, depthView, modelTransform;\n    uniform mat4 sceneTransform;\n    attribute vec3 position;\n    varying highp float vDepth;\n\n    void main() {\n      mat4 model = modelTransform * sceneTransform;\n      vec4 pos = depthProjection * depthView * model * vec4(position, 1.0);\n      gl_Position = pos;\n      vDepth = pos.z;\n    }\n  "}function n(){return"\n    precision mediump float;\n    uniform sampler2D depthMap;\n    varying float vDepth;\n    void main() {\n      gl_FragColor = vec4(vec3(vDepth), 1.0);\n    }\n  "}Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildDepthBufferFrag=exports.buildDepthBufferVert=void 0,exports.buildDepthBufferVert=e,exports.buildDepthBufferFrag=n;
},{}],"ByzH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildDrawOcean=void 0;var e=require("./pbr-shaders"),n=require("gl-matrix"),a={translation:[0,0,0],rotaton:[90,0,0],scale:[1,1,1]};function o(e,n,a,o,t){e=e||1,n=n||e,a=a||1,o=o||a;for(var r=!(!t||!t.quads)&&t.quads,i=!(!t||!t.uvs)&&t.uvs,s=[],v=[],l=[],c=[],m=0;m<=o;m++)for(var p=0;p<=a;p++){var d=p/a,f=m/o,u=-e/2+d*e,w=n/2-f*n;s.push(u,w,0),i&&v.push(d,1-f),l.push(0,0,1),m<o&&p<a&&(r?c.push(m*(a+1)+p,(m+1)*(a+1)+p,(m+1)*(a+1)+p+1,m*(a+1)+p+1):(c.push(m*(a+1)+p,(m+1)*(a+1)+p+1,m*(a+1)+p+1),c.push((m+1)*(a+1)+p+1,m*(a+1)+p,(m+1)*(a+1)+p)))}return{positions:s,normals:l,uvs:v,cells:c}}function t(t){var r=o(100,100,1e3,1e3,null);return t({vert:"\n      precision mediump float;\n      uniform float time;\n      uniform mat4 projection, view, model;\n      uniform mat4 depthProjection, depthView;\n      attribute vec3 position, normal;\n      varying vec3 vWorldPos, vNormal;\n      varying vec3 vPosDepthSpace; //TODO: will need w component when dealing with point light shadows.\n  \n      float random (in vec2 st) {\n        return fract(sin(dot(st.xy,\n                             vec2(12.9898,78.233)))\n                     * 43758.5453123);\n      }\n\n    \n      struct WaveParams {\n        float A; // amplitude\n        float L; // length\n        float S; // speed\n        vec2 D; // direction\n      };\n\n\n      float computeWaveHeight(vec3 pos, float time, WaveParams wave) {\n        // amplitude:\n        float A = wave.A;\n        \n        // wavelength and frequency:\n        float L = wave.L;\n        float f = 2.0 / L;\n\n        // speed:\n        float Phi = wave.S * f;\n\n        // direction:\n        vec2 D = wave.D;\n\n        float sinvalue = sin(dot(normalize(D), pos.xy) * f + (time * Phi));\n        float waveHeight = A * sinvalue;\n\n        return waveHeight;\n      }\n\n      vec3 gerstnerWave(vec3 pos, float time, WaveParams wave) {\n        float f = 2.0 / wave.L;\n        float Q = .75 / f * wave.A; // steepness\n\n        float cosTerm = cos(dot(normalize(wave.D), pos.xy) * f + (time * wave.S * f));\n\n        float x = Q * wave.A * wave.D.x * cosTerm;\n        float y = Q * wave.A * wave.D.y * cosTerm;\n        float z = -computeWaveHeight(pos, time, wave);\n\n        return vec3(x, y, z);\n      }\n\n  \n      void main () {\n        WaveParams w1 = WaveParams(.78, 8.31, 4.0, vec2(1.0, 0.0));\n        WaveParams w2 = WaveParams(.68, 6.40, 3.53, vec2(.7, .121));\n        WaveParams w3 = WaveParams(0.435, 10.75, 1.82, vec2(1.243, .83));\n        WaveParams w4 = WaveParams(0.005, .54, 2.9, vec2(.13, 1.0283));\n        WaveParams w5 = WaveParams(0.134, 2.75, 3.4, vec2(.82, .233));\n\n        vec3 wave =  gerstnerWave(position, time, w1)\n                + gerstnerWave(position, time, w2)\n                + gerstnerWave(position, time, w3)\n                + gerstnerWave(position, time, w4)\n                + gerstnerWave(position, time, w5);\n\n        wave.x += position.x;\n        wave.y += position.y;\n\n\n        wave.z += random(position.xy) / 80.0;\n        vec4 pos = model * vec4(wave, 1.0);\n\n        vWorldPos = pos.xyz / pos.w; \n        vPosDepthSpace = (depthProjection * depthView * pos).xyz;\n        vNormal = normal;\n        gl_PointSize = 3.0;\n        gl_Position = projection * view * pos;\n      }\n    ",frag:"\n      precision mediump float;\n      #extension GL_OES_standard_derivatives : enable\n  \n      uniform vec3 lightDirection, eye;\n      uniform sampler2D depthSampler;\n  \n      varying vec3 vPosDepthSpace; //TODO: will need w component when dealing with point light shadows.\n      varying vec3 vWorldPos, vNormal;\n      const float pi = 3.141592653;\n  \n      "+e.BRDFReflectanceSource+"\n      "+e.shadowMapSamplerSource+"\n  \n      void main () {\n  \n        vec4 oceanBaseColor = vec4(0.0, 0.4, 1.0, 1.0);\n        vec3 Cdiff = oceanBaseColor.rgb * .96;\n        vec3 radiance = vec3(1.0);\n        float roughness = 0.2;\n        vec3 N = normalize(cross(dFdx(vWorldPos), dFdy(vWorldPos)));\n        vec3 V = normalize(eye - vWorldPos);\n        vec3 L = normalize(-lightDirection);\n        vec3 H = normalize(L + V);\n  \n        vec3 Lo = SchlickReflectance(N, V, L, H, radiance, Cdiff, roughness);\n        vec3 ambient = vec3(.5) * oceanBaseColor.xyz;\n  \n        float shadow = inShadow(vPosDepthSpace, N, L);\n        vec3 color = ambient + (shadow * Lo);\n  \n        gl_FragColor = vec4(color, 1.0);\n      }\n    ",attributes:{position:r.positions,normal:r.normals},uniforms:{time:function(e,n){return n.time},depthSampler:function(e,n){return n.depthSampler},model:n.mat4.fromRotationTranslationScale(n.mat4.create(),n.quat.fromEuler(n.quat.create(),a.rotaton[0],a.rotaton[1],a.rotaton[2]),a.translation,a.scale)},elements:r.cells})}exports.buildDrawOcean=t;
},{"./pbr-shaders":"dlDu","gl-matrix":"IF0X"}],"ttbc":[function(require,module,exports) {
function o(o,r,v,a,i,s){void 0===o&&(o=1),void 0===r&&(r=o),void 0===v&&(v=o),void 0===a&&(a=1),void 0===i&&(i=a),void 0===s&&(s=a);var d=0,n=[],u=[],f=[],t=[];function e(o,r,v,a,i,s,e,l,p,c){for(var h=d,m=0;m<=e;m++)for(var b=0;b<=s;b++){var x=n[d]=[0,0,0];x[o]=(-a/2+b*a/s)*p,x[r]=(-i/2+m*i/e)*c,x[v]=l;var M=u[d]=[0,0,0];M[o]=0,M[r]=0,M[v]=l/Math.abs(l);var g=f[d]=[0,0];g[0]=b/s,g[1]=1-m/e,++d}for(m=0;m<e;m++)for(b=0;b<s;b++){var j=h+m*(s+1)+b;t.push([j,j+s+1,j+s+2]),t.push([j,j+s+2,j+1])}}return e(0,1,2,o,r,a,i,v/2,1,-1),e(0,1,2,o,r,a,i,-v/2,-1,-1),e(2,1,0,v,r,s,i,-o/2,1,-1),e(2,1,0,v,r,s,i,o/2,-1,-1),e(0,2,1,o,v,a,s,r/2,1,1),e(0,2,1,o,v,a,s,-r/2,1,-1),{positions:n,normals:u,uvs:f,cells:t}}module.exports=o;
},{}],"KnRb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.buildDrawDepthCamera=void 0;var t=require("gl-matrix"),e=require("primitive-cube"),i=e();function r(e,r,o){return e({vert:"\n      precision mediump float;\n      uniform mat4 projection, view, translation, scale, targetTo;\n      attribute vec3 position;\n      void main() {\n        gl_Position = projection * view * translation * targetTo * scale * vec4(position, 1.0);\n      }\n    ",frag:"\n      precision mediump float;\n      void main() {\n        gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n      }\n    ",attributes:{position:i.positions},uniforms:{translation:t.mat4.fromTranslation([],r),scale:t.mat4.fromScaling([],[2*o,2*o,2*o]),targetTo:t.mat4.targetTo([],r,[0,0,0],[0,1,0])},elements:i.cells,primitive:"lines"})}exports.buildDrawDepthCamera=r;
},{"gl-matrix":"IF0X","primitive-cube":"ttbc"}],"ckfj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.computeRotationFromWaveNormal=exports.computeWaveHeightAndNormal=void 0;var e=require("gl-matrix");function t(t,o,r){var i=r.amplitude,n=2/r.length,a=r.speed*n,d=r.direction;return i*-Math.sin(e.vec2.dot(d,t)*n+o*a)}function o(o,r,i){var n=2/i.length,a=.75/n*i.amplitude,d=Math.cos(e.vec2.dot(e.vec2.normalize([],i.direction),o)*n+r*i.speed*n);return[a*i.amplitude*i.direction[0]*d,-t(o,r,i),a*i.amplitude*i.direction[1]*d]}function r(t,r){var i=[0,0,0];[{amplitude:.78,length:8.31,speed:4,direction:[1,0]},{amplitude:.68,length:6.4,speed:3.53,direction:[.7,.121]},{amplitude:.435,length:10.75,speed:1.82,direction:[1.243,.83]},{amplitude:.134,length:2.75,speed:3.4,direction:[.82,.233]},{amplitude:.005,length:.54,speed:2.9,direction:[.13,1.0283]}].forEach(function(n){e.vec3.add(i,i,o(t,r,n))});var n=i[1],a=i;return a[0]/=5,a[2]/=5,a[1]=1,e.vec3.normalize(a,a),{height:n,normal:a}}function i(t,o){var r=e.vec3.cross([],t,[0,1,0]),i=e.vec3.dot(t,[0,1,0]);return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=Math.sqrt(Math.pow(e.vec3.len(t),2)*Math.pow(e.vec3.len([0,1,0]),2))+i,e.quat.normalize(o,o),o}exports.computeWaveHeightAndNormal=r,exports.computeRotationFromWaveNormal=i;
},{"gl-matrix":"IF0X"}],"fsw8":[function(require,module,exports) {
function s(s,u,r,o,p){s=s||1,u=u||s,r=r||1,o=o||r;for(var a=!(!p||!p.quads)&&p.quads,h=[],n=[],e=[],l=[],t=0;t<=o;t++)for(var v=0;v<=r;v++){var d=v/r,f=t/o,i=-s/2+d*s,c=u/2-f*u;h.push([i,c,0]),n.push([d,1-f]),e.push([0,0,1]),t<o&&v<r&&(a?l.push([t*(r+1)+v,(t+1)*(r+1)+v,(t+1)*(r+1)+v+1,t*(r+1)+v+1]):(l.push([t*(r+1)+v,(t+1)*(r+1)+v+1,t*(r+1)+v+1]),l.push([(t+1)*(r+1)+v+1,t*(r+1)+v,(t+1)*(r+1)+v])))}return{positions:h,normals:e,uvs:n,cells:l}}module.exports=s;
},{}],"n1fs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.calcRippleTransformMatrix=exports.createRipple=exports.updateRipple=exports.buildDrawRipple=void 0;var a=require("gl-matrix"),r=require("./wave"),e=require("primitive-plane"),t=e();function n(a,r){return a({vert:"\n      precision mediump float;\n      uniform mat4 projection, view, model;\n      attribute vec3 position;\n      attribute vec2 uv;\n      varying vec2 vUv;\n\n      void main() {\n        vUv = uv;\n        gl_Position = projection * view * model * vec4(position, 1.0);\n      }\n    \n    ",frag:"\n      precision mediump float;\n      uniform sampler2D imageSampler;\n      uniform float alpha;\n      varying vec2 vUv;\n\n      void main(){\n        vec4 color = texture2D(imageSampler, vUv);\n        if (color.a < .5) {\n          discard;\n        }\n        color.a = alpha;\n        gl_FragColor = color;\n      }\n    ",uniforms:{imageSampler:a.texture(r),model:function(a,r){return r.transform},alpha:function(a,r){return r.alpha}},attributes:{position:t.positions,uv:t.uvs},blend:{enable:!0,func:{srcRGB:"src alpha",srcAlpha:1,dstRGB:"one minus src alpha",dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},elements:t.cells})}function o(e,t,n){e.age+=t;var o=e.age/e.lifetime,i=a.vec2.lerp([],[1,0],[0,0],o)[0],l=a.vec3.lerp([],[1,1,1],e.endScale,o);e.alpha=i,e.transform.scale=l,o>1.1&&(e.age=0,e.alpha=1,e.transform.scale=[1,1,1]);var p=[e.transform.translation[0],e.transform.translation[2]],s=r.computeWaveHeightAndNormal(p,n);return e.transform.translation[1]=s.height,e.waveRotation=r.computeRotationFromWaveNormal(s.normal,e.waveRotation),e}function i(){return{lifetime:2*Math.random()+2,age:0,endScale:[5,5,10],alpha:1,transform:{translation:[0,3,0],rotation:[90,0,0],scale:[1,1,1]},waveRotation:[0,0,0,0]}}function l(r){return a.mat4.fromRotationTranslationScale(a.mat4.create(),a.quat.multiply([],r.waveRotation,a.quat.fromEuler(a.quat.create(),r.transform.rotation[0],r.transform.rotation[1],r.transform.rotation[2])),r.transform.translation,r.transform.scale)}exports.buildDrawRipple=n,exports.updateRipple=o,exports.createRipple=i,exports.calcRippleTransformMatrix=l;
},{"gl-matrix":"IF0X","./wave":"ckfj","primitive-plane":"fsw8"}],"LVNY":[function(require,module,exports) {
"use strict";function t(t){if("object"==typeof t){if("buttons"in t)return t.buttons;if("which"in t){if(2===(e=t.which))return 4;if(3===e)return 2;if(e>0)return 1<<e-1}else if("button"in t){var e;if(1===(e=t.button))return 4;if(2===e)return 2;if(e>=0)return 1<<e}}return 0}function e(t){return t.target||t.srcElement||window}function n(t){if("object"==typeof t){if("offsetX"in t)return t.offsetX;var n=e(t).getBoundingClientRect();return t.clientX-n.left}return 0}function r(t){if("object"==typeof t){if("offsetY"in t)return t.offsetY;var n=e(t).getBoundingClientRect();return t.clientY-n.top}return 0}exports.buttons=t,exports.element=e,exports.x=n,exports.y=r;
},{}],"X2JV":[function(require,module,exports) {
"use strict";module.exports=t;var e=require("mouse-event");function t(t,n){n||(n=t,t=window);var r=0,o=0,i=0,s={shift:!1,alt:!1,control:!1,meta:!1},u=!1;function v(e){var t=!1;return"altKey"in e&&(t=t||e.altKey!==s.alt,s.alt=!!e.altKey),"shiftKey"in e&&(t=t||e.shiftKey!==s.shift,s.shift=!!e.shiftKey),"ctrlKey"in e&&(t=t||e.ctrlKey!==s.control,s.control=!!e.ctrlKey),"metaKey"in e&&(t=t||e.metaKey!==s.meta,s.meta=!!e.metaKey),t}function d(t,u){var d=e.x(u),m=e.y(u);"buttons"in u&&(t=0|u.buttons),(t!==r||d!==o||m!==i||v(u))&&(r=0|t,o=d||0,i=m||0,n&&n(r,o,i,s))}function m(e){d(0,e)}function a(){(r||o||i||s.shift||s.alt||s.meta||s.control)&&(o=i=0,r=0,s.shift=s.alt=s.control=s.meta=!1,n&&n(0,0,0,s))}function l(e){v(e)&&n&&n(r,o,i,s)}function E(t){0===e.buttons(t)?d(0,t):d(r,t)}function L(t){d(r|e.buttons(t),t)}function w(t){d(r&~e.buttons(t),t)}function c(){u||(u=!0,t.addEventListener("mousemove",E),t.addEventListener("mousedown",L),t.addEventListener("mouseup",w),t.addEventListener("mouseleave",m),t.addEventListener("mouseenter",m),t.addEventListener("mouseout",m),t.addEventListener("mouseover",m),t.addEventListener("blur",a),t.addEventListener("keyup",l),t.addEventListener("keydown",l),t.addEventListener("keypress",l),t!==window&&(window.addEventListener("blur",a),window.addEventListener("keyup",l),window.addEventListener("keydown",l),window.addEventListener("keypress",l)))}c();var y={element:t};return Object.defineProperties(y,{enabled:{get:function(){return u},set:function(e){e?c():u&&(u=!1,t.removeEventListener("mousemove",E),t.removeEventListener("mousedown",L),t.removeEventListener("mouseup",w),t.removeEventListener("mouseleave",m),t.removeEventListener("mouseenter",m),t.removeEventListener("mouseout",m),t.removeEventListener("mouseover",m),t.removeEventListener("blur",a),t.removeEventListener("keyup",l),t.removeEventListener("keydown",l),t.removeEventListener("keypress",l),t!==window&&(window.removeEventListener("blur",a),window.removeEventListener("keyup",l),window.removeEventListener("keydown",l),window.removeEventListener("keypress",l)))},enumerable:!0},buttons:{get:function(){return r},enumerable:!0},x:{get:function(){return o},enumerable:!0},y:{get:function(){return i},enumerable:!0},mods:{get:function(){return s},enumerable:!0}}),y}
},{"mouse-event":"LVNY"}],"aPUh":[function(require,module,exports) {
module.exports=function(r,t){t||(t=[0,""]),r=String(r);var a=parseFloat(r,10);return t[0]=a,t[1]=r.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t};
},{}],"Kcat":[function(require,module,exports) {
"use strict";var e=require("parse-unit");module.exports=i;var n=t("in",document.body);function r(n,r){var t=e(getComputedStyle(n).getPropertyValue(r));return t[0]*i(t[1],n)}function t(e,n){var t=document.createElement("div");t.style.height="128"+e,n.appendChild(t);var i=r(t,"height")/128;return n.removeChild(t),i}function i(u,a){if(!u)return null;switch(a=a||document.body,u=(u+""||"px").trim().toLowerCase(),a!==window&&a!==document||(a=document.body),u){case"%":return a.clientHeight/100;case"ch":case"ex":return t(u,a);case"em":return r(a,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return n;case"cm":return n/2.54;case"mm":return n/25.4;case"pt":return n/72;case"pc":return n/6;case"px":return 1}var c=e(u);if(!isNaN(c[0])&&c[1]){var o=i(c[1],a);return"number"==typeof o?c[0]*o:null}return null}
},{"parse-unit":"aPUh"}],"icpc":[function(require,module,exports) {
"use strict";var e=require("to-px");function t(t,n,r){"function"==typeof t&&(r=!!n,n=t,t=window);var a=e("ex",t),i=function(e){r&&e.preventDefault();var t=e.deltaX||0,i=e.deltaY||0,d=e.deltaZ||0,o=1;switch(e.deltaMode){case 1:o=a;break;case 2:o=window.innerHeight}if(i*=o,d*=o,(t*=o)||i||d)return n(t,i,d,e)};return t.addEventListener("wheel",i),i}module.exports=t;
},{"to-px":"Kcat"}],"yCc6":[function(require,module,exports) {
function e(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}module.exports=e;
},{}],"dDpk":[function(require,module,exports) {
function t(t,n,r,a,e){var o=1/Math.tan(n/2),u=1/(a-e);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(e+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*e*a*u,t[15]=0,t}module.exports=t;
},{}],"SStW":[function(require,module,exports) {
var t=require("./identity");function a(a,r,e,s){var h,M,i,n,q,u,b,o,d,v,c=r[0],f=r[1],l=r[2],m=s[0],p=s[1],x=s[2],y=e[0],g=e[1],j=e[2];return Math.abs(c-y)<1e-6&&Math.abs(f-g)<1e-6&&Math.abs(l-j)<1e-6?t(a):(b=c-y,o=f-g,d=l-j,h=p*(d*=v=1/Math.sqrt(b*b+o*o+d*d))-x*(o*=v),M=x*(b*=v)-m*d,i=m*o-p*b,(v=Math.sqrt(h*h+M*M+i*i))?(h*=v=1/v,M*=v,i*=v):(h=0,M=0,i=0),n=o*i-d*M,q=d*h-b*i,u=b*M-o*h,(v=Math.sqrt(n*n+q*q+u*u))?(n*=v=1/v,q*=v,u*=v):(n=0,q=0,u=0),a[0]=h,a[1]=n,a[2]=b,a[3]=0,a[4]=M,a[5]=q,a[6]=o,a[7]=0,a[8]=i,a[9]=u,a[10]=d,a[11]=0,a[12]=-(h*c+M*f+i*l),a[13]=-(n*c+q*f+u*l),a[14]=-(b*c+o*f+d*l),a[15]=1,a)}module.exports=a;
},{"./identity":"yCc6"}],"RXPD":[function(require,module,exports) {
var t=require("mouse-change"),e=require("mouse-wheel"),r=require("gl-mat4/identity"),i=require("gl-mat4/perspective"),n=require("gl-mat4/lookAt");module.exports=a;var o="undefined"!=typeof window;function a(a,d){var c=d||{};void 0===c.noScroll&&(c.noScroll=c.preventDefault);var h={view:r(new Float32Array(16)),projection:r(new Float32Array(16)),center:new Float32Array(c.center||3),theta:c.theta||0,phi:c.phi||0,distance:Math.log(c.distance||10),eye:new Float32Array(3),up:new Float32Array(c.up||[0,1,0]),fovy:c.fovy||Math.PI/4,near:void 0!==c.near?c.near:.01,far:void 0!==c.far?c.far:1e3,noScroll:void 0!==c.noScroll&&c.noScroll,flipY:!!c.flipY,dtheta:0,dphi:0,rotationSpeed:void 0!==c.rotationSpeed?c.rotationSpeed:1,zoomSpeed:void 0!==c.zoomSpeed?c.zoomSpeed:1,renderOnDirty:void 0!==typeof c.renderOnDirty&&!!c.renderOnDirty},p=c.element,f=void 0!==c.damping?c.damping:.9,u=new Float32Array([1,0,0]),y=new Float32Array([0,0,1]),l=Math.log("minDistance"in c?c.minDistance:.1),v=Math.log("maxDistance"in c?c.maxDistance:1e3),s=0,m=0,w=0;if(o&&!1!==c.mouse){var M=p||a._gl.canvas;function S(){return p?p.offsetHeight:window.innerHeight}t(M,function(t,e,r){if(1&t){var i=(e-m)/(p?p.offsetWidth:window.innerWidth),n=(r-w)/S();h.dtheta+=4*h.rotationSpeed*i,h.dphi+=4*h.rotationSpeed*n,h.dirty=!0}m=e,w=r}),e(M,function(t,e){s+=e/S()*h.zoomSpeed,h.dirty=!0},c.noScroll)}function g(t){var e=t*f;return Math.abs(e)<.1?0:(h.dirty=!0,e)}function j(t,e,r){return Math.min(Math.max(t,e),r)}h.dirty=!0;var D=a({context:Object.assign({},h,{dirty:function(){return h.dirty},projection:function(t){return i(h.projection,h.fovy,t.viewportWidth/t.viewportHeight,h.near,h.far),h.flipY&&(h.projection[5]*=-1),h.projection}}),uniforms:Object.keys(h).reduce(function(t,e){return t[e]=a.context(e),t},{})});function A(t,e){void 0!==A.dirty&&(h.dirty=A.dirty||h.dirty,A.dirty=void 0),t&&e&&(h.dirty=!0),h.renderOnDirty&&!h.dirty||(e||(e=t,t={}),function(t){Object.keys(t).forEach(function(e){h[e]=t[e]});var e=h.center,r=h.eye,i=h.up,o=h.dtheta,a=h.dphi;h.theta+=o,h.phi=j(h.phi+a,-Math.PI/2,Math.PI/2),h.distance=j(h.distance+s,l,v),h.dtheta=g(o),h.dphi=g(a),s=g(s);for(var d=h.theta,c=h.phi,p=Math.exp(h.distance),f=p*Math.sin(d)*Math.cos(c),m=p*Math.cos(d)*Math.cos(c),w=p*Math.sin(c),M=0;M<3;++M)r[M]=e[M]+f*y[M]+m*u[M]+w*i[M];n(h.view,r,e,i)}(t),D(e),h.dirty=!1)}return Object.keys(h).forEach(function(t){A[t]=h[t]}),A}
},{"mouse-change":"X2JV","mouse-wheel":"icpc","gl-mat4/identity":"yCc6","gl-mat4/perspective":"dDpk","gl-mat4/lookAt":"SStW"}],"ZCfc":[function(require,module,exports) {
"use strict";var e=this&&this.__assign||function(){return(e=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},t=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,a){function o(e){try{c(n.next(e))}catch(t){a(t)}}function u(e){try{c(n.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,u)}c((n=n.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(u){a=[6,u],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}};Object.defineProperty(exports,"__esModule",{value:!0});var n=require("gl-matrix"),i=require("regl"),a=require("./src/constants"),o=require("./src/renderable"),u=require("./src/pbr-shaders"),c=require("./src/depth-buffer-shaders"),l=require("./src/ocean"),s=require("./src/debug-depth-camera"),f=require("./wave"),d=require("./src/render-factory"),h=require("./ripple");function p(e,n){return t(this,void 0,void 0,function(){var t,i;return r(this,function(r){switch(r.label){case 0:return[4,fetch(a.AssetUrl+"/"+e).then(function(e){return e.json()})];case 1:return t=r.sent(),[4,fetch(a.AssetUrl+"/"+n).then(function(e){return e.arrayBuffer()})];case 2:return i=r.sent(),[2,{manifest:t,buffer:i}]}})})}window.onload=function(){return t(void 0,void 0,void 0,function(){function t(t){return t.scenes[0].nodes.reduce(function(r,n){return r=e(e({},r),o.buildNodeTransforms(t.nodes,n))},{})}var a,m,b,v,g,w,y,x,B,D,q,R,_,P,j,S,k,V,O,A,C,E,F,T,M,N,W,G,H;return r(this,function(e){switch(e.label){case 0:return a=i({extensions:["oes_element_index_uint","EXT_sRGB","OES_standard_derivatives"]}),m=require("regl-camera")(a,{damping:0}),"scene","scene",[4,p((b="fishing_boat")+"/scene.gltf",b+"/scene.bin")];case 1:return v=e.sent(),g=v.manifest,w=v.buffer,console.log(g,w),y={translation:[0,0,0],rotation:[0,0,0],scale:[.01,.01,.01]},function(e){return n.mat4.fromRotationTranslationScale(n.mat4.create(),n.quat.fromEuler(n.quat.create(),e.rotation[0],e.rotation[1],e.rotation[2]),e.translation,e.scale)},x=n.mat4.create(),B=n.mat4.create(),D={eye:[100,100,1e-5],look:[0,0,0],up:[0,1,0]},a({context:{projection:function(e){return n.mat4.perspective(x,n.glMatrix.toRadian(45),e.viewportWidth/e.viewportHeight,.01,1e3)},view:n.mat4.lookAt(B,D.eye,D.look,D.up),eye:D.eye},uniforms:{projection:a.context("projection"),view:a.context("view"),eye:a.context("eye")}}),q=a({context:{lightDirection:function(e,t){return t.lightDirection}},uniforms:{lightDirection:a.context("lightDirection")}}),R=[1,-1,1],(_=n.vec3.scale([],R,-1))[2]+=1e-5,[4,o.loadMeshPrimitives(a,g,w,b)];case 2:return P=e.sent(),[4,p("buoy/scene.gltf","buoy/scene.bin")];case 3:return j=e.sent(),[4,o.loadMeshPrimitives(a,j.manifest,j.buffer,"buoy")];case 4:return S=e.sent(),k=t(g),t(j.manifest),8192,V=a.framebuffer({width:8192,height:8192,depth:!0}),O=o.buildRenderer(a,P,{vertBuilder:c.buildDepthBufferVert,fragBuilder:c.buildDepthBufferFrag},V),A=o.buildRenderer(a,P,{vertBuilder:u.buildPBRVert,fragBuilder:u.buildPBRFrag},null,{depthSampler:function(e,t){return t.depthSampler}}),o.buildRenderer(a,S,{vertBuilder:u.buildPBRVert,fragBuilder:u.buildPBRFrag},null,{depthSampler:function(e,t){return t.depthSampler}}),o.buildRenderer(a,S,{vertBuilder:c.buildDepthBufferVert,fragBuilder:c.buildDepthBufferFrag},V),{translation:[5,0,-4],rotation:[0,0,0],scale:[.025,.025,.025]},5,C=n.mat4.ortho(n.mat4.create(),-5,5,-5,5,-5,5),E=n.mat4.lookAt(n.mat4.create(),_,[0,0,0],[0,1,0]),F=a({context:{depthProjection:function(e,t){return t.depthProjection},depthView:function(e,t){return t.depthView}},uniforms:{depthProjection:a.context("depthProjection"),depthView:a.context("depthView")}}),T={drawDepthCamera:!1},document.addEventListener("keydown",function(e){"d"===e.key&&(T.drawDepthCamera=!T.drawDepthCamera)}),M=l.buildDrawOcean(a),N=s.buildDrawDepthCamera(a,_,5),W=n.quat.create(),[4,d.loadImage("/img/ripple.png")];case 5:return G=e.sent(),h.buildDrawRipple(a,G),h.createRipple(),0,H=0,a.frame(function(e){var t=e.time;0===H?.016:t-H,H=t,a.clear({color:[1,1,1,1],depth:1}),a.clear({color:[1,1,1,1],depth:1,framebuffer:V});var r=f.computeWaveHeightAndNormal([y.translation[0],y.translation[2]],t);y.translation[1]=r.height-.2,W=f.computeRotationFromWaveNormal(r.normal,W);var i=n.mat4.fromRotationTranslationScale(n.mat4.create(),W,y.translation,y.scale);m(function(e){q({lightDirection:R},function(){F({depthProjection:C,depthView:E},function(){T.drawDepthCamera&&N(),O(i,k),A(i,k,{depthSampler:V}),M({depthSampler:V,time:t})})})})}),[2]}})})};
},{"gl-matrix":"IF0X","regl":"EBub","./src/constants":"RhqW","./src/renderable":"Uea7","./src/pbr-shaders":"dlDu","./src/depth-buffer-shaders":"FhO4","./src/ocean":"ByzH","./src/debug-depth-camera":"KnRb","./wave":"ckfj","./src/render-factory":"zkhT","./ripple":"n1fs","regl-camera":"RXPD"}]},{},["ZCfc"], null)
//# sourceMappingURL=/main.ce12c8b4.js.map